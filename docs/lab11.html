<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 11 Linear Regression | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Central tendency and variability</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Scatterplots and correlation</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Probability and simulation</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Models: The Binomial and the Normal</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></li>
<li><a class="" href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></li>
<li><a class="active" href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="coderef.html"><span class="header-section-number">A</span> Distributions</a></li>
<li><a class="" href="hyptests.html"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab11" class="section level1" number="11">
<h1>
<span class="header-section-number">Lab 11</span> Linear Regression<a class="anchor" aria-label="anchor" href="#lab11"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/colin_jackson.jpg" width="100%"></div>
<p>In this session, we will get acquainted with <strong>linear regression</strong>. This is an important technique in statistics because it allows us both to make <em>inferences</em> about relationships between variables, and because it allows us to make <em>predictions</em> that help us make decisions. We will work through how to do linear regression in R to do both inference and prediction.</p>
<p>Before we begin, make sure to grab our usual <code>tidyverse</code> package from R’s library, as well as the <code>magrittr</code> package:</p>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'magrittr'</code></pre>
<pre><code>## The following object is masked from 'package:purrr':
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     extract</code></pre>
<div id="inference-the-answer-is-blowing-in-the-wind" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Inference: The Answer is Blowing in the Wind<a class="anchor" aria-label="anchor" href="#inference-the-answer-is-blowing-in-the-wind"><i class="fas fa-link"></i></a>
</h2>
<p>We will get ourselves acquainted with linear regression in R using a small dataset. This dataset records the finishing times for <a href="https://en.wikipedia.org/wiki/Colin_Jackson">Colin Jackson</a> in the 110 meter hurdles that he competed in during the year 1990.</p>
<p>Load the data into R:</p>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/wind_run.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 21 Columns: 2</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (2): Wind, Time</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>There are 21 total races, for which we have two variables observed:</p>
<ul>
<li>
<strong>Time</strong>: The amount of time Colin took to complete the race (in seconds).</li>
<li>
<strong>Wind</strong>: The speed of the wind (in meters per second) during the race. Negative values are head winds, so they were blowing in Colin’s face. Positive values are tail winds, so they were blowing on his back.</li>
</ul>
<p>Let’s first make a <strong>scatterplot</strong> to see whether there might be a relationship between wind speed and finishing time:</p>
<div class="sourceCode" id="cb478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Wind</span>, y <span class="op">=</span> <span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-regression_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex1101" class="exercise"><strong>Exercise 11.1  </strong></span>Based on the scatterplot, how would you describe the relationship between wind speed and finishing time? Might they be correlated? If so, is the correlation positive or negative? Strong or weak?</p>
</div>
<div id="what-a-line-is-made-of-slopes-and-intercepts" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> What a line is made of: Slopes and Intercepts<a class="anchor" aria-label="anchor" href="#what-a-line-is-made-of-slopes-and-intercepts"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s see how well we can describe the relationship between wind speed and finishing time using a line. As we’ve seen, the equation for a line looks like this:</p>
<p><span class="math display">\[
\hat{Y} = b_1 X + b_0
\]</span></p>
<p>where <span class="math inline">\(b_1\)</span> is the <em>slope</em> and <span class="math inline">\(b_0\)</span> is the <em>intercept</em>. The slope describes how the response variable is predicted to change when the explanatory variable is increased by one. The intercept describes what the predicted response is when the explanatory variable equals zero.</p>
</div>
<div id="adding-our-own-line" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Adding our own line<a class="anchor" aria-label="anchor" href="#adding-our-own-line"><i class="fas fa-link"></i></a>
</h3>
<p>The following chunk of code adds a line to our scatterplot using <code>geom_abline</code>. Notice that we need to specify the <code>slope</code> and <code>intercept</code> of the line that we want to add.</p>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Wind</span>, y <span class="op">=</span> <span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.1</span>, intercept <span class="op">=</span> <span class="fl">13.3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-regression_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex1102" class="exercise"><strong>Exercise 11.2  </strong></span>Play around with the code above by changing the values for <code>slope</code> and <code>intercept</code> in the last line. See if you can find values for the slope and intercept that make the line run close to the points in the plot. What values did you find?</p>
</div>
</div>
<div id="adding-the-best-fitting-line" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> Adding the best-fitting line<a class="anchor" aria-label="anchor" href="#adding-the-best-fitting-line"><i class="fas fa-link"></i></a>
</h3>
<p>Now that we’ve got a reasonable guess about the best-fitting line, let’s see how close we were. We can add the best fitting line to our plot by adding another line to our code. This line is <code>stat_smooth(method = "lm")</code>. <code>stat_smooth</code> can draw various kinds of lines on top of our data that are meant to “smooth” the raw data and make it easier to see any important relationships there might be. In the parentheses, we tell R that the <code>method</code> it should use is <code>lm</code>, where <code>lm</code> stands for “linear model” (we’ve already seen <code>lm</code> and we’ll see it again shortly).</p>
<p>Note that you’ll need to fill in the blanks in the code below with the slope and intercept you found in the last section.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="lab11.html#cb480-1" aria-hidden="true" tabindex="-1"></a>wind_run_data <span class="sc">%&gt;%</span></span>
<span id="cb480-2"><a href="lab11.html#cb480-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Wind, <span class="at">y =</span> Time)) <span class="sc">+</span></span>
<span id="cb480-3"><a href="lab11.html#cb480-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb480-4"><a href="lab11.html#cb480-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> ___, <span class="at">intercept =</span> ___) <span class="sc">+</span></span>
<span id="cb480-5"><a href="lab11.html#cb480-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="11-regression_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex1103" class="exercise"><strong>Exercise 11.3  </strong></span>How close were you to the best-fitting line in blue? Notice that in addition to the line, there is a shaded region around the line. This shaded region is a visual representation of our <strong>uncertainty</strong> regarding the slope and intercept of the best-fitting line. Why do you think this region is narrower near the middle and gets wider toward the edges?</p>
</div>
</div>
<div id="getting-the-slope-and-intercept" class="section level3" number="11.1.4">
<h3>
<span class="header-section-number">11.1.4</span> Getting the slope and intercept<a class="anchor" aria-label="anchor" href="#getting-the-slope-and-intercept"><i class="fas fa-link"></i></a>
</h3>
<p>Being able to see the best-fitting line is great, but it doesn’t let us <em>do</em> anything with it. For example, if we want to predict Colin’s time under a stronger headwind (e.g., -4 m/s), we’ll need to actually know what <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> are.</p>
<p>In class, we saw how to calculate the coefficients of the best-fitting line using the descriptive statistics for our data. Now, we will use R to do this. The code is shockingly similar to what we used for ANOVA last time:</p>
<div class="sourceCode" id="cb482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">~</span> <span class="va">Wind</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Time ~ Wind)
## 
## Coefficients:
## (Intercept)         Wind  
##     13.3218      -0.0846</code></pre>
<p>Once again, the first line tells R what data we are working with. The second line tells R that we want to find the best-fitting “linear model” (<code>lm</code>) that describes the linear relationship between our response variable (<code>Time</code>) and our explanatory variable (<code>Wind</code>). R then told us the coefficients of that line. R labels the slope with the same name as the explanatory variable (<code>Wind</code> in this case).</p>
</div>
<div id="how-much-variance-does-wind-speed-explain" class="section level3" number="11.1.5">
<h3>
<span class="header-section-number">11.1.5</span> How much variance does wind speed explain?<a class="anchor" aria-label="anchor" href="#how-much-variance-does-wind-speed-explain"><i class="fas fa-link"></i></a>
</h3>
<p>As we’ve seen, we can use <span class="math inline">\(r^2\)</span> to describe how much of the variability in Colin’s finishing time can be explained by wind speed. Because <span class="math inline">\(r^2\)</span> is the square of the Pearson correlation coefficient, we can find it by first calculating the correlation between finishing time and wind speed:</p>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Wind</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##        r
##    &lt;dbl&gt;
## 1 -0.635</code></pre>
<p>If we take the square of that result, we’ll get the value of <span class="math inline">\(r^2\)</span>:</p>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="op">-</span><span class="fl">0.635</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></code></pre></div>
<pre><code>## [1] 0.403225</code></pre>

<div class="exercise">
<p><span id="exr:ex1104" class="exercise"><strong>Exercise 11.4  </strong></span>Based on the value for <span class="math inline">\(r^2\)</span>, do you think that wind speed has a big effect on Colin’s finishing times? A small effect? A moderate effect? Remember that <span class="math inline">\(r^2\)</span> is always between 0 (no effect) and 1 (explains everything).</p>
</div>
</div>
<div id="making-predictions" class="section level3" number="11.1.6">
<h3>
<span class="header-section-number">11.1.6</span> Making Predictions<a class="anchor" aria-label="anchor" href="#making-predictions"><i class="fas fa-link"></i></a>
</h3>
<p>We can now use the linear model to make predictions about how fast Colin will be expected to finish based on different wind speeds. First, let’s see what the model predicts for each of the observed wind speeds:</p>
<div class="sourceCode" id="cb488"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">~</span> <span class="va">Wind</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 13.56714 13.49100 13.45716 13.44024 13.38947 13.35563 13.35563 13.33871 
##        9       10       11       12       13       14       15       16 
## 13.33025 13.30487 13.30487 13.27949 13.27949 13.25411 13.23719 13.22873 
##       17       18       19       20       21 
## 13.22873 13.22027 13.13567 13.08490 13.07644</code></pre>
<p>The result is what the model <em>predicts</em> Colin’s finishing time would have been for each race in our dataset. In other words, these are all the <span class="math inline">\(\hat{Y}_i\)</span>’s for each <span class="math inline">\(X_i\)</span> in our data. We can also get the <strong>residuals</strong> for each prediction, to see how far off it was:</p>
<div class="sourceCode" id="cb490"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">~</span> <span class="va">Wind</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##            1            2            3            4            5            6 
## -0.037139491  0.139002832 -0.067156136  0.089764380  0.240525929 -0.185633039 
##            7            8            9           10           11           12 
## -0.105633039 -0.108712522  0.299747736 -0.214871490 -0.124871490 -0.199490716 
##           13           14           15           16           17           18 
##  0.100509284  0.265890059 -0.127189425 -0.128729167 -0.028729167  0.009731091 
##           19           20           21 
##  0.084333672  0.055095221  0.043555479</code></pre>
<p>To make a prediction about a <em>new</em> race, we need to add something to our “predict” line. Specifically, we need to give it “new data” about the Wind speed for each prediction we want to make. This is how we can do this:</p>
<div class="sourceCode" id="cb492"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">future_wind</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>Wind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The previous line of code created a new dataset called <code>future_wind</code> that contains a single variable called <code>Wind</code> which has 3 values, -1, 0, and 1. We can get Colin’s predicted time for each of these three wind speeds like so:</p>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">~</span> <span class="va">Wind</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">future_wind</span><span class="op">)</span></code></pre></div>
<pre><code>##        1        2        3 
## 13.40639 13.32179 13.23719</code></pre>

<div class="exercise">
<p><span id="exr:ex1105" class="exercise"><strong>Exercise 11.5  </strong></span>Create a new “future_wind” dataset that contains the values -30 and 30, then use the preceding chunk of code to get predictions for how long Colin will take to finish under those two conditions. What were the predictions? Do they seem reasonable? Does it seem reasonable that someone would be running when the wind is blowing 30 meters per second (67 miles per hour)?</p>
</div>
</div>
<div id="hypothesis-testing" class="section level3" number="11.1.7">
<h3>
<span class="header-section-number">11.1.7</span> Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"><i class="fas fa-link"></i></a>
</h3>
<p>Based on the plots we made earlier, it certainly looks like there is an approximately linear relationship between Colin’s finishing times and wind speed. But the slope of the best-fitting line is only about -0.08, which seems kind of small. So it is worth asking the <strong>research question</strong>, “is there a relationship between finishing time and wind speed?”</p>
<p>Let’s use our standard 5-step hypothesis testing procedure to address this question.</p>
<ol style="list-style-type: decimal">
<li>Translate your research question into a null and alternative hypothesis</li>
</ol>
<p>Our <strong>null hypothesis</strong> is that there is no such relationship, meaning that the true value of the slope is 0 (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(b_1 = 0\)</span>). Our <strong>alternative hypothesis</strong> is that there is a relationship, meaning that the true value of the slope is not zero (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(b_1 \neq 0\)</span>).</p>
<ol start="2" style="list-style-type: decimal">
<li>Select an alpha level</li>
</ol>
<p>We will select a reasonable <strong>alpha level</strong> of 0.05.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(F\)</span> value</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value</p></li>
</ol>
<p>These two steps can be done using…the very same code we used for ANOVA! As we saw in class, linear regression and ANOVA can be thought of as addressing the same question, it is just that the explanatory variable in ANOVA is nominal while the explanatory variable in linear regression is interval or ratio. The following code gives us both the <span class="math inline">\(F\)</span> value and the <span class="math inline">\(p\)</span> value:</p>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wind_run_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">~</span> <span class="va">Wind</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Time
##           Df  Sum Sq  Mean Sq F value  Pr(&gt;F)   
## Wind       1 0.31535 0.315350  12.844 0.00198 **
## Residuals 19 0.46648 0.024551                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>As you can see, the basic structure of that code and what we used for ANOVA is the same, and the resulting output is nearly identical as well. The difference is in the type of explanatory variable: It is a nominal variable in ANOVA, whereas it is an interval or ratio scale variable in linear regression. The shared basic outline is this:</p>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Name_of_Data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Name_of_Response_Variable</span> <span class="op">~</span> <span class="va">Name_of_Explanatory_Variable</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis</li>
</ol>
<div class="exercise">
<p><span id="exr:ex1106" class="exercise"><strong>Exercise 11.6  </strong></span>Based on the <span class="math inline">\(p\)</span> value reported in the table above, and based on the alpha level we chose in step 2, do we reject the null hypothesis? What does this tell us about the relationship between Colin’s performance and wind speed?</p>
</div>
</div>
</div>
<div id="making-decisions-housing-prices" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Making Decisions: Housing Prices<a class="anchor" aria-label="anchor" href="#making-decisions-housing-prices"><i class="fas fa-link"></i></a>
</h2>
<p>Linear regression is often helpful when we have to make a decision. Specifically, if we want to make a decision about a response variable—and all we know is an explanatory variable—linear regression allows us to use the relationship between the response and explanatory variables to make a reasonable guess.</p>
<p>One setting in which these decisions are important is <em>purchasing</em>. The seller needs to decide how much to price what they are selling. The potential buyer needs to know whether they are paying a fair price.</p>
<p>To see this in action, we will look at housing sale data from the lovely college town of Ames, Iowa.</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/ames.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 2930 Columns: 15</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (11): Street, Alley, Lot.Shape, Land.Contour, Utilities, Lot.Config, Lan...
## dbl  (4): PID, area, price, Year.Built</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Although there are a lot of variables in this dataset, there are two that we will focus on:</p>
<ul>
<li>
<strong>area</strong>: The total livable area of the house, in square feet.</li>
<li>
<strong>price</strong>: The final price for which the house sold.</li>
</ul>
<div id="visualize-the-data" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Visualize the data<a class="anchor" aria-label="anchor" href="#visualize-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>First, let’s make a scatterplot to visualize the relationship between these variables. Fill in the blanks below.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="lab11.html#cb502-1" aria-hidden="true" tabindex="-1"></a>ames <span class="sc">%&gt;%</span></span>
<span id="cb502-2"><a href="lab11.html#cb502-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb502-3"><a href="lab11.html#cb502-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<div class="inline-figure"><img src="11-regression_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex1107" class="exercise"><strong>Exercise 11.7  </strong></span>What did you put in the blanks above? How would you describe the relationship between area and price? Are they positively or negatively correlated? Is the correlation strong or weak? Do you notice any “outliers,” points that seem really odd relative to the rest of the data?</p>
</div>
</div>
<div id="find-the-best-fitting-line" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> Find the best-fitting line<a class="anchor" aria-label="anchor" href="#find-the-best-fitting-line"><i class="fas fa-link"></i></a>
</h3>
<p>Now let’s add the best-fitting line to our scatterplot (again, be sure to fill in the blanks; see the Colin Jackson example above for examples):</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="lab11.html#cb503-1" aria-hidden="true" tabindex="-1"></a>ames <span class="sc">%&gt;%</span></span>
<span id="cb503-2"><a href="lab11.html#cb503-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb503-3"><a href="lab11.html#cb503-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>() <span class="sc">+</span></span>
<span id="cb503-4"><a href="lab11.html#cb503-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_smooth</span>(<span class="at">method =</span> ___)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="11-regression_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
<p>And let’s get the coefficients (slope and intercept) of the best-fitting line:</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">price</span> <span class="op">~</span> <span class="va">area</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = price ~ area)
## 
## Coefficients:
## (Intercept)         area  
##     13289.6        111.7</code></pre>

<div class="exercise">
<p><span id="exr:ex1108" class="exercise"><strong>Exercise 11.8  </strong></span>What does the intercept tell us about house prices and area? What does the slope tell us about house prices and area? Based on the scatterplot, do you think the linear model does a better job predicting prices for different sized houses?</p>
</div>
</div>
<div id="make-predictions" class="section level3" number="11.2.3">
<h3>
<span class="header-section-number">11.2.3</span> Make Predictions<a class="anchor" aria-label="anchor" href="#make-predictions"><i class="fas fa-link"></i></a>
</h3>
<p>Now let’s put ourselves in different scenarios and see how our linear model can help us make decisions.</p>
<div id="how-to-set-the-price" class="section level4" number="11.2.3.1">
<h4>
<span class="header-section-number">11.2.3.1</span> How to set the price?<a class="anchor" aria-label="anchor" href="#how-to-set-the-price"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s imagine that there are two houses on the market, one with a 1000 square foot area, one with 2000 square foot area. Let’s first use our linear model to <em>predict</em> the price for these three houses:</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_price</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span><span class="op">)</span>

<span class="va">ames</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">price</span> <span class="op">~</span> <span class="va">area</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">new_price</span><span class="op">)</span></code></pre></div>
<pre><code>##        1        2 
## 124983.6 236677.6</code></pre>
<p>As above, the first result is the predicted price for the 1000 square foot house and the second result is the predicted price for the 2000 square foot house.</p>

<div class="exercise">
<p><span id="exr:ex1109" class="exercise"><strong>Exercise 11.9  </strong></span>Imagine you are a seller. Look at the scatterplot to get a sense of where these predicted prices fall relative to all the houses around the two sizes. Do you think the prices predicted from the linear model are too low, too high, or about average for these two houses? Do you think you might have more flexibility in setting the price of the smaller house (1000 sq. ft.) or the larger house (2000 sq. ft.)?</p>
</div>
</div>
<div id="am-i-getting-a-fair-price" class="section level4" number="11.2.3.2">
<h4>
<span class="header-section-number">11.2.3.2</span> Am I getting a fair price?<a class="anchor" aria-label="anchor" href="#am-i-getting-a-fair-price"><i class="fas fa-link"></i></a>
</h4>
<p>Now let’s imagine that we are looking to buy a house. We have three different options which are 1200, 2400, and 4500 square feet in size, respectively. The listed prices for each house are</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>House Area (<span class="math inline">\(X\)</span>)</th>
<th>1200 sq. ft</th>
<th>2400 sq. ft</th>
<th>4500 sq. ft</th>
</tr></thead>
<tbody><tr class="odd">
<td>Actual Price (<span class="math inline">\(Y\)</span>)</td>
<td>$150000.00</td>
<td>$400000.00</td>
<td>$250000.00</td>
</tr></tbody>
</table></div>
<p>Let’s use our linear model to predict what the prices for these houses <em>would</em> be. By comparing these predictions to the actual prices, we can see which prices seem fair, which seem excessively high, and which might be a discount.</p>
<p>First, fill in the blanks to get the predicted price for each of these houses:</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="lab11.html#cb509-1" aria-hidden="true" tabindex="-1"></a>new_price <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">___ =</span> <span class="fu">c</span>(___))</span>
<span id="cb509-2"><a href="lab11.html#cb509-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-3"><a href="lab11.html#cb509-3" aria-hidden="true" tabindex="-1"></a>ames <span class="sc">%$%</span></span>
<span id="cb509-4"><a href="lab11.html#cb509-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(price <span class="sc">~</span> area) <span class="sc">%&gt;%</span></span>
<span id="cb509-5"><a href="lab11.html#cb509-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(<span class="at">newdata =</span> new_price)</span></code></pre></div>
<pre><code>##        1        2        3 
## 147322.4 281355.2 515912.6</code></pre>

<div class="exercise">
<p><span id="exr:ex1110" class="exercise"><strong>Exercise 11.10  </strong></span>By comparing the actual prices to the predicted prices, which of the three houses seems like a good deal? Which seem to be overpriced?</p>
</div>
</div>
</div>
</div>
<div id="wrap-up-10" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-10"><i class="fas fa-link"></i></a>
</h2>
<p>Today, we saw how to do linear regression in R, including</p>
<ol style="list-style-type: decimal">
<li>How to visualize the best-fitting line that relates an explanatory variable and a response variable.</li>
<li>How to get the coefficients of the best-fitting line.</li>
<li>How to find the proportion of variance explained by the linear relationship (<span class="math inline">\(r^2\)</span>).</li>
<li>How to make predictions using a linear model.</li>
<li>How to test the null hypothesis that the slope of the line is zero, to draw inferences about whether there is a meaningful relationship between the explanatory and response variables.</li>
<li>How to use predictions from the linear model to help make decisions.</li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></div>
<div class="next"><a href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab11"><span class="header-section-number">11</span> Linear Regression</a></li>
<li>
<a class="nav-link" href="#inference-the-answer-is-blowing-in-the-wind"><span class="header-section-number">11.1</span> Inference: The Answer is Blowing in the Wind</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-a-line-is-made-of-slopes-and-intercepts"><span class="header-section-number">11.1.1</span> What a line is made of: Slopes and Intercepts</a></li>
<li><a class="nav-link" href="#adding-our-own-line"><span class="header-section-number">11.1.2</span> Adding our own line</a></li>
<li><a class="nav-link" href="#adding-the-best-fitting-line"><span class="header-section-number">11.1.3</span> Adding the best-fitting line</a></li>
<li><a class="nav-link" href="#getting-the-slope-and-intercept"><span class="header-section-number">11.1.4</span> Getting the slope and intercept</a></li>
<li><a class="nav-link" href="#how-much-variance-does-wind-speed-explain"><span class="header-section-number">11.1.5</span> How much variance does wind speed explain?</a></li>
<li><a class="nav-link" href="#making-predictions"><span class="header-section-number">11.1.6</span> Making Predictions</a></li>
<li><a class="nav-link" href="#hypothesis-testing"><span class="header-section-number">11.1.7</span> Hypothesis Testing</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#making-decisions-housing-prices"><span class="header-section-number">11.2</span> Making Decisions: Housing Prices</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualize-the-data"><span class="header-section-number">11.2.1</span> Visualize the data</a></li>
<li><a class="nav-link" href="#find-the-best-fitting-line"><span class="header-section-number">11.2.2</span> Find the best-fitting line</a></li>
<li><a class="nav-link" href="#make-predictions"><span class="header-section-number">11.2.3</span> Make Predictions</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-10"><span class="header-section-number">11.3</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/11-regression.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/11-regression.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-08-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
