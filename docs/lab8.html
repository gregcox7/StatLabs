<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 8 Statistical Power | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Central tendency and variability</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Scatterplots and correlation</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Probability and simulation</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Models: The Binomial and the Normal</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li><a class="active" href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></li>
<li><a class="" href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></li>
<li><a class="" href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="coderef.html"><span class="header-section-number">A</span> Distributions</a></li>
<li><a class="" href="hyptests.html"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab8" class="section level1" number="8">
<h1>
<span class="header-section-number">Lab 8</span> Statistical Power<a class="anchor" aria-label="anchor" href="#lab8"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/polarbear.png" width="100%"></div>
<p>If we conduct a null hypothesis test and decide to <em>reject</em> the null hypothesis, there are two possibilities: Either we <em>incorrectly</em> rejected the null hypothesis, in which case we made a <strong>Type I error</strong>; or we <em>correctly</em> rejected the null hypothesis (and thereby avoided a <strong>Type II error</strong>). We’ve seen that <em>we</em> get to decide the probability of a Type I error because it is the same thing as our “alpha level.” But what is the probability that we <em>correctly</em> reject the null hypothesis? This probability is called the <strong>power</strong> of our test and is often called “beta” (<span class="math inline">\(\beta\)</span>).</p>
<p>The challenge in figuring out what “beta” is that we do not know ahead of time how far from the null hypothesis our results might be. The difference between the true population parameters and those assumed by the null hypothesis is called <strong>effect size</strong>. We already encountered this last session, in which we wondered how different the heart rates in a sample would need to be before we could always reject the null hypothesis. What we were doing was changing the “effect size” and seeing that, with a bigger effect size, <em>power</em> also increased.</p>
<p>In this session, we will explore the factors that contribute to power and conduct a null hypothesis test on real data to assess the effectiveness of a computer-based learning activity.</p>
<p>Before we begin, let’s make sure to load the <code>tidyverse</code> package from R’s library.</p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="the-power-of-positive-feedback" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> The Power of Positive Feedback<a class="anchor" aria-label="anchor" href="#the-power-of-positive-feedback"><i class="fas fa-link"></i></a>
</h2>
<p>We will be looking at a study reported by <span class="citation"><a href="references.html#ref-DayEtAl2015" role="doc-biblioref">Day et al.</a> (<a href="references.html#ref-DayEtAl2015" role="doc-biblioref">2015</a>)</span>. They were interested in how to convey to middle school students the concept of “positive feedback.” Positive feedback occurs whenever changing one part of a system leads to changes in another part of a system, which then causes additional change in the first part (A increases B and B increases A). Positive feedback is common in many natural, social, and technological systems. For example, having more wealth (A) allows you to put money into investments (B) which has the potential to give you even more wealth (A).</p>
<p><span class="citation"><a href="references.html#ref-DayEtAl2015" role="doc-biblioref">Day et al.</a> (<a href="references.html#ref-DayEtAl2015" role="doc-biblioref">2015</a>)</span> wondered whether students could learn the concept of positive feedback by playing with a computer simulation of the relationship between ice and climate. The ice covering Earth’s north and south poles helps keep the planet cool because ice reflects sunlight rather than absorbing it (think of how dark clothes get warmer in sunlight than light colored clothes). Positive feedback occurs because if the global temperature increases (A), this melts the ice (B), which then leads to more warming (A) because there is less ice to reflect sunlight back into space (for crossword puzzle fans, the technical term for how reflective a surface is “albedo”). The simulation was meant to illustrate this relationship to students so they could identify similar kinds of positive feedback situations elsewhere.</p>
<p>Although their whole study looked at a number of things, we will focus on one particular <strong>research question</strong>: Can students learn the concept of positive feedback from a computer simulation?</p>
<div id="look-at-the-data" class="section level3" number="8.1.1">
<h3>
<span class="header-section-number">8.1.1</span> Look at the data<a class="anchor" aria-label="anchor" href="#look-at-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s first take a look at their data to get a sense of how they addressed these two research questions. Load it into R:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">feedback_learning</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/learning_subset.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 69 Columns: 8</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (1): Gender
## dbl (7): ID, Period, AdvPlacement, Grade, Pretest, Posttest, Improvement</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Click on the new “feedback_learning” data that’s now in R’s environment (upper right panel). Each row represents data from a single student and there are several columns. For now, let’s focus on the last three columns:</p>
<ul>
<li>Pretest: This is a score (between 8 and 40) on a test designed to measure understanding of the concept of positive feedback. This test was given prior to doing the computer simulation activity. The score is based on 8 questions which can give between 1 and 5 points.</li>
<li>Posttest: This is another score (between 8 and 40) on a similar test, but given <em>after</em> the activity.</li>
<li>
<strong>Improvement</strong>: This is the difference between the posttest and pretest scores, and this is how we <em>operationalize</em> the construct of “learning.” If a student does better after the activity than before, they will have a positive improvement. If they do worse, they will have a negative improvement. And if they don’t learn anything, their improvement is zero.</li>
</ul>
<p>In the next section, we will do some computer simulations ourselves! Specifically, we will explore various factors that affect our <strong>power</strong> to detect whether the activity actually led to student learning or not.</p>

<div class="exercise">
<p><span id="exr:ex0801" class="exercise"><strong>Exercise 8.1  </strong></span>
We are going to use the normal distribution as our <em>model</em> of the average improvement. Why is the normal distribution more appropriate than the binomial distribution? (<em>Hint: think about what kinds of values a normal distribution can produce and what kinds of values a binomial distribution can produce.</em>)</p>
</div>
</div>
<div id="specifying-our-null-hypothesis" class="section level3" number="8.1.2">
<h3>
<span class="header-section-number">8.1.2</span> Specifying our null hypothesis<a class="anchor" aria-label="anchor" href="#specifying-our-null-hypothesis"><i class="fas fa-link"></i></a>
</h3>
<p>If the answer to the research question (above) was “no,” then we should expect no difference between the pre- and posttest scores. This tells us that our <strong>null hypothesis</strong> is that the population mean “Improvement” is zero. We will do a <strong>two-tailed test</strong> because we want to be open to the possibility that the activity actually <em>harmed</em> students’ understanding. This gives us our null and alternative hypotheses:</p>
<p><strong>Null hypothesis (<span class="math inline">\(H_0\)</span>)</strong>: <span class="math inline">\(\mu = 0\)</span></p>
<p><strong>Alternative hypothesis (<span class="math inline">\(H_1\)</span>)</strong>: <span class="math inline">\(\mu \neq 0\)</span></p>
<p>We are still missing something: Although we know what the population <em>mean</em> would be if the null hypothesis were true, what about the population <em>standard deviation</em>? In other words, what would be the typical variability between students on these tests? For the moment, let’s speculate that the population standard deviation is <span class="math inline">\(\sigma = 5\)</span>, representing the range of scores on a <em>single</em> question on the test. What we are saying is that we think the typical variability between students is around one question’s worth of points.</p>
<p>To make things easier for us later on, let’s give these numbers special labels in R:</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">null_sd</span> <span class="op">&lt;-</span> <span class="fl">5</span></code></pre></div>
<p>Finally, we need to think about the <em>sample size</em> so that we can use the Central Limit Theorem to figure out where to put the boundaries of our confidence interval. For now, let’s assume that we will have a sample of 30 students and give that number a special label as well:</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span></code></pre></div>
</div>
<div id="building-our-confidence-interval" class="section level3" number="8.1.3">
<h3>
<span class="header-section-number">8.1.3</span> Building our confidence interval<a class="anchor" aria-label="anchor" href="#building-our-confidence-interval"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s say that we will reject the null hypothesis if the sample we get has less than a 0.05 probability of happening if the null hypothesis were true. In other words, we are setting (for now) our <em>alpha level</em> to 0.05, and as a result we need to find a 95% confidence interval. Let’s give this a label so we can use it in R:</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_level</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<p>As mentioned above, we will use the normal distribution to find the upper and lower boundaries.</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Notice that, in addition to giving labels to the lower and upper ends of our confidence interval (<code>ci_lower</code> and <code>ci_upper</code>, respectively), we used the labels we made earlier to specify the <code>mean</code> and <code>sd</code> in <code>qnorm</code>. Very handy!</p>
</div>
<div id="visualizing-the-distribution-of-sample-means" class="section level3" number="8.1.4">
<h3>
<span class="header-section-number">8.1.4</span> Visualizing the distribution of sample means<a class="anchor" aria-label="anchor" href="#visualizing-the-distribution-of-sample-means"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, let’s visualize the distribution of sample means that we would get if the null hypothesis were true. Like we’ve done before, we will use colors to distinguish between samples that fall outside our confidence interval—and into the <em>critical region</em> leading us to reject the null hypothesis—from those that fall inside it.</p>
<p>First, let’s simulate a large number of possible sample means assuming the null hypothesis is true:</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span></code></pre></div>
<p>Now let’s make a colored histogram so we can see how often sample means fall inside or outside our confidence interval.</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-power_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>We can also check and see how often one of the sample means from the null hypothesis ends up outside the confidence interval, leading us to make a Type I error by incorrectly rejecting the null hypothesis:</p>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>p <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   `(M &gt; ci_lower) &amp; (M &lt; ci_upper)`     n      p
##   &lt;lgl&gt;                             &lt;int&gt;  &lt;dbl&gt;
## 1 FALSE                               533 0.0533
## 2 TRUE                               9467 0.947</code></pre>

<div class="exercise">
<p><span id="exr:ex0802" class="exercise"><strong>Exercise 8.2  </strong></span>
In the table above, the row labeled “FALSE” corresponds to simulated sample means that fell outside the confidence interval, which would lead us to (incorrectly) reject the null hypothesis. How close is the probability “p” in that column to the alpha level we decided on earlier?</p>
</div>
</div>
</div>
<div id="achieving-a-target-level-of-power" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Achieving a target level of power<a class="anchor" aria-label="anchor" href="#achieving-a-target-level-of-power"><i class="fas fa-link"></i></a>
</h2>
<p>A typical goal in many research areas is to have at least an 0.8 probability of correctly rejecting the null hypothesis. In this section, we will imagine different scenarios with the aim of achieving this level of power.</p>
<div id="effect-size" class="section level3" number="8.2.1">
<h3>
<span class="header-section-number">8.2.1</span> Effect size<a class="anchor" aria-label="anchor" href="#effect-size"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Effect size</strong> is the difference between the actual population parameters and the population parameters we assume in the null hypothesis. In that sense, the null hypothesis assumes the “effect size” is zero.</p>
<p>In this case, “effect size” refers to how much test scores improve as a function of the learning activity. Let’s imagine what the distribution of sample means would look like if the effect size were 1, in other words, if the learning activity improved scores by, on average, a single point.</p>
<p>First, let’s put a label on this guess to make our lives easier:</p>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fl">1</span></code></pre></div>
<p>Now, let’s do something similar to what we did above and simulate a whole bunch of sample means assuming this effect size:</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span></code></pre></div>
<p>And we can visualize what this distribution looks like, along with how much of it falls in the critical region, leading us to <em>correctly</em> reject the null hypothesis.</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-power_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
<p>We can approximate the probability of correctly rejecting the null hypothesis using our simulation:</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>p <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   `(M &gt; ci_lower) &amp; (M &lt; ci_upper)`     n     p
##   &lt;lgl&gt;                             &lt;int&gt; &lt;dbl&gt;
## 1 FALSE                              1954 0.195
## 2 TRUE                               8046 0.805</code></pre>
<p>But we can also find <em>power</em> exactly by using the normal distribution:</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_lower</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_upper</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.1947752</code></pre>

<div class="exercise">
<p><span id="exr:ex0803" class="exercise"><strong>Exercise 8.3  </strong></span>
Try setting <code>effect_size</code> to different values (e.g., <code>effect_size &lt;- 0.5</code>) and then re-run the lines of code we just used (i.e., simulate new sample means, make a histogram, and calculate power using the normal distribution). Try to find an effect size where the power ends up as close as you can get it to 0.8 without going over. What effect size did you find?</p>
</div>
</div>
<div id="sample-size" class="section level3" number="8.2.2">
<h3>
<span class="header-section-number">8.2.2</span> Sample size<a class="anchor" aria-label="anchor" href="#sample-size"><i class="fas fa-link"></i></a>
</h3>
<p>Now let’s reset our hypothetical effect size back to 1 point.</p>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fl">1</span></code></pre></div>
<p>Now instead of messing around with effect size, let’s see if we can change the <strong>sample size</strong> to try and achieve a power of 0.8. This is a bit trickier because we also have to adjust our confidence interval limits, because they also depend on sample size.</p>
<p>For example, let’s try increasing our sample size to 40.</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">40</span></code></pre></div>
<p>Now, we have to re-calculate our confidence interval limits in addition to everything else:</p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>

<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span>

<span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-power_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_lower</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_upper</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.2441412</code></pre>

<div class="exercise">
<p><span id="exr:ex0804" class="exercise"><strong>Exercise 8.4  </strong></span>
Try setting <code>sample_size</code> to different values (e.g., <code>sample_size &lt;- 13</code>) and then re-run the lines of code we just used (i.e., find the CI limits, simulate new sample means, make a histogram, and calculate power using the normal distribution). Try to find a sample size where the power ends up as close as you can get it to 0.8 without going over. What sample size did you find?</p>
</div>
</div>
<div id="alpha-level" class="section level3" number="8.2.3">
<h3>
<span class="header-section-number">8.2.3</span> Alpha level<a class="anchor" aria-label="anchor" href="#alpha-level"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s put the sample size back to its original value of 30.</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span></code></pre></div>
<p>Now, we are going to mess around with the <strong>alpha level</strong> in order to achieve 0.8 power. In other words, we are changing the width of our confidence interval so that it allows us to correctly reject the null hypothesis 80% of the time.</p>

<div class="exercise">
<p><span id="exr:ex0805" class="exercise"><strong>Exercise 8.5  </strong></span>
Is there a potential problem with messing with the alpha level this way? Are we increasing the probability of making a different kind of error?</p>
</div>
<p>For example, the code below is based on changing our alpha level from 0.05 to 0.1. Once again, we have to re-do our confidence interval:</p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_level</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>

<span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>

<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span>

<span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-power_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_lower</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_upper</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.2944317</code></pre>

<div class="exercise">
<p><span id="exr:ex0806" class="exercise"><strong>Exercise 8.6  </strong></span>
Try changing <code>alpha_level</code> in the code above to different values and then re-run the code to make a histogram and calculate power. Try to find an alpha level where the power ends up as close as you can get it to 0.8 without going over. What alpha level did you find?</p>
</div>
</div>
<div id="population-standard-deviation" class="section level3" number="8.2.4">
<h3>
<span class="header-section-number">8.2.4</span> Population standard deviation<a class="anchor" aria-label="anchor" href="#population-standard-deviation"><i class="fas fa-link"></i></a>
</h3>
<p>There’s one final thing that can affect power, and that is the <strong>population standard deviation (<span class="math inline">\(\sigma\)</span>)</strong>. Obviously, this is not something we can actually control in the real world, but it is important to consider when thinking about the power to correctly reject the null hypothesis. If the population is more variable, it will be harder to detect any differences that are the result of our intervention.</p>
<p>Let’s first reset our alpha level back to 0.05</p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_level</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<p>As above, when we mess with the population standard deviation, this trickles down into every aspect of our hypothesis test, since <code>null_sd</code> appears pretty often. For example, let’s try making the population twice as variable as it was before by setting <code>null_sd</code> to 10.</p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_sd</span> <span class="op">&lt;-</span> <span class="fl">10</span>

<span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>

<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span>

<span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-power_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_lower</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_upper</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.08501566</code></pre>

<div class="exercise">
<p><span id="exr:ex0807" class="exercise"><strong>Exercise 8.7  </strong></span>
Try changing <code>null_sd</code> in the code above to different values and then re-run the code following it to make a histogram and calculate power. Try to find a population SD where the power ends up as close as you can get it to 0.8 without going over. What population SD did you find?</p>
</div>
</div>
</div>
<div id="using-data-to-test-the-null-hypothesis" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Using data to test the null hypothesis<a class="anchor" aria-label="anchor" href="#using-data-to-test-the-null-hypothesis"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we’ve explored the factors that contribute to the <strong>power</strong> of this—and any—null hypothesis test, let’s see how the data actually played out.</p>
<p>First, remember that we had to make a reasonable guess about the population SD before. Now, we are going to <em>estimate</em> it using the sample SD of our actual data. This has some consequences we will discuss later in the course, but for now we will accept this as is:</p>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">feedback_learning</span><span class="op">$</span><span class="va">Improvement</span><span class="op">)</span></code></pre></div>
<p>Above, the <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> pulls out the <code>Improvement</code> column from our <code>feedback_learning</code> dataset, so <code>null_sd</code> is now the standard deviation of the improvement values we actually observed.</p>
<p>Also, notice that the sample size they had was 69, so let’s make sure to adjust that as well:</p>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">69</span></code></pre></div>
<div id="confidence-interval-limits" class="section level3" number="8.3.1">
<h3>
<span class="header-section-number">8.3.1</span> Confidence interval limits<a class="anchor" aria-label="anchor" href="#confidence-interval-limits"><i class="fas fa-link"></i></a>
</h3>
<p>Now, we find the upper and lower limits of our confidence interval:</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And we can find the sample mean (and give it a label, since we’ll be using it later):</p>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">feedback_learning</span><span class="op">$</span><span class="va">Improvement</span><span class="op">)</span></code></pre></div>
<p>Because this falls outside the confidence interval, we <strong>reject</strong> the null hypothesis!</p>
</div>
<div id="the-p-value" class="section level3" number="8.3.2">
<h3>
<span class="header-section-number">8.3.2</span> The <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#the-p-value"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s also find the <span class="math inline">\(p\)</span> value, the probability that we would observe a result at least as extreme as our result if the null hypothesis were true. Because the sample mean is <em>larger</em> than the mean according to the null hypothesis, we need to find the probability of being <em>above</em> the sample mean:</p>
<div class="sourceCode" id="cb340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">sample_mean</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0004771661</code></pre>
<p>But remember that because this is a <strong>two-tailed</strong> test, we need to multiply the number above by 2, to account for <em>both</em> the upper and lower parts of the critical region.</p>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">sample_mean</span>, mean <span class="op">=</span> <span class="va">null_mean</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.0009543322</code></pre>
<p>This is the final <span class="math inline">\(p\)</span> value, and we can see that it is less than our alpha level of 0.05.</p>

<div class="exercise">
<p><span id="exr:ex0808" class="exercise"><strong>Exercise 8.8  </strong></span>
By rejecting the null hypothesis, our results are statistically significant. Do you believe they are practically significant? In other words, do you believe that the improvement in scores resulting from the learning activity is large enough to care about? Why or why not?</p>
</div>
</div>
<div id="estimated-power" class="section level3" number="8.3.3">
<h3>
<span class="header-section-number">8.3.3</span> Estimated power<a class="anchor" aria-label="anchor" href="#estimated-power"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, let’s try something interesting. Assume that the sample mean reflects the actual effect size:</p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="va">sample_mean</span></code></pre></div>
<p>Now we can use this to simulate plausible sample means we might have observed if the effect size were equal to the sample mean. As a result, we can see what the power of this test <strong>would be</strong> if applied to similar studies in the future. All we need to do now is run the <em>very same code</em> we used in our simulations above to visualize and calculate the <em>power</em> that this study had.</p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10000</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span>

<span class="va">sample_means</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-power_files/figure-html/unnamed-chunk-30-1.png" width="672"></div>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_lower</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">ci_upper</span>, mean <span class="op">=</span> <span class="va">null_mean</span> <span class="op">+</span> <span class="va">effect_size</span>, sd <span class="op">=</span> <span class="va">null_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.9104759</code></pre>

<div class="exercise">
<p><span id="exr:ex0809" class="exercise"><strong>Exercise 8.9  </strong></span>
Based on the power we just calculated, do you feel more confident believing that we correctly rejected the null hypothesis? Does this change your opinion about whether the results are practically significant? Why or why not?</p>
</div>
</div>
</div>
<div id="wrap-up-7" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-7"><i class="fas fa-link"></i></a>
</h2>
<p>We conducted simulations to see how effect size, sample size, alpha level, and population variability all affect the <strong>power</strong> of a test to correctly reject the null hypothesis. We conducted such a test on actual data studying whether a computer simulation learning activity increased student understanding of the concept of “positive feedback.” In addition, we saw how to use an observed effect size to calculate the power of a test.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></div>
<div class="next"><a href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab8"><span class="header-section-number">8</span> Statistical Power</a></li>
<li>
<a class="nav-link" href="#the-power-of-positive-feedback"><span class="header-section-number">8.1</span> The Power of Positive Feedback</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#look-at-the-data"><span class="header-section-number">8.1.1</span> Look at the data</a></li>
<li><a class="nav-link" href="#specifying-our-null-hypothesis"><span class="header-section-number">8.1.2</span> Specifying our null hypothesis</a></li>
<li><a class="nav-link" href="#building-our-confidence-interval"><span class="header-section-number">8.1.3</span> Building our confidence interval</a></li>
<li><a class="nav-link" href="#visualizing-the-distribution-of-sample-means"><span class="header-section-number">8.1.4</span> Visualizing the distribution of sample means</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#achieving-a-target-level-of-power"><span class="header-section-number">8.2</span> Achieving a target level of power</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#effect-size"><span class="header-section-number">8.2.1</span> Effect size</a></li>
<li><a class="nav-link" href="#sample-size"><span class="header-section-number">8.2.2</span> Sample size</a></li>
<li><a class="nav-link" href="#alpha-level"><span class="header-section-number">8.2.3</span> Alpha level</a></li>
<li><a class="nav-link" href="#population-standard-deviation"><span class="header-section-number">8.2.4</span> Population standard deviation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#using-data-to-test-the-null-hypothesis"><span class="header-section-number">8.3</span> Using data to test the null hypothesis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#confidence-interval-limits"><span class="header-section-number">8.3.1</span> Confidence interval limits</a></li>
<li><a class="nav-link" href="#the-p-value"><span class="header-section-number">8.3.2</span> The \(p\) value</a></li>
<li><a class="nav-link" href="#estimated-power"><span class="header-section-number">8.3.3</span> Estimated power</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-7"><span class="header-section-number">8.4</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/08-power.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/08-power.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-08-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
