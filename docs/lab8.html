<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 8 Inference for proportions | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Sampling</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Describing data</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Relationships between numerical variables</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Hypothesis testing with randomization</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Confidence intervals with bootstrapping</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> The normal distribution</a></li>
<li><a class="active" href="lab8.html"><span class="header-section-number">8</span> Inference for proportions</a></li>
<li><a class="" href="lab9.html"><span class="header-section-number">9</span> Inference for a single mean</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Inference for comparing two independent means</a></li>
<li><a class="" href="lab11.html"><span class="header-section-number">11</span> Inference for paired data</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">12</span> Inference for multiple independent groups</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab8" class="section level1" number="8">
<h1>
<span class="header-section-number">Lab 8</span> Inference for proportions<a class="anchor" aria-label="anchor" href="#lab8"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/robodoc.jpeg" width="100%"></div>
<p>In this session, we will collect all the techniques we have encountered for doing inferential statistics with proportions:</p>
<ul>
<li>
<a href="lab5.html#lab5">Hypothesis testing</a> for deciding whether two proportions are significantly different from one another.</li>
<li>
<a href="lab6.html#lab6">Confidence intervals</a> for representing what values of a population proportion are plausible based on a sample.</li>
<li>
<a href="lab7.html#lab7">Using the normal distribution</a> as a mathematical model for a sampling distribution.</li>
</ul>
<p>Many of the exercises in this activity will require you to look back to these previous sessions for hints and guidance as we apply these techniques to a new dataset that addresses the question of whether algorithms can help in making important medical diagnoses.</p>
<div id="required-packages-3" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Required packages<a class="anchor" aria-label="anchor" href="#required-packages-3"><i class="fas fa-link"></i></a>
</h2>
<p>Make sure you have loaded both the <code>tidyverse</code> and <code>infer</code> packages from R’s library:</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre class="Rout text-info"><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre class="Rout text-info"><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre class="Rout text-info"><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="get-to-know-the-data" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Get to know the data<a class="anchor" aria-label="anchor" href="#get-to-know-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>The data we will be working with in this session are from a study of whether using an algorithm can aid in the detection of “adenomas” in images from colonoscopies <span class="citation">(<a href="references.html#ref-Wang2019" role="doc-biblioref">Wang et al., 2019</a>)</span>. An adenoma is a benign tumor that can, in time, become malignant. For this reason, it is important to detect them early so they can be removed before they lead to colon cancer. Adenomas are detected by looking for particular structures in images like the one below:</p>
<div class="figure">
<img src="img/adenoma.jpg" alt=""><p class="caption">Example of detecting adenomas (outlined in blue) from a medical image.</p>
</div>
<p>As you can tell, looking for these structures is not always easy, even for experts. Part of the problem is that the images are all very similar to one another and an expert’s attention may not be drawn to the most important parts of the image. In other words, even though the application is in medical diagnosis, the “problem” is psychological. Perhaps a computer algorithm could help “solve” this problem by directing attention to the right parts of the image. On the other hand, it might be that the algorithm gives bad suggestions. The purpose of this study was to see whether the algorithm had an effect at all and, if so, whether it helped or hurt the detection of the adenomas that lead to colon cancer.</p>
<p>Run the line below to download the data into your R environment:</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">colonoscopy</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/colonoscopy.csv"</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-info"><code>## Rows: 1058 Columns: 2</code></pre>
<pre class="Rout text-info"><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (2): method, detected</code></pre>
<pre class="Rout text-info"><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Let’s take a quick look at the data:</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">colonoscopy</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 1,058 × 2
##    method         detected
##    &lt;chr&gt;          &lt;chr&gt;   
##  1 Routine        No      
##  2 Computer-aided No      
##  3 Computer-aided No      
##  4 Routine        No      
##  5 Routine        Yes     
##  6 Routine        No      
##  7 Computer-aided No      
##  8 Computer-aided Yes     
##  9 Routine        No      
## 10 Routine        No      
## # … with 1,048 more rows</code></pre>
<p>These data are from an <strong>experiment</strong>. Each row represents a specific image like the one shown above. Each image was randomly assigned to be analyzed using a different <code>method</code>: <code>"Routine"</code> analyses involved a professional analyst looking at the image; <code>"Computer-aided"</code> analyses used an automated algorithm to identify potential adenomas which were then double-checked by a human analyst. The variable <code>detected</code>, which is either <code>"Yes"</code> or <code>"No"</code>, indicates whether an adenoma was detected in the image.</p>
</div>
<div id="what-are-the-point-estimates" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> What are the point estimates?<a class="anchor" aria-label="anchor" href="#what-are-the-point-estimates"><i class="fas fa-link"></i></a>
</h2>
<p>Before we start doing any fancy inference, let’s first get the <strong>point estimates</strong>, that is, the proportions of images identified as containing an adenoma using each method. We can figure this out by hand using the counts in the table below:</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">colonoscopy</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">method</span>, <span class="va">detected</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-info"><code>## `summarise()` has grouped output by 'method'. You can override using the `.groups` argument.</code></pre>
<pre class="Rout text-muted"><code>## # A tibble: 4 × 3
## # Groups:   method [2]
##   method         detected     n
##   &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt;
## 1 Computer-aided No         370
## 2 Computer-aided Yes        152
## 3 Routine        No         427
## 4 Routine        Yes        109</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-53" class="exercise"><strong>Exercise 8.1  </strong></span>Refer to the frequency table above to answer the following questions.</p>
<ol style="list-style-type: lower-alpha">
<li>What is the proportion of images with an adenoma detected using the “Routine” method?</li>
<li>What is the proportion of images with an adenoma detected using the “Computer-aided” method?</li>
<li>Based on these point estimates, do these data suggest there may be a benefit to using the algorithm?</li>
</ol>
</div>
</div>
<div id="confidence-intervals" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"><i class="fas fa-link"></i></a>
</h2>
<p>Before we consider the question of whether the difference in proportions between methods is large enough that it probably isn’t due to chance, let’s take a moment to look at the detection rates using the routine method. In particular, based on this sample, we will construct a confidence interval. This interval will reflect how often the routine analysis detects adenomas in the whole population. First, we will find this interval using bootstrapping like we have before. Then, we will use the normal distribution.</p>
<div id="using-bootstrapping" class="section level3" number="8.4.1">
<h3>
<span class="header-section-number">8.4.1</span> Using bootstrapping<a class="anchor" aria-label="anchor" href="#using-bootstrapping"><i class="fas fa-link"></i></a>
</h3>
<div class="exercise">
<p><span id="exr:unlabeled-div-54" class="exercise"><strong>Exercise 8.2  </strong></span>Fill in the blanks in the code below to generate a bootstrap distribution for the proportion of adenomas detected using the <code>"Routine"</code> method and find the <strong>95% confidence interval</strong>.</p>
<p>The code will save the bootstrap distribution under the name <code>boot_dist_routine</code>. The confidence interval will be saved under <code>boot_ci_routine</code>. At the end, the code will <code>visualize</code> the result using a histogram with the confidence interval overlaid on top.</p>
<p>For guidance, be sure to refer to the <a href="lab6.html#lab6">previous activity</a>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="lab8.html#cb255-1" aria-hidden="true" tabindex="-1"></a>boot_dist_routine <span class="ot">&lt;-</span> colonoscopy <span class="sc">%&gt;%</span></span>
<span id="cb255-2"><a href="lab8.html#cb255-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-3"><a href="lab8.html#cb255-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(<span class="at">response =</span> ___, <span class="at">success =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-4"><a href="lab8.html#cb255-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-5"><a href="lab8.html#cb255-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"___"</span>)</span>
<span id="cb255-6"><a href="lab8.html#cb255-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-7"><a href="lab8.html#cb255-7" aria-hidden="true" tabindex="-1"></a>boot_ci_routine <span class="ot">&lt;-</span> boot_dist_routine <span class="sc">%&gt;%</span></span>
<span id="cb255-8"><a href="lab8.html#cb255-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_confidence_interval</span>(<span class="at">level =</span> ___)</span>
<span id="cb255-9"><a href="lab8.html#cb255-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-10"><a href="lab8.html#cb255-10" aria-hidden="true" tabindex="-1"></a>boot_dist_routine <span class="sc">%&gt;%</span></span>
<span id="cb255-11"><a href="lab8.html#cb255-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb255-12"><a href="lab8.html#cb255-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> boot_ci_routine)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>What code did you use?</li>
<li>What is the 95% confidence interval you found?</li>
<li>In your own words, interpret what this interval means in the context of this scenario.</li>
<li>Based on the histogram, do you think a normal distribution will be a good fit to this sampling distribution? Why or why not?</li>
</ol>
</div>
</div>
<div id="using-the-normal-distribution" class="section level3" number="8.4.2">
<h3>
<span class="header-section-number">8.4.2</span> Using the normal distribution<a class="anchor" aria-label="anchor" href="#using-the-normal-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>Last time, we saw that we could, at least some of the time, use the normal distribution to approximate a sampling distribution. An advantage of using the normal distribution is that we don’t need to simulate the distribution, we can figure out what it would look like using some math.</p>
<p>In particular, the normal distribution says that the sampling distribution will have a mean equal to the point estimate from our sample (<span class="math inline">\(\hat{p}\)</span>) and a standard error equal to <span class="math inline">\(\sqrt{\frac{\hat{p} \left(1 - \hat{p} \right)}{n}}\)</span> where <span class="math inline">\(n\)</span> is the sample size.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-55" class="exercise"><strong>Exercise 8.3  </strong></span>Fill in the blanks below to get R to remember the point estimate for the “Routine” method that you found earlier (this is our <span class="math inline">\(\hat{p}\)</span>) as well as the total number of observations using the “Routine” method (this is our <span class="math inline">\(n\)</span>). The corresponding standard error is then calculated and saved in R under the name <code>se_routine</code>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="lab8.html#cb256-1" aria-hidden="true" tabindex="-1"></a>p_hat_routine <span class="ot">&lt;-</span> ___</span>
<span id="cb256-2"><a href="lab8.html#cb256-2" aria-hidden="true" tabindex="-1"></a>n_routine <span class="ot">&lt;-</span> ___</span>
<span id="cb256-3"><a href="lab8.html#cb256-3" aria-hidden="true" tabindex="-1"></a>se_routine <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((p_hat_routine <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat_routine)) <span class="sc">/</span> n_routine)</span>
<span id="cb256-4"><a href="lab8.html#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="lab8.html#cb256-5" aria-hidden="true" tabindex="-1"></a>se_routine</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>What is the standard error?</li>
<li>Fill in the blanks in the following code to use the normal distribution to find the lower and upper boundaries of the 95% confidence interval (<code>ci_lower</code> and <code>ci_upper</code>, respectively). What did you get for the lower and upper boundaries of the confidence interval?</li>
</ol>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="lab8.html#cb257-1" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb257-2"><a href="lab8.html#cb257-2" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>How does the interval you just found in part (b) compare to the 95% CI you found earlier using bootstrapping? Are the boundaries similar or different?</li>
</ol>
</div>
</div>
</div>
<div id="hypothesis-test" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Hypothesis test<a class="anchor" aria-label="anchor" href="#hypothesis-test"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we have a handle on how well a routine analysis can detect adenomas, does using an algorithm have any effect at all? In other words, our <strong>research question</strong> is: <em>is there a difference in the proportion of detected adenomas using a routine method vs. a computer-aided method?</em> We will address this question using a hypothesis test, first doing it with randomization and then the normal distribution.</p>
<p>Note that we are interested in whether there is <em>any</em> effect of using the computer-aided method because, as noted above, it is possible that the algorithm could help by directing attention to more important parts of the image, but it could also hurt by directing attention to uninformative parts of the image. We want to make sure that our test is sensitive to <em>both</em> of these possible outcomes.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-56" class="exercise"><strong>Exercise 8.4  </strong></span>–</p>
<ol style="list-style-type: lower-alpha">
<li>What is the explanatory variable and what is the response variable?</li>
<li>What are the null and alternative hypotheses?</li>
</ol>
</div>
<p>Many of the techniques we will use are the same as those we used in an <a href="lab5.html#lab5">earlier activity</a>, just applied to the current <code>colonoscopy</code> data instead. Be sure to refer to that earlier activity for hints and guidance.</p>
<div id="the-point-estimate-of-the-difference" class="section level3" number="8.5.1">
<h3>
<span class="header-section-number">8.5.1</span> The point estimate of the difference<a class="anchor" aria-label="anchor" href="#the-point-estimate-of-the-difference"><i class="fas fa-link"></i></a>
</h3>
<div class="exercise">
<p><span id="exr:unlabeled-div-57" class="exercise"><strong>Exercise 8.5  </strong></span>Fill in the blanks in the code below to find the point estimate of the <em>difference</em> in proportions between routine and computer-aided methods.</p>
<p>For the <code>specify</code> line, remember that the first part goes <code>[name of response variable] ~ [name of explanatory variable]</code>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="lab8.html#cb258-1" aria-hidden="true" tabindex="-1"></a>obs_diff <span class="ot">&lt;-</span> colonoscopy <span class="sc">%&gt;%</span></span>
<span id="cb258-2"><a href="lab8.html#cb258-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(___ <span class="sc">~</span> ___, <span class="at">success =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb258-3"><a href="lab8.html#cb258-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in props"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Computer-aided"</span>, <span class="st">"Routine"</span>))</span>
<span id="cb258-4"><a href="lab8.html#cb258-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-5"><a href="lab8.html#cb258-5" aria-hidden="true" tabindex="-1"></a>obs_diff</span></code></pre></div>
<p>What was the code you used?</p>
</div>
</div>
<div id="using-randomization" class="section level3" number="8.5.2">
<h3>
<span class="header-section-number">8.5.2</span> Using randomization<a class="anchor" aria-label="anchor" href="#using-randomization"><i class="fas fa-link"></i></a>
</h3>
<p>First, we will conduct our hypothesis test by using randomization to simulate what the data would have looked like if the null hypothesis were true.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-58" class="exercise"><strong>Exercise 8.6  </strong></span>Fill in the blanks in the code below to use random permutation to simulate what the data would have looked like if the null hypothesis were true. The resulting sampling distribution will be saved under <code>null_dist_random</code> and then visualized using a histogram.</p>
<p><em>Hint:</em> For the last blank, there are three “legal” options: you can put either <code>direction = "less"</code>, <code>direction = "greater"</code>, or <code>direction = "two-sided"</code> depending on what the alternative hypothesis is.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="lab8.html#cb259-1" aria-hidden="true" tabindex="-1"></a>null_dist_random <span class="ot">&lt;-</span> colonoscopy <span class="sc">%&gt;%</span></span>
<span id="cb259-2"><a href="lab8.html#cb259-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(___ <span class="sc">~</span> ___, <span class="at">success =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-3"><a href="lab8.html#cb259-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-4"><a href="lab8.html#cb259-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-5"><a href="lab8.html#cb259-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in props"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Computer-aided"</span>, <span class="st">"Routine"</span>))</span>
<span id="cb259-6"><a href="lab8.html#cb259-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-7"><a href="lab8.html#cb259-7" aria-hidden="true" tabindex="-1"></a>null_dist_random <span class="sc">%&gt;%</span></span>
<span id="cb259-8"><a href="lab8.html#cb259-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb259-9"><a href="lab8.html#cb259-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> obs_diff, <span class="at">direction =</span> <span class="st">"___"</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>What was the code you used?</li>
<li>Based on the visualization you just made, would the observed difference in proportions be plausible if the null hypothesis were true?</li>
</ol>
</div>
</div>
<div id="using-the-normal-distribution-1" class="section level3" number="8.5.3">
<h3>
<span class="header-section-number">8.5.3</span> Using the normal distribution<a class="anchor" aria-label="anchor" href="#using-the-normal-distribution-1"><i class="fas fa-link"></i></a>
</h3>
<p>To see how the hypothesis test would go if we had used the normal distribution, we actually don’t need to do very much to our code. The major difference is that the <code>stat</code> that we calculate is called a <code>"z"</code>, that is, the code will directly calculate the <span class="math inline">\(Z\)</span> value. As we know, a <span class="math inline">\(Z\)</span> value is given by</p>
<p><span class="math display">\[
\begin{align}
Z &amp; = \frac{\text{Point estimate} - \text{Null mean}}{\text{Standard error}} \\
Z &amp; = \frac{(\hat{p}_1 - \hat{p}_2) - 0}{SE}
\end{align}
\]</span></p>
<p>where <span class="math inline">\((\hat{p}_1 - \hat{p}_2)\)</span> is the observed difference in proportions. As a result, a <span class="math inline">\(Z\)</span> value represents how unusual our observed difference is relative to the distribution of differences that would be expected if the null hypothesis were true.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-59" class="exercise"><strong>Exercise 8.7  </strong></span>–</p>
<ol style="list-style-type: lower-alpha">
<li>Fill in the blanks in the code below to find the <span class="math inline">\(Z\)</span> value for the observed difference. What was the <span class="math inline">\(Z\)</span> value you found?</li>
</ol>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="lab8.html#cb260-1" aria-hidden="true" tabindex="-1"></a>obs_z <span class="ot">&lt;-</span> colonoscopy <span class="sc">%&gt;%</span></span>
<span id="cb260-2"><a href="lab8.html#cb260-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(___ <span class="sc">~</span> ___, <span class="at">success =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-3"><a href="lab8.html#cb260-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"z"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Computer-aided"</span>, <span class="st">"Routine"</span>))</span>
<span id="cb260-4"><a href="lab8.html#cb260-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-5"><a href="lab8.html#cb260-5" aria-hidden="true" tabindex="-1"></a>obs_z</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Run the following code to visualize where our observed difference falls on the normal distribution. Compare the code below to the code we used in the previous exercise; what is similar and what is different?</li>
</ol>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_dist_normal</span> <span class="op">&lt;-</span> <span class="va">colonoscopy</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">detected</span> <span class="op">~</span> <span class="va">method</span>, success <span class="op">=</span> <span class="st">"Yes"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/assume.html">assume</a></span><span class="op">(</span><span class="st">"z"</span><span class="op">)</span>

<span class="va">null_dist_normal</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">obs_z</span>, direction <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Use the following code to find the <span class="math inline">\(p\)</span> value, that is, the proportion of differences that would be at least as extreme as the one we observed, if the null hypothesis were true. What is the <span class="math inline">\(p\)</span> value you got?</li>
</ol>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_dist_normal</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">obs_z</span>, direction <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Assuming we adopt a significance level of 0.05, do we reject the null hypothesis? What can we conclude about the relationship between using computer-aided analysis and accuracy of adenoma detection? (Recall that this is an <em>experiment</em>.)</li>
<li>Would we have ended up making a different decision using the randomization procedure in the previous section?</li>
</ol>
</div>
<!-- To use the normal distribution rather than randomization, we need to know its mean and standard deviation.  The mean is equal to what the different would be if the null hypothesis were true, namely, 0.  The standard error is found using the formula -->
<!-- $$ -->
<!-- SE = \sqrt{\hat{p}_{\text{Pool}} \left(1 - \hat{p}_{\text{Pool}} \right) \left(\frac{1}{n_1} + \frac{1}{n_2} \right)} -->
<!-- $$ -->
<!-- where $\hat{p}_{\text{Pool}}$ is the "pooled" proportion across the two groups being compared and $n_1$ and $n_2$ are the total numbers of observations in each group.  We can find the SE using the frequency table we found at the beginning of the session, which we reproduce here so you don't have to scroll: -->
<!-- ```{r echo = FALSE} -->
<!-- colonoscopy %>% -->
<!--     group_by(method, detected) %>% -->
<!--     summarize(n = n()) -->
<!-- ``` -->
<!-- ::: {.exercise} -->
<!-- Fill in the blanks below to get R to remember the pooled proportion (`p_hat_pool`) and the two group sizes (`n_routine` and `n_aided`).  The standard error for the difference in proportions is then calculated and saved in R under the name `se_diff`. -->
<!-- The pooled proportion is the *total number of detected adenomas* divided by the *total number of all images*. -->
<!-- ```{r eval=FALSE} -->
<!-- p_hat_pool <- ___ -->
<!-- n_routine <- ___ -->
<!-- n_aided <- ___ -->
<!-- se_diff <- sqrt(p_hat_pool * (1 - p_hat_pool) * ((1 / n_routine) + (1 / n_aided))) -->
<!-- se_diff -->
<!-- ``` -->
<!-- a. What is the standard error? -->
<!-- b. Fill in the blanks in the following code to use the normal distribution to find the lower and upper boundaries of the 95% confidence interval (`ci_lower` and `ci_upper`, respectively). -->
<!-- ```{r eval=FALSE} -->
<!-- ci_lower <- qnorm(p = 0.025, mean = ___, sd = ___, lower.tail = TRUE) -->
<!-- ci_upper <- qnorm(p = 0.025, mean = ___, sd = ___, lower.tail = FALSE) -->
<!-- ``` -->
<!-- What did you get for the lower and upper boundaries of the confidence interval? -->
<!-- c. How does the interval you just found in part (b) compare to the 95% CI you found earlier using bootstrapping?  Are the boundaries similar or different? -->
<!-- ::: -->
</div>
</div>
<div id="wrap-up-7" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-7"><i class="fas fa-link"></i></a>
</h2>
<p>In this session, we revisited many of the core concepts in statistical inference. We used both simulation and the normal distribution to find confidence intervals for individual proportions and to conduct hypothesis tests for comparing proportions.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab7.html"><span class="header-section-number">7</span> The normal distribution</a></div>
<div class="next"><a href="lab9.html"><span class="header-section-number">9</span> Inference for a single mean</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab8"><span class="header-section-number">8</span> Inference for proportions</a></li>
<li><a class="nav-link" href="#required-packages-3"><span class="header-section-number">8.1</span> Required packages</a></li>
<li><a class="nav-link" href="#get-to-know-the-data"><span class="header-section-number">8.2</span> Get to know the data</a></li>
<li><a class="nav-link" href="#what-are-the-point-estimates"><span class="header-section-number">8.3</span> What are the point estimates?</a></li>
<li>
<a class="nav-link" href="#confidence-intervals"><span class="header-section-number">8.4</span> Confidence intervals</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#using-bootstrapping"><span class="header-section-number">8.4.1</span> Using bootstrapping</a></li>
<li><a class="nav-link" href="#using-the-normal-distribution"><span class="header-section-number">8.4.2</span> Using the normal distribution</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#hypothesis-test"><span class="header-section-number">8.5</span> Hypothesis test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-point-estimate-of-the-difference"><span class="header-section-number">8.5.1</span> The point estimate of the difference</a></li>
<li><a class="nav-link" href="#using-randomization"><span class="header-section-number">8.5.2</span> Using randomization</a></li>
<li><a class="nav-link" href="#using-the-normal-distribution-1"><span class="header-section-number">8.5.3</span> Using the normal distribution</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-7"><span class="header-section-number">8.6</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/08-inference_proportions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/08-inference_proportions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2022-04-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
