<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 12 Exploring Data with R, Part II | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Central tendency and variability</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Scatterplots and correlation</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Probability and simulation</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Models: The Binomial and the Normal</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></li>
<li><a class="" href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></li>
<li><a class="" href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li><a class="active" href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="coderef.html"><span class="header-section-number">A</span> Distributions</a></li>
<li><a class="" href="hyptests.html"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab12" class="section level1" number="12">
<h1>
<span class="header-section-number">Lab 12</span> Exploring Data with R, Part II<a class="anchor" aria-label="anchor" href="#lab12"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/bike.png" width="100%"></div>
<p>In this session, we will do a bit of exploration with data. This is in keeping with the theme of our first session, only now enriched by the new tools and understanding we have developed since then.</p>
<p>Also in keeping with the theme of exploration, we will be looking at a single dataset about bike sharing. These data were recorded in 2011 and 2012 in Washington, DC. They record the number of riders in a new bike sharing program on each day. We will explore patterns in how bike sharing behavior changes across the year, with the weather, and during specific events. This may not be quite a satisfying as exploring on a real bike, but it comes pretty close.</p>
<p>To begin, let’s make sure we have our packages loaded from the library. We will need <code>tidyverse</code> and <code>magrittr</code>:</p>
<div class="sourceCode" id="cb511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'magrittr'</code></pre>
<pre><code>## The following object is masked from 'package:purrr':
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     extract</code></pre>
<div id="meet-your-data-1" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Meet your data<a class="anchor" aria-label="anchor" href="#meet-your-data-1"><i class="fas fa-link"></i></a>
</h2>
<p>Download the data into your R session with the following bit of code:</p>
<div class="sourceCode" id="cb519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bike_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/bike.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 731 Columns: 13</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr  (3): season, day, weather
## dbl  (7): year, month, celsius_actual, celsius_feelslike, humidity, windspee...
## lgl  (2): holiday, workday
## date (1): date</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Click on the data in RStudio’s “Environment” pane to get a sense of what is here. Each row corresponds to a specific day. Most of the variables are pretty self-explanatory. Our <strong>response variable</strong> of interest is <code>num_riders</code>, the number of people who used the bike share that day.</p>
<p>First, let’s make ourselves a histogram to get a sense of how ridership is distributed from day to day.</p>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bike_data</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_riders</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="12-exploring_again_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex1201" class="exercise"><strong>Exercise 12.1  </strong></span>Based on the histogram, describe the shape of the distribution. Does it seem skewed at all? Does it seem like there is just one mode, or many modes?</p>
</div>
</div>
<div id="answering-questions-with-data-1" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Answering questions with data<a class="anchor" aria-label="anchor" href="#answering-questions-with-data-1"><i class="fas fa-link"></i></a>
</h2>
<p>The histogram we just made shows how daily ridership is distributed over the two years we have records for, but it doesn’t tell us <em>why</em> ridership looks the way it does. Fortunately, our dataset contains many other variables that will let us understand why people choose to use bikes differently on different days.</p>
<p>The first thing we’ll do is make a <strong>scatterplot</strong> with the date on the horizontal axis and the number of riders on the vertical axis.</p>

<div class="exercise">
<p><span id="exr:ex1202" class="exercise"><strong>Exercise 12.2  </strong></span>Fill in the blanks in the code below to reproduce the scatterplot shown (hint: what are the names of the variables we want to put on the two axes? And what <code>geom</code> have we used to make scatterplots before?). What big trends do you see, and what shape do those trends seem to have?</p>
</div>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="lab12.html#cb524-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb524-2"><a href="lab12.html#cb524-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb524-3"><a href="lab12.html#cb524-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<div class="inline-figure"><img src="12-exploring_again_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<div id="does-ridership-vary-by-season" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Does ridership vary by season?<a class="anchor" aria-label="anchor" href="#does-ridership-vary-by-season"><i class="fas fa-link"></i></a>
</h3>
<p>It looks like the time of year might be an important explanatory variable, so let’s try to answer the <strong>research question</strong>, <em>does ridership vary by season?</em></p>
<div id="visualization-1" class="section level4" number="12.2.1.1">
<h4>
<span class="header-section-number">12.2.1.1</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization-1"><i class="fas fa-link"></i></a>
</h4>
<p>Before doing any kind of hypothesis test, let’s add a bit of color to the scatterplot we made above…literally! This will highlight any differences between seasons.</p>

<div class="exercise">
<p><span id="exr:ex1203" class="exercise"><strong>Exercise 12.3  </strong></span>Fill in the blanks in the code below to reproduce the scatterplot shown (hint: how did you fill in the blanks in the last exercise?). Does it seem like season explains a lot of the differences in bike riding? Does it look like there are other changes in bike riding over time that seasons might not explain?</p>
</div>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="lab12.html#cb525-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb525-2"><a href="lab12.html#cb525-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb525-3"><a href="lab12.html#cb525-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<div class="inline-figure"><img src="12-exploring_again_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
</div>
<div id="hypothesis-testing-1" class="section level4" number="12.2.1.2">
<h4>
<span class="header-section-number">12.2.1.2</span> Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing-1"><i class="fas fa-link"></i></a>
</h4>
<p>To see whether we have statistical evidence in favor of the idea that the seasons explain bike riding, we will conduct an <strong>Analysis of Variance</strong>.</p>
<ol style="list-style-type: decimal">
<li>Translate your research question into a null and alternative hypothesis</li>
</ol>
<p>As usual, the null hypothesis in ANOVA is that the population mean ridership is the same across all four seasons (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2 = \mu_3 = \mu_4\)</span>). The alternative hypothesis is that mean ridership is <em>not</em> the same across all four seasons (i.e., at least one season is different on average from the others).</p>
<ol start="2" style="list-style-type: decimal">
<li>Select an alpha level</li>
</ol>
<p>We’ll try a more conservative alpha level this time, say 0.01.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(F\)</span> value</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value</p></li>
<li><p>Decide whether or not to reject the null hypothesis</p></li>
</ol>
<p>As usual, we will do steps 3 and 4 using a bit of R code and you’ll do step 5 based on the results.</p>

<div class="exercise">
<p><span id="exr:ex1204" class="exercise"><strong>Exercise 12.4  </strong></span>Fill in the blanks in the code below to reproduce the ANOVA table shown (hint: what are the names of the explanatory and response variable? What is the final line when we did ANOVA in prior labs?). Do you reject the null hypothesis? What does this say about how ridership varies by season?</p>
</div>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="lab12.html#cb526-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%$%</span></span>
<span id="cb526-2"><a href="lab12.html#cb526-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(___ <span class="sc">~</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb526-3"><a href="lab12.html#cb526-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: num_riders
##            Df     Sum Sq   Mean Sq F value    Pr(&gt;F)    
## season      3  950595868 316865289  128.77 &lt; 2.2e-16 ***
## Residuals 727 1788939524   2460715                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="how-much-does-season-explain" class="section level4" number="12.2.1.3">
<h4>
<span class="header-section-number">12.2.1.3</span> How much does season explain?<a class="anchor" aria-label="anchor" href="#how-much-does-season-explain"><i class="fas fa-link"></i></a>
</h4>
<p>Finally, let’s ask how much of the variability in ridership can be explained by differences in season? This question is answered by the quantity <span class="math inline">\(\eta^2\)</span>, and we can get it directly from the entries in the ANOVA table we just made. As we know, the formula for <span class="math inline">\(\eta^2\)</span> is</p>
<p><span class="math display">\[
\eta^2 = \frac{SS_B}{SS_B + SS_W}
\]</span>
The numbers we need are given in the “Sum Sq.” column in the ANOVA table, so we can calculate <span class="math inline">\(\eta^2\)</span> in R like so:</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">950595868</span> <span class="op">/</span> <span class="op">(</span><span class="fl">950595868</span> <span class="op">+</span> <span class="fl">1788939524</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3469916</code></pre>
<p>The result above tells us the proportion of variability in ridership that can be explained by differences between seasons. That’s pretty respectable, but can we do better?</p>
</div>
</div>
<div id="does-ridership-vary-with-actual-temperature" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Does ridership vary with actual temperature?<a class="anchor" aria-label="anchor" href="#does-ridership-vary-with-actual-temperature"><i class="fas fa-link"></i></a>
</h3>
<p>As we saw above, it looked like there were substantial changes in ridership not just between seasons, but within seasons as well. For example, ridership tends to increase over the winter. Perhaps this is because of warming temperatures? In other words, can differences in ridership be explained by differences in <em>temperature</em>?</p>
<p>Note that our data includes <strong>two</strong> measures of temperature: A measure of the <em>actual</em> temperature that day (<code>celsius_actual</code>), and a measure of what the temperature <em>felt like</em> that day (<code>celsius_feelslike</code>).</p>
<p>We will first look at actual temperatures and then look at “felt like” temperatures in the next section.</p>
<div id="from-celsius-to-fahrenheit" class="section level4" number="12.2.2.1">
<h4>
<span class="header-section-number">12.2.2.1</span> From Celsius to Fahrenheit<a class="anchor" aria-label="anchor" href="#from-celsius-to-fahrenheit"><i class="fas fa-link"></i></a>
</h4>
<p>For some reason, despite the fact that these data were recorded in the US, temperature was measured in degrees Celsius. For those of us who still think in degrees Fahrenheit, it will be useful to convert these temperatures. We can do this using <code>mutate</code>. We then tell R to remember the <code>mutate</code>d dataset under the same name <code>bike_data</code>, so that we can use this variable later.</p>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bike_data</span> <span class="op">&lt;-</span> <span class="va">bike_data</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>fahrenheit_actual <span class="op">=</span> <span class="fl">1.8</span> <span class="op">*</span> <span class="va">celsius_actual</span> <span class="op">+</span> <span class="fl">32</span><span class="op">)</span></code></pre></div>
<p><strong>If you get an error</strong> about not finding the new temperature variable we just made, make sure you’ve run the chunk of code above!</p>
</div>
<div id="visualization-2" class="section level4" number="12.2.2.2">
<h4>
<span class="header-section-number">12.2.2.2</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization-2"><i class="fas fa-link"></i></a>
</h4>
<p>As above, let’s make ourselves a visualization so we can get a sense of how much temperature will be able to explain changes in bike riding behavior. Again, we will color in our scatterplot above. But now we will color it in based on temperature, not season.</p>

<div class="exercise">
<p><span id="exr:ex1205" class="exercise"><strong>Exercise 12.5  </strong></span>Fill in the blanks in the code below to reproduce the scatterplot shown (hint: how did you fill in the blanks in the last exercise? What is the name of the new temperature variable we just made?). Does it seem like temperature could account for a lot of differences in bike riding? Does it seem like a better explanation than the seasons?</p>
</div>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="lab12.html#cb531-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb531-2"><a href="lab12.html#cb531-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb531-3"><a href="lab12.html#cb531-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<div class="inline-figure"><img src="12-exploring_again_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<p>Interesting! Now let’s try looking at another scatterplot, this time with temperature on the horizontal axis and number of riders on the vertical axis, and no color.</p>

<div class="exercise">
<p><span id="exr:ex1206" class="exercise"><strong>Exercise 12.6  </strong></span>Fill in the blanks in the code below to reproduce the scatterplot shown (hint: what variables are we putting on which axes?). Does it seems like there is a positive or negative correlation between temperature and ridership? Does this correlation seem weak or strong?</p>
</div>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="lab12.html#cb532-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb532-2"><a href="lab12.html#cb532-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb532-3"><a href="lab12.html#cb532-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<div class="inline-figure"><img src="12-exploring_again_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
</div>
<div id="hypothesis-testing-2" class="section level4" number="12.2.2.3">
<h4>
<span class="header-section-number">12.2.2.3</span> Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing-2"><i class="fas fa-link"></i></a>
</h4>
<p>To see whether we have statistical evidence in favor of the idea that actual temperature explains bike riding, we will conduct an <strong>linear regression</strong> analysis.</p>
<ol style="list-style-type: decimal">
<li>Translate your research question into a null and alternative hypothesis</li>
</ol>
<p>The null hypothesis is that the slope of the linear relationship between actual temperature and ridership is zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(b_1 = 0\)</span>). The alternative hypothesis is that this slope is not equal to zero (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(b_1 \neq 0\)</span>).</p>
<ol start="2" style="list-style-type: decimal">
<li>Select an alpha level</li>
</ol>
<p>We’ll keep our alpha level from before at 0.01.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(F\)</span> value</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value</p></li>
<li><p>Decide whether or not to reject the null hypothesis</p></li>
</ol>
<p>Again, we will do steps 3 and 4 using a bit of R code and you’ll do step 5 based on the results.</p>

<div class="exercise">
<p><span id="exr:ex1207" class="exercise"><strong>Exercise 12.7  </strong></span>Fill in the blanks in the code below to reproduce the table shown (hint: what are the names of the explanatory and response variable? What should the final line be?). Do you reject the null hypothesis? What does this say about how ridership varies with actual temperature?</p>
</div>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="lab12.html#cb533-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%$%</span></span>
<span id="cb533-2"><a href="lab12.html#cb533-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(___ <span class="sc">~</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb533-3"><a href="lab12.html#cb533-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: num_riders
##                    Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
## fahrenheit_actual   1 1078688585 1078688585  473.47 &lt; 2.2e-16 ***
## Residuals         729 1660846807    2278254                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="how-much-does-season-explain-1" class="section level4" number="12.2.2.4">
<h4>
<span class="header-section-number">12.2.2.4</span> How much does season explain?<a class="anchor" aria-label="anchor" href="#how-much-does-season-explain-1"><i class="fas fa-link"></i></a>
</h4>
<p>How much of the variability in ridership can be explained by differences in actual temperature? Again, we can answer this question using numbers from the table above to find <span class="math inline">\(r^2\)</span>, the proportion of variance in the response variable that can be explained by the explanatory variable. As we know, the formula for <span class="math inline">\(r^2\)</span> is</p>
<p><span class="math display">\[
r^2 = \frac{SS_{\text{Model}}}{SS_{\text{Model}} + SS_{\text{Resid}}}
\]</span>
By grabbing the relevant numbers from the “Sum Sq.” column above, we can calculate this in R like so:</p>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1078688585</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1078688585</span> <span class="op">+</span> <span class="fl">1660846807</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3937487</code></pre>
<p>The result above is the proportion of variability in ridership that can be explained by differences in actual temperature.</p>
<p>We will also want to get the intercept and slope of this linear relationship.</p>

<div class="exercise">
<p><span id="exr:ex1208" class="exercise"><strong>Exercise 12.8  </strong></span>Fill in the blanks in the code below to get the slope and intercept of the line describing the relationship between actual temperature and bike ridership. Based on these results, if the actual temperature increases by one degree Fahrenheit, how many more riders would we expect to see?</p>
</div>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="lab12.html#cb537-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%$%</span></span>
<span id="cb537-2"><a href="lab12.html#cb537-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(___ <span class="sc">~</span> ___)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = num_riders ~ fahrenheit_actual)
## 
## Coefficients:
##       (Intercept)  fahrenheit_actual  
##          -1664.80              89.98</code></pre>
</div>
</div>
<div id="does-ridership-vary-with-perceived-temperature" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Does ridership vary with <em>perceived</em> temperature?<a class="anchor" aria-label="anchor" href="#does-ridership-vary-with-perceived-temperature"><i class="fas fa-link"></i></a>
</h3>
<p>It looks like we can do a good job explaining changes in ridership in terms of changes in temperature. But we just used the actual (thermometer) temperature. Maybe what matters more is the temperature it <em>feels like</em> on any given day, which is not just a matter of the thermometer, but also cloud cover, wind, humidity, etc.</p>
<p>The temperature that it <em>felt like</em> on each day is given in our dataset by the variable <code>celsius_feelslike</code>. Let’s repeat the analyses from the previous section using this different temperature variable and see if we can explain any more variance in riding behavior.</p>
<div id="from-celsius-to-fahrenheit-1" class="section level4" number="12.2.3.1">
<h4>
<span class="header-section-number">12.2.3.1</span> From Celsius to Fahrenheit<a class="anchor" aria-label="anchor" href="#from-celsius-to-fahrenheit-1"><i class="fas fa-link"></i></a>
</h4>
<p>Again, we will convert the “felt like” temperature to Fahrenheit and use this for our analyses instead of Celsius.</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bike_data</span> <span class="op">&lt;-</span> <span class="va">bike_data</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>fahrenheit_feelslike <span class="op">=</span> <span class="fl">1.8</span> <span class="op">*</span> <span class="va">celsius_feelslike</span> <span class="op">+</span> <span class="fl">32</span><span class="op">)</span></code></pre></div>
<p>Again, <strong>if you get an error</strong> about not finding the new temperature variable we just made, make sure you’ve run the chunk of code above!</p>
</div>
<div id="visualization-3" class="section level4" number="12.2.3.2">
<h4>
<span class="header-section-number">12.2.3.2</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization-3"><i class="fas fa-link"></i></a>
</h4>
<p>As above, let’s make ourselves a visualization so we can get a sense of how much temperature will be able to explain changes in bike riding behavior. Again, we will color in our scatterplot above. But now we will color it in based on temperature, not season.</p>

<div class="exercise">
<p><span id="exr:ex1209" class="exercise"><strong>Exercise 12.9  </strong></span>Fill in the blanks in the code below to reproduce the scatterplot shown (hint: how did you fill in the blanks in the last exercise? What is the name of the new temperature variable we just made?). Does this look any different than when we colored the plot using actual temperature? Are there any points that seem to have an unusual “felt like” temperature compared to nearby points?</p>
</div>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="lab12.html#cb540-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%&gt;%</span></span>
<span id="cb540-2"><a href="lab12.html#cb540-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb540-3"><a href="lab12.html#cb540-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<div class="inline-figure"><img src="12-exploring_again_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
</div>
<div id="hypothesis-testing-3" class="section level4" number="12.2.3.3">
<h4>
<span class="header-section-number">12.2.3.3</span> Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing-3"><i class="fas fa-link"></i></a>
</h4>
<p>To see whether we have statistical evidence in favor of the idea that the “felt like” temperature explains bike riding, we will conduct an <strong>linear regression</strong> analysis.</p>
<ol style="list-style-type: decimal">
<li>Translate your research question into a null and alternative hypothesis</li>
</ol>
<p>The null hypothesis is that the slope of the linear relationship between “felt like” temperature and ridership is zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(b_1 = 0\)</span>). The alternative hypothesis is that this slope is not equal to zero (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(b_1 \neq 0\)</span>).</p>
<ol start="2" style="list-style-type: decimal">
<li>Select an alpha level</li>
</ol>
<p>We’ll keep our alpha level from before at 0.01.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(F\)</span> value</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value</p></li>
<li><p>Decide whether or not to reject the null hypothesis</p></li>
</ol>
<p>Again, we will do steps 3 and 4 using a bit of R code and you’ll do step 5 based on the results.</p>

<div class="exercise">
<p><span id="exr:ex1210" class="exercise"><strong>Exercise 12.10  </strong></span>Fill in the blanks in the code below to reproduce the table shown (hint: what are the names of the explanatory and response variable? What should the final line be?). Do you reject the null hypothesis? What does this say about how ridership varies with felt-like temperature?</p>
</div>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="lab12.html#cb541-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%$%</span></span>
<span id="cb541-2"><a href="lab12.html#cb541-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(___ <span class="sc">~</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb541-3"><a href="lab12.html#cb541-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">___</span>()</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: num_riders
##                       Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
## fahrenheit_feelslike   1 1091003307 1091003307  482.45 &lt; 2.2e-16 ***
## Residuals            729 1648532085    2261361                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="how-much-does-season-explain-2" class="section level4" number="12.2.3.4">
<h4>
<span class="header-section-number">12.2.3.4</span> How much does season explain?<a class="anchor" aria-label="anchor" href="#how-much-does-season-explain-2"><i class="fas fa-link"></i></a>
</h4>
<p>How much of the variability in ridership can be explained by differences in <em>felt like</em> temperature? Again, we can answer this question using numbers from the table above to find <span class="math inline">\(r^2\)</span>, the proportion of variance in the response variable that can be explained by the explanatory variable. The numbers we need are given in the “Sum Sq.” column in the able above, so we can calculate this in R like so:</p>
<div class="sourceCode" id="cb543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1091003307</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1091003307</span> <span class="op">+</span> <span class="fl">1648532085</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3982439</code></pre>
<p>The result above is the proportion of variability in ridership that can be explained by differences in actual temperature.</p>

<div class="exercise">
<p><span id="exr:ex1211" class="exercise"><strong>Exercise 12.11  </strong></span>Is the proportion of variance explained by “felt like” temperature any higher than the proportion of variance explained by actual temperature? Which of the three variables we’ve looked at does a better job explaining riding behavior, season, actual temperature, or “felt like” temperature?</p>
</div>
<p>Finally, we will also want to get the intercept and slope of this linear relationship.</p>

<div class="exercise">
<p><span id="exr:ex1212" class="exercise"><strong>Exercise 12.12  </strong></span>Fill in the blanks in the code below to get the slope and intercept of the line describing the relationship between “felt like” temperature and bike ridership. Based on these results, if the “felt like” temperature increases by one degree Fahrenheit, how many more riders would we expect to see?</p>
</div>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="lab12.html#cb545-1" aria-hidden="true" tabindex="-1"></a>bike_data <span class="sc">%$%</span></span>
<span id="cb545-2"><a href="lab12.html#cb545-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(___ <span class="sc">~</span> ___)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = num_riders ~ fahrenheit_feelslike)
## 
## Coefficients:
##          (Intercept)  fahrenheit_feelslike  
##             -1721.49                 83.35</code></pre>
</div>
</div>
<div id="whats-up-with-those-weird-days" class="section level3" number="12.2.4">
<h3>
<span class="header-section-number">12.2.4</span> What’s up with those weird days?<a class="anchor" aria-label="anchor" href="#whats-up-with-those-weird-days"><i class="fas fa-link"></i></a>
</h3>
<p>In all the scatterplots we’ve made above, you may have noticed that there are some summer days that would normally have large numbers of riders, but actually have very low ridership. It’s a bit hard to see the actual days on the plots, so here are a few of these apparent “outlier” days with very low ridership:</p>
<ul>
<li>2011-08-27</li>
<li>2012-04-22</li>
<li>2012-10-29</li>
</ul>
<div class="exercise">
<p><span id="exr:ex1213" class="exercise"><strong>Exercise 12.13  </strong></span>Use your search engine of choice to do a search using each of the dates given above plus the term “Washington DC” (where these data were recorded). What unusual events were happening on each of these three days in the DC area that might explain the abnormally low ridership on these days?</p>
</div>
</div>
</div>
<div id="wrap-up-11" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-11"><i class="fas fa-link"></i></a>
</h2>
<p>We have explored an interesting dataset with the aim of explaining why bike riding behavior change from day to day. We have illustrated the power of both visualization and inferential statistics for helping us use data to answer interesting questions. We have also discovered outliers and gone beyond our data to understand why they might have occurred.</p>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></div>
<div class="next"><a href="coderef.html"><span class="header-section-number">A</span> Distributions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab12"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li><a class="nav-link" href="#meet-your-data-1"><span class="header-section-number">12.1</span> Meet your data</a></li>
<li>
<a class="nav-link" href="#answering-questions-with-data-1"><span class="header-section-number">12.2</span> Answering questions with data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#does-ridership-vary-by-season"><span class="header-section-number">12.2.1</span> Does ridership vary by season?</a></li>
<li><a class="nav-link" href="#does-ridership-vary-with-actual-temperature"><span class="header-section-number">12.2.2</span> Does ridership vary with actual temperature?</a></li>
<li><a class="nav-link" href="#does-ridership-vary-with-perceived-temperature"><span class="header-section-number">12.2.3</span> Does ridership vary with perceived temperature?</a></li>
<li><a class="nav-link" href="#whats-up-with-those-weird-days"><span class="header-section-number">12.2.4</span> What’s up with those weird days?</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-11"><span class="header-section-number">12.3</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/12-exploring_again.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/12-exploring_again.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-08-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
