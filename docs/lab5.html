<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 5 Models: The Binomial and the Normal | Labs</title>
  <meta name="description" content="Laboratory exercises for APSY210." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 5 Models: The Binomial and the Normal | Labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Laboratory exercises for APSY210." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 5 Models: The Binomial and the Normal | Labs" />
  
  <meta name="twitter:description" content="Laboratory exercises for APSY210." />
  

<meta name="author" content="Greg Cox" />


<meta name="date" content="2021-03-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab4.html"/>
<link rel="next" href="lab6.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Labs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>1</b> Exploring Data with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lab1.html"><a href="lab1.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="lab1.html"><a href="lab1.html#meet-your-data"><i class="fa fa-check"></i><b>1.2</b> Meet your data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lab1.html"><a href="lab1.html#check-out-the-variables"><i class="fa fa-check"></i><b>1.2.1</b> Check out the variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab1.html"><a href="lab1.html#answering-questions-with-data"><i class="fa fa-check"></i><b>1.3</b> Answering questions with data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="lab1.html"><a href="lab1.html#frequency-tables"><i class="fa fa-check"></i><b>1.3.1</b> Frequency tables</a></li>
<li class="chapter" data-level="1.3.2" data-path="lab1.html"><a href="lab1.html#bar-charts"><i class="fa fa-check"></i><b>1.3.2</b> Bar charts</a></li>
<li class="chapter" data-level="1.3.3" data-path="lab1.html"><a href="lab1.html#histograms"><i class="fa fa-check"></i><b>1.3.3</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="lab1.html"><a href="lab1.html#wrap-up"><i class="fa fa-check"></i><b>1.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab2.html"><a href="lab2.html"><i class="fa fa-check"></i><b>2</b> Central tendency and variability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lab2.html"><a href="lab2.html#simple-cases"><i class="fa fa-check"></i><b>2.1</b> Simple cases</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lab2.html"><a href="lab2.html#central-tendency"><i class="fa fa-check"></i><b>2.1.1</b> Central tendency</a></li>
<li class="chapter" data-level="2.1.2" data-path="lab2.html"><a href="lab2.html#variability"><i class="fa fa-check"></i><b>2.1.2</b> Variability</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lab2.html"><a href="lab2.html#dealing-with-real-data"><i class="fa fa-check"></i><b>2.2</b> Dealing with real data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lab2.html"><a href="lab2.html#setting-the-stage"><i class="fa fa-check"></i><b>2.2.1</b> Setting the stage</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab2.html"><a href="lab2.html#getting-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Getting the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="lab2.html"><a href="lab2.html#visualizing-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Visualizing the data</a></li>
<li class="chapter" data-level="2.2.4" data-path="lab2.html"><a href="lab2.html#central-tendency-1"><i class="fa fa-check"></i><b>2.2.4</b> Central tendency</a></li>
<li class="chapter" data-level="2.2.5" data-path="lab2.html"><a href="lab2.html#variability-1"><i class="fa fa-check"></i><b>2.2.5</b> Variability</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab2.html"><a href="lab2.html#wrap-up-1"><i class="fa fa-check"></i><b>2.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lab3.html"><a href="lab3.html"><i class="fa fa-check"></i><b>3</b> Scatterplots and correlation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lab3.html"><a href="lab3.html#calculating-the-pearson-correlation-coefficient"><i class="fa fa-check"></i><b>3.1</b> Calculating the Pearson correlation coefficient</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lab3.html"><a href="lab3.html#from-x-to-z"><i class="fa fa-check"></i><b>3.1.1</b> From <span class="math inline">\(X\)</span> to <span class="math inline">\(z\)</span></a></li>
<li class="chapter" data-level="3.1.2" data-path="lab3.html"><a href="lab3.html#finding-the-correlation-coefficient"><i class="fa fa-check"></i><b>3.1.2</b> Finding the correlation coefficient</a></li>
<li class="chapter" data-level="3.1.3" data-path="lab3.html"><a href="lab3.html#dealing-with-real-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Dealing with real data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lab3.html"><a href="lab3.html#scatterplots"><i class="fa fa-check"></i><b>3.2</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lab3.html"><a href="lab3.html#making-a-group-of-scatterplots"><i class="fa fa-check"></i><b>3.2.1</b> Making a group of scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lab3.html"><a href="lab3.html#some-bigger-data"><i class="fa fa-check"></i><b>3.3</b> Some bigger data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lab3.html"><a href="lab3.html#import-the-data"><i class="fa fa-check"></i><b>3.3.1</b> Import the data</a></li>
<li class="chapter" data-level="3.3.2" data-path="lab3.html"><a href="lab3.html#experience-and-memory-for-barbies"><i class="fa fa-check"></i><b>3.3.2</b> Experience and memory for Barbies</a></li>
<li class="chapter" data-level="3.3.3" data-path="lab3.html"><a href="lab3.html#experience-and-memory-for-transformers"><i class="fa fa-check"></i><b>3.3.3</b> Experience and memory for Transformers</a></li>
<li class="chapter" data-level="3.3.4" data-path="lab3.html"><a href="lab3.html#experience-with-barbies-and-memory-for-transformers"><i class="fa fa-check"></i><b>3.3.4</b> Experience with Barbies and memory for Transformers</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lab3.html"><a href="lab3.html#wrap-up-2"><i class="fa fa-check"></i><b>3.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab4.html"><a href="lab4.html"><i class="fa fa-check"></i><b>4</b> Probability and simulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab4.html"><a href="lab4.html#simulation-basics"><i class="fa fa-check"></i><b>4.1</b> Simulation basics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lab4.html"><a href="lab4.html#single-coin-flips"><i class="fa fa-check"></i><b>4.1.1</b> Single coin flips</a></li>
<li class="chapter" data-level="4.1.2" data-path="lab4.html"><a href="lab4.html#a-sequence-of-coin-flips"><i class="fa fa-check"></i><b>4.1.2</b> A sequence of coin flips</a></li>
<li class="chapter" data-level="4.1.3" data-path="lab4.html"><a href="lab4.html#remembering-simulated-results"><i class="fa fa-check"></i><b>4.1.3</b> Remembering simulated results</a></li>
<li class="chapter" data-level="4.1.4" data-path="lab4.html"><a href="lab4.html#turning-simulated-results-into-data"><i class="fa fa-check"></i><b>4.1.4</b> Turning simulated results into “data”</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lab4.html"><a href="lab4.html#estimating-probabilities"><i class="fa fa-check"></i><b>4.2</b> Estimating probabilities</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lab4.html"><a href="lab4.html#frequency-table"><i class="fa fa-check"></i><b>4.2.1</b> Frequency table</a></li>
<li class="chapter" data-level="4.2.2" data-path="lab4.html"><a href="lab4.html#estimating-probability-from-frequency"><i class="fa fa-check"></i><b>4.2.2</b> Estimating probability from frequency</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lab4.html"><a href="lab4.html#more-advanced-simulation-tricks"><i class="fa fa-check"></i><b>4.3</b> More advanced simulation tricks</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lab4.html"><a href="lab4.html#making-up-our-own-probabilities"><i class="fa fa-check"></i><b>4.3.1</b> Making up our own probabilities</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab4.html"><a href="lab4.html#expanding-the-sample-space"><i class="fa fa-check"></i><b>4.3.2</b> Expanding the sample space</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lab4.html"><a href="lab4.html#estimating-probabilities-in-data"><i class="fa fa-check"></i><b>4.4</b> Estimating probabilities in data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lab4.html"><a href="lab4.html#what-was-kobes-hit-rate"><i class="fa fa-check"></i><b>4.4.1</b> What was Kobe’s hit rate?</a></li>
<li class="chapter" data-level="4.4.2" data-path="lab4.html"><a href="lab4.html#a-simulated-kobe"><i class="fa fa-check"></i><b>4.4.2</b> A simulated Kobe</a></li>
<li class="chapter" data-level="4.4.3" data-path="lab4.html"><a href="lab4.html#hot--or-cold-handed"><i class="fa fa-check"></i><b>4.4.3</b> Hot- or cold-handed</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lab4.html"><a href="lab4.html#wrap-up-3"><i class="fa fa-check"></i><b>4.5</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab5.html"><a href="lab5.html"><i class="fa fa-check"></i><b>5</b> Models: The Binomial and the Normal</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lab5.html"><a href="lab5.html#the-binomial-distribution-in-r"><i class="fa fa-check"></i><b>5.1</b> The binomial distribution in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lab5.html"><a href="lab5.html#translating-from-sample-to-rbinom"><i class="fa fa-check"></i><b>5.1.1</b> Translating from <code>sample</code> to <code>rbinom</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="lab5.html"><a href="lab5.html#outcomes-from-different-sequences-of-events"><i class="fa fa-check"></i><b>5.1.2</b> Outcomes from different sequences of events</a></li>
<li class="chapter" data-level="5.1.3" data-path="lab5.html"><a href="lab5.html#simulated-relative-frequencies-and-probabilities"><i class="fa fa-check"></i><b>5.1.3</b> Simulated relative frequencies and probabilities</a></li>
<li class="chapter" data-level="5.1.4" data-path="lab5.html"><a href="lab5.html#calculating-binomial-probabilities-directly"><i class="fa fa-check"></i><b>5.1.4</b> Calculating binomial probabilities directly</a></li>
<li class="chapter" data-level="5.1.5" data-path="lab5.html"><a href="lab5.html#cumulative-probabilities-with-the-binomial"><i class="fa fa-check"></i><b>5.1.5</b> Cumulative probabilities with the binomial</a></li>
<li class="chapter" data-level="5.1.6" data-path="lab5.html"><a href="lab5.html#summary-of-rs-built-in-binomial-distribution"><i class="fa fa-check"></i><b>5.1.6</b> Summary of R’s built-in binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lab5.html"><a href="lab5.html#the-normal-distribution-in-r"><i class="fa fa-check"></i><b>5.2</b> The normal distribution in R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lab5.html"><a href="lab5.html#simulating-outcomes-from-a-normal-distribution"><i class="fa fa-check"></i><b>5.2.1</b> Simulating outcomes from a normal distribution</a></li>
<li class="chapter" data-level="5.2.2" data-path="lab5.html"><a href="lab5.html#the-mean-and-standard-deviation"><i class="fa fa-check"></i><b>5.2.2</b> The mean and standard deviation</a></li>
<li class="chapter" data-level="5.2.3" data-path="lab5.html"><a href="lab5.html#calculating-probabilities-with-the-normal-distribution"><i class="fa fa-check"></i><b>5.2.3</b> Calculating probabilities with the normal distribution</a></li>
<li class="chapter" data-level="5.2.4" data-path="lab5.html"><a href="lab5.html#finding-quantiles-with-the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> Finding “quantiles” with the normal distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="lab5.html"><a href="lab5.html#summary-of-rs-built-in-normal-distribution"><i class="fa fa-check"></i><b>5.2.5</b> Summary of R’s built-in normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lab5.html"><a href="lab5.html#wrap-up-4"><i class="fa fa-check"></i><b>5.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab6.html"><a href="lab6.html"><i class="fa fa-check"></i><b>6</b> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lab6.html"><a href="lab6.html#before-we-begin"><i class="fa fa-check"></i><b>6.1</b> Before we begin…</a></li>
<li class="chapter" data-level="6.2" data-path="lab6.html"><a href="lab6.html#heights"><i class="fa fa-check"></i><b>6.2</b> Heights</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lab6.html"><a href="lab6.html#a-simulated-population"><i class="fa fa-check"></i><b>6.2.1</b> A simulated population</a></li>
<li class="chapter" data-level="6.2.2" data-path="lab6.html"><a href="lab6.html#a-sample-from-our-simulated-population"><i class="fa fa-check"></i><b>6.2.2</b> A sample from our simulated population</a></li>
<li class="chapter" data-level="6.2.3" data-path="lab6.html"><a href="lab6.html#many-samples-from-our-simulated-population"><i class="fa fa-check"></i><b>6.2.3</b> Many samples from our simulated population</a></li>
<li class="chapter" data-level="6.2.4" data-path="lab6.html"><a href="lab6.html#many-larger-samples"><i class="fa fa-check"></i><b>6.2.4</b> Many larger samples</a></li>
<li class="chapter" data-level="6.2.5" data-path="lab6.html"><a href="lab6.html#the-probability-of-being-wrong"><i class="fa fa-check"></i><b>6.2.5</b> The probability of being wrong</a></li>
<li class="chapter" data-level="6.2.6" data-path="lab6.html"><a href="lab6.html#biased-samples"><i class="fa fa-check"></i><b>6.2.6</b> Biased samples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lab6.html"><a href="lab6.html#the-wisdom-of-the-crowd"><i class="fa fa-check"></i><b>6.3</b> The Wisdom of the Crowd</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="lab6.html"><a href="lab6.html#grab-the-data"><i class="fa fa-check"></i><b>6.3.1</b> Grab the data</a></li>
<li class="chapter" data-level="6.3.2" data-path="lab6.html"><a href="lab6.html#make-a-histogram"><i class="fa fa-check"></i><b>6.3.2</b> Make a histogram</a></li>
<li class="chapter" data-level="6.3.3" data-path="lab6.html"><a href="lab6.html#what-is-the-right-answer"><i class="fa fa-check"></i><b>6.3.3</b> What is the right answer?</a></li>
<li class="chapter" data-level="6.3.4" data-path="lab6.html"><a href="lab6.html#what-about-the-average"><i class="fa fa-check"></i><b>6.3.4</b> What about the average?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lab6.html"><a href="lab6.html#wrap-up-5"><i class="fa fa-check"></i><b>6.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Labs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab5" class="section level1" number="5">
<h1><span class="header-section-number">Lab 5</span> Models: The Binomial and the Normal</h1>
<p><img src="img/allison_kristen.png" width="100%" /></p>
<p>One of the ways we use statistics to learn about the world beyond our data is by <em>testing hypotheses</em>. A statistical hypothesis takes the form of a <strong>model</strong>. The model allows us to figure out the probability of observing particular types of outcomes. We can then take the types of outcomes we actually observed in our data and see whether they have high or low probability according to our model. If they have a high probability, our hypothesis might be reasonable. But if they have a low probability, there might be something wrong about our hypothesis.</p>
<p>In this session, we will explore two types of model that we have been discussing in class, the <strong>binomial distribution</strong> and the <strong>normal distribution</strong>. Similar to our last session, we will see how we can <em>simulate</em> data according to these models and show that, as we simulate more data (“in the long run…”), the relative frequency of different outcomes converges on the probabilities we get from the model.</p>
<p>As we’ve seen, we can use these distributions to model different scenarios by adjusting their <strong>parameters</strong>. These are the numbers that we feed into the distribution to get probabilities.</p>
<p>For the binomial distribution, its parameters are</p>
<ul>
<li>the probability of an outcome, which we called <span class="math inline">\(\theta\)</span> in math language, but which we will call <code>prob</code> in R; and</li>
<li>the number of repetitions, which we labeled <span class="math inline">\(N\)</span> in math language, but which we will call <code>size</code> in R.</li>
</ul>
<p>For the normal distribution, its parameters are</p>
<ul>
<li>the mean, which we called <span class="math inline">\(\mu\)</span> in math language, but which we will call <code>mean</code> in R; and</li>
<li>the standard deviation, which we called <span class="math inline">\(\sigma\)</span> in math language, but which we will call <code>sd</code> in R.</li>
</ul>
<p>Before we begin, let’s make sure we have the <code>tidyverse</code> package loaded from our library</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="lab5.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.5     ✓ dplyr   1.0.3
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="the-binomial-distribution-in-r" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> The binomial distribution in R</h2>
<p>Last time, we used R to <em>simulate</em> repeated outcomes from various kinds of events. Some of these, like flipping a coin or Kobe making a shot, had two possible outcomes. As a result, we can think of the number of times a particular outcome occurred as coming from a binomial distribution.</p>
<div id="translating-from-sample-to-rbinom" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Translating from <code>sample</code> to <code>rbinom</code></h3>
<p>Let’s see how we can do some of the stuff we did last time using the binomial distribution instead of directly simulating the outcome of each event.</p>
<p>This is the code we used last time to simulate 1000 flips from a coin that had a probability of 0.6 of coming up heads:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="lab5.html#cb157-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-2"><a href="lab5.html#cb157-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>))</span>
<span id="cb157-3"><a href="lab5.html#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="lab5.html#cb157-4" aria-hidden="true" tabindex="-1"></a>coin_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb157-5"><a href="lab5.html#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="lab5.html#cb157-6" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb157-7"><a href="lab5.html#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb157-8"><a href="lab5.html#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb157-9"><a href="lab5.html#cb157-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    619 0.619
## 2 Tails    381 0.381</code></pre>
<p>We can use the number of flips (1000) and the probability of heads (0.6) as the <em>parameters</em> of the binomial distribution. R has several important distributions “built in,” including the binomial and normal. R provides functions that allow us to directly sample from those distributions without having to use the <code>sample</code> function explicitly.</p>
<p>This is how we can simulate the number of heads out of 1000 flips, where the probability of “heads” is 0.6, using R’s built-in binomial distribution:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="lab5.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 611</code></pre>
<p>It is definitely more concise than our old code!<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a> Notice that we had to add a thing <code>n = 1</code>, what’s up with that? Let’s try changing it to see what it does and maybe we’ll understand what <code>n</code> means here:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="lab5.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 575 592</code></pre>
<p>Okay, so <code>n</code> is actually the <code>n</code>umber of <em>sequences of events</em> to simulate. In other words, we have two “numbers of things” here: <code>size</code> is the number of repeated events in a single sequence; <code>n</code> is the number of sequences of events. Why is it important to distinguish between these two numbers? Let’s try an example to see.</p>
</div>
<div id="outcomes-from-different-sequences-of-events" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Outcomes from different sequences of events</h3>
<p>The Mets and the Yankees are well known rival baseball teams from New York City. On a semi-regular basis, these two teams play so-called “subway series,” which are sequences of six games played against each other. Imagine that the probability that the Yankees win any single game against the Mets is 0.57. There have been 8 “subway series” played so far as part of the regular season.</p>
<p>So in this scenario, the number of repeated event in a single sequence is 6, corresponding to the 6 games played in each subway series. The number of sequences is 8, corresponding to the 8 subway series that have been played. And the probability of a Yankees win in any single game is 0.57. We can use this to simulate the number of games won by the Yankees in each of the 8 subway series:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="lab5.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 3 3 2 4 3 5 2 3</code></pre>
<p>Each number that R gave us is a number of games won by the Yankees in a sequence of 6 games against the Mets. So the first number is the number of Yankees wins in the first subway series, the second number is the number of Yankees wins in the second subway series, and so on.</p>
<p>Of course, if we run the simulation again, we will probably get a different set of outcomes for each subway series:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="lab5.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 4 6 4 4 2 1 3 5</code></pre>
</div>
<div id="simulated-relative-frequencies-and-probabilities" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Simulated relative frequencies and probabilities</h3>
<p>Now let’s imagine playing a large number of subway series over the next several decades or centuries, say, 1000 of them. Like last time with 1000 coin flips, this is too many to be able to see all at once. And because this is a simulation, we can’t just run the same line of code again and expect it to give us the same result. So let’s get R to remember the outcomes of 1000 subway series.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="lab5.html#cb167-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<p>Now let’s do the same trick we did last time so we can get R to treat our simulated results as data. We turn our simulation into a “tibble”:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="lab5.html#cb168-1" aria-hidden="true" tabindex="-1"></a>subway_series <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span></code></pre></div>
<p>Finally, let’s modify our code for making a frequency/probability table above to take a look at the distribution of outcomes for the 1000 subway series we simulated<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="lab5.html#cb169-1" aria-hidden="true" tabindex="-1"></a>subway_series <span class="sc">%&gt;%</span></span>
<span id="cb169-2"><a href="lab5.html#cb169-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="lab5.html#cb169-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="lab5.html#cb169-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##   result     n     p
## *  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1      0     7 0.007
## 2      1    42 0.042
## 3      2   176 0.176
## 4      3   288 0.288
## 5      4   290 0.290
## 6      5   164 0.164
## 7      6    33 0.033</code></pre>
<p>Sometimes the outcome is a tie (3 games out of 6), sometimes the Yankees win the majority of games, and sometimes the Mets win the majority (when the Yankees win fewer than 3 games). The important thing to note is that <em>these are probabilities of a number of wins out of a sequence of games, not the probability of winning any single game</em>. In other words, the <strong>sample space</strong> is not just win/lose, it is the <em>number</em> of wins out of 6 games<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>.</p>
</div>
<div id="calculating-binomial-probabilities-directly" class="section level3" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Calculating binomial probabilities directly</h3>
<p>When we were simulating outcomes last time, we directly specified the probability of each outcome in the sample space. Now, what we specify are <strong>parameters</strong>, namely, the probability of an outcome in a single event and the number of repetitions of the event. So if we want to know the probability of a specific outcome, like 3 wins out of 6, we need to use the binomial distribution to figure it out.</p>
<p>R lets us do this for single outcomes with the <code>dbinom</code> function. For example, let’s find the probability of a tie<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="lab5.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.2944828</code></pre>
<p>As we would expect, this is close to the relative frequency of a tie when we simulated 1000 subway series. The meaning of probability is the same—it is the <em>long-run relative frequency</em>—it’s just that we are asking about the probability of a different type of outcome.</p>
<p>We can also ask what is the probability that the Yankees win all six games<a href="#fn52" class="footnote-ref" id="fnref52"><sup>52</sup></a></p>
<pre><code>## [1] 0.03429645</code></pre>
</div>
<div id="cumulative-probabilities-with-the-binomial" class="section level3" number="5.1.5">
<h3><span class="header-section-number">5.1.5</span> Cumulative probabilities with the binomial</h3>
<p>Another part of R’s built-in binomial distribution is the ability to calculate <strong>cumulative probabilities</strong>. For example, we might be interested in the probability that the Mets win a majority of the games in a subway series. This corresponds to the Yankees winning either 0, 1, or 2 games.</p>
<p>One way to calculate this would be to add up each of those individual probabilities:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="lab5.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.2232135</code></pre>
<p>But a more efficient way to do this is to use <strong>cumulative probabilities</strong>. As we’ve seen, a cumulative probability is just the sum of the probabilities for all outcomes up to and including a given value. We can get the same result that we got above using this more compact bit of code:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="lab5.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.2232135</code></pre>
<p>This makes it easier to find the probabilities for <em>ranges</em> of different outcomes. For example, we could get the probability that the Yankees either lose the series <em>or</em> tie it up (so 0, 1, 2, or 3 wins out of 6)<a href="#fn53" class="footnote-ref" id="fnref53"><sup>53</sup></a>:</p>
<pre><code>## [1] 0.5176963</code></pre>
<p>But what if the opposite happens? What if the Yankees neither lose <em>nor</em> tie? That means they must have won the majority of games in the series (i.e., 4, 5, or 6 games). We could figure out the probability that the Yankees win the majority of games by adding up those individual probabilities like so:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="lab5.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.4823037</code></pre>
<p>But using <em>cumulative</em> probability, we can reverse that question: What is the probability that the Yankees <em>don’t</em> win 3 or fewer games? In other words, how much probability is “left over” after asking whether the Yankees win 3 or fewer games? Since the probability across all outcomes has to add up to one, we get</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="lab5.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">prob =</span> <span class="fl">0.57</span>, <span class="at">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.4823037</code></pre>
<p>Using the same logic, we can ask what is the probability that the Yankees win 5 or more games<a href="#fn54" class="footnote-ref" id="fnref54"><sup>54</sup></a>:</p>
<pre><code>## [1] 0.189533</code></pre>
</div>
<div id="summary-of-rs-built-in-binomial-distribution" class="section level3" number="5.1.6">
<h3><span class="header-section-number">5.1.6</span> Summary of R’s built-in binomial distribution</h3>
<p>R makes it easy to use the binomial distribution by giving us several useful functions. We can summarize these below:</p>
<table>
<colgroup>
<col width="42%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rbinom(n = ?, prob = ?, size = ?)</code></td>
<td>Simulate <code>n</code> sequences of <code>size</code> events, where the probability of an outcome of interest is <code>prob</code>. For each of the <code>n</code> sequences, return the number of times out of <code>size</code> that the outcome of interest occurred.</td>
</tr>
<tr class="even">
<td><code>dbinom(x = ?, prob = ?, size = ?)</code></td>
<td>What is the probability that an outcome of interest occurs exactly <code>x</code> times out of a sequence of <code>size</code> repeated events, if the probability that the outcome occurs in a <em>single</em> event is <code>prob</code>?</td>
</tr>
<tr class="odd">
<td><code>pbinom(q = ?, prob = ?, size = ?)</code></td>
<td>What is the probability that an outcome of interest occurs <code>q</code> <em>or fewer</em> times out of a sequence of <code>size</code> repeated events, if the probability that the outcome occurs in a <em>single</em> event is <code>prob</code>?</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="the-normal-distribution-in-r" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The normal distribution in R</h2>
<p>Just like the binomial distribution lets us model situations where we have a sequence of repeated events, each of which has two possible outcomes, the <strong>normal distribution</strong> lets us model situations where we have a continuous outcome that has a certain mean and standard deviation.</p>
<div id="simulating-outcomes-from-a-normal-distribution" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Simulating outcomes from a normal distribution</h3>
<p>Just like we can simulate values from a binomial distribution using <code>rbinom</code>, we can simulate values from a normal distribution using <code>rnorm</code>.</p>
<p>Adult women in the US have an average height of about 64 inches, with a standard deviation of 6 inches. These are the two <strong>parameters</strong> that we need for our normal distribution. Using these parameters, let’s imagine that we pick a random adult American women. How tall is she?<a href="#fn55" class="footnote-ref" id="fnref55"><sup>55</sup></a></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="lab5.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 66.93144</code></pre>
<p>Now let’s pick 10 adult women at random and see how tall they are<a href="#fn56" class="footnote-ref" id="fnref56"><sup>56</sup></a></p>
<pre><code>##  [1] 67.96766 61.54070 51.18494 69.00817 71.16475 66.77840 65.02384 67.07920
##  [9] 55.20665 60.07779</code></pre>
<p>Each of those numbers represents the height of a simulated adult American woman. We can also get the heights for simulated adult American men by remembering that their <em>mean</em> height is 69 inches with a <em>standard deviation</em> again of 6 inches<a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a></p>
<pre><code>##  [1] 68.18499 64.88364 67.25053 75.90296 71.39535 67.54149 63.06030 69.86670
##  [9] 70.03507 80.95467</code></pre>
<p>Eyeballing it, it does seem like those simulated men tend to be taller than our simulated women.<a href="#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a></p>
<p>Now let’s try simulating the heights of 10,000 women using our normal distribution model. To do this, let’s first try doing what we did above to simulate outcomes of subway series, just swapping out the very first line of code:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="lab5.html#cb188-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span>
<span id="cb188-2"><a href="lab5.html#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="lab5.html#cb188-3" aria-hidden="true" tabindex="-1"></a>height_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb188-4"><a href="lab5.html#cb188-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-5"><a href="lab5.html#cb188-5" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="lab5.html#cb188-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb188-7"><a href="lab5.html#cb188-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb188-8"><a href="lab5.html#cb188-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 10,000 x 3
##    result     n      p
##  *  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
##  1   41.1     1 0.0001
##  2   43.1     1 0.0001
##  3   43.2     1 0.0001
##  4   43.5     1 0.0001
##  5   44.0     1 0.0001
##  6   44.4     1 0.0001
##  7   44.5     1 0.0001
##  8   44.9     1 0.0001
##  9   44.9     1 0.0001
## 10   45.3     1 0.0001
## # … with 9,990 more rows</code></pre>
<p>Well that didn’t work very well at all! This illustrates the challenge of working with a <em>continuous</em> variable as opposed to a discrete one like number of games won. Every observed value is unique, so it occurs with a frequency of one. Luckily, we’ve already seen that <strong>histograms</strong> make it easy to visualize the relative frequencies of outcomes on continuous variables because they group together the outcomes into <em>bins</em>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="lab5.html#cb190-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="lab5.html#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>result)) <span class="sc">+</span></span>
<span id="cb190-3"><a href="lab5.html#cb190-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-binomial_normal_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Now we are beginning to see that classic bell curve shape: There are more values around the mean (64 inches) than farther from the mean, but it is still possible to get a few folks who are particularly tall (like Allison Janney) or short (like Kristen Chenoweth).</p>
</div>
<div id="the-mean-and-standard-deviation" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> The mean and standard deviation</h3>
<p>The parameters of the normal distribution are its mean and standard deviation, which determine its center and spread, respectively. These parameters are <em>also</em> what you will tend to get if you <em>summarize</em> the central tendency and variability of samples from a normal distribution. This is one of the awesome things about the normal distribution—its parameters tell you exactly what you should expect your data to look like.</p>
<p>Let’s see that by summarizing the mean and standard deviation of the heights of our 1000 simulated women:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="lab5.html#cb191-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="lab5.html#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">M =</span> <span class="fu">mean</span>(result), <span class="at">S =</span> <span class="fu">sd</span>(result))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       M     S
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  64.0  6.04</code></pre>
<p>They may not be <em>exactly</em> 64 and 6, but they are pretty close. In fact, let’s simulate another group of 10,000 women and summarize their heights.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="lab5.html#cb193-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span>
<span id="cb193-2"><a href="lab5.html#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="lab5.html#cb193-3" aria-hidden="true" tabindex="-1"></a>height_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb193-4"><a href="lab5.html#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="lab5.html#cb193-5" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb193-6"><a href="lab5.html#cb193-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">M =</span> <span class="fu">mean</span>(result), <span class="at">S =</span> <span class="fu">sd</span>(result))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       M     S
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  64.0  5.95</code></pre>
<p>Again, pretty close to the parameters we used!</p>
</div>
<div id="calculating-probabilities-with-the-normal-distribution" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Calculating probabilities with the normal distribution</h3>
<p>Remember that we used the <code>dbinom</code> function in R to find the probability of a specific outcome in a sequence of repeated binary events. There is an analogous function in R for the normal distribution called <code>dnorm</code>, but we won’t really ever use it. The reason is the same as why our original attempt to make a frequency table didn’t really work: With a continuous variable, the probability of observing any single value is basically zero.</p>
<p>Instead, we will follow the same line of reasoning that makes the histogram useful: For continuous variables, we aren’t interested in whether they take some specific value, but whether they fall into a particular “bin.” We don’t care if someone is exactly 71.05976… inches tall. We care whether they are, for example, between 71 and 72 inches tall. Or whether they are more than 64 inches tall. Or whether they are less than 80 inches tall.</p>
<p>The probabilities of all of those kinds of things can be found by doing some clever tricks with <strong>cumulative probability</strong>. Remember that this is the probability of observing a value that is less than or equal to some given cutoff. This was how we figured out the probabilities of different numbers of wins. Now we can do the same for different ranges of height.</p>
<p>Just like we had <code>pbinom</code> for cumulative probability, we also have <code>pnorm</code>. This code gives us the probability that a woman is less than or equal to 60 inches tall:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="lab5.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.2524925</code></pre>
<p>This is awesome! But it doesn’t quite make clear where this probability is coming from. Let’s look back at our histogram of simulated heights, but now make it so that bars corresponding to heights less than 60 are <code>fill</code>ed with a different color:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="lab5.html#cb197-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="lab5.html#cb197-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> (result <span class="sc">&lt;=</span> <span class="dv">60</span>))) <span class="sc">+</span></span>
<span id="cb197-3"><a href="lab5.html#cb197-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-binomial_normal_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>What <code>pnorm</code> is doing is telling us is the <em>area</em> of the histogram that is colored teal (for being less than or equal to 60). But this immediately suggests that we can use <code>pnorm</code> to find the area colored red (for being more than 60). We know that probabilities have to add up to 1, so the area across all the bars of the histogram equals 1. So if we know the area for one color, we can figure out the area for the other because we know that, together, they have to add up to 1. That gives us all we need to figure out the probability that a woman is <em>more</em> than 60 inches tall<a href="#fn59" class="footnote-ref" id="fnref59"><sup>59</sup></a>:</p>
<pre><code>## [1] 0.7475075</code></pre>
<p>Cumulative probability also lets us figure out the probability that a woman is, say, between 60 and 70 inches tall. The insight is that the probability that a woman is less than or equal to 70 inches “contains” the probability that a woman is less than or equal to 60 inches. So to find the probability we need to subtract out that overlap.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="lab5.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">70</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.5888522</code></pre>
<p>Let’s make a colored histogram again to get a better sense of what is going on here</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="lab5.html#cb201-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb201-2"><a href="lab5.html#cb201-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> (result <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> result <span class="sc">&lt;=</span> <span class="dv">70</span>))) <span class="sc">+</span></span>
<span id="cb201-3"><a href="lab5.html#cb201-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-binomial_normal_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Again, we are finding the area that is in the teal part of the histogram, corresponding to women between 60 and 70 inches tall.</p>
<p>Using that same logic, we can figure out the probability that a woman is between 71 and 72 inches tall<a href="#fn60" class="footnote-ref" id="fnref60"><sup>60</sup></a>:</p>
<pre><code>## [1] 0.03046128</code></pre>
</div>
<div id="finding-quantiles-with-the-normal-distribution" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Finding “quantiles” with the normal distribution</h3>
<p>There’s one final trick we will explore about the normal distribution. Above, we saw how we could find the probability of observing a value that was less than or equal to a given cutoff. The cutoff value is typically called a <strong>“quantile”</strong>, hence why <code>pbinom</code> and <code>pnorm</code> label it <code>q</code>. But we can also turn that question around: What is the quantile for which there is a specific probability of being less than that value? In other words, if we know the cumulative probability is <span class="math inline">\(p\)</span>, what must <span class="math inline">\(q\)</span> be?</p>
<p>We can answer that kind of question in R using the <code>qnorm</code> function for normal distributions (there is also a <code>qbinom</code> function for binomial distributions, but we won’t typically use it). What is the height for which a woman has a 0.6 probability of being <em>shorter</em> than that height?</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="lab5.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 65.52008</code></pre>
<p>Again, let’s try making ourselves a colored histogram to understand what this answer means.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="lab5.html#cb205-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb205-2"><a href="lab5.html#cb205-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> (result <span class="sc">&lt;=</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.6</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd =</span> <span class="dv">6</span>)))) <span class="sc">+</span></span>
<span id="cb205-3"><a href="lab5.html#cb205-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-binomial_normal_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Notice that for the <code>fill</code> aesthetic, we’ve just swapped out a number we picked ahead of time (like 60) for the <code>qnorm</code> line from above. It looks like a bit more than half of the histogram is colored teal. This corresponds to the 0.6 probability associated with the quantile we found.</p>
<p>Things will look quite a bit different if we ask what is the height for which a woman has a probability 0.99 of being <em>shorter</em> than that height?<a href="#fn61" class="footnote-ref" id="fnref61"><sup>61</sup></a></p>
<pre><code>## [1] 77.95809</code></pre>
<p>Now if we make a colored histogram like we just did, it should look almost all teal, since there is such a large probability that a woman is shorter than the quantile we just found.</p>
<p><img src="05-binomial_normal_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Recall that male heights have a mean of 69 inches. Do you think the quantile corresponding to a probability of 0.99 will be higher for men than women? Try it and see!<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a></p>
<pre><code>## [1] 82.95809</code></pre>
</div>
<div id="summary-of-rs-built-in-normal-distribution" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Summary of R’s built-in normal distribution</h3>
<table>
<colgroup>
<col width="42%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rnorm(n = ?, mean = ?, sd = ?)</code></td>
<td>Simulate <code>n</code> samples from a normal distribution with a given <code>mean</code> and standard deviation (<code>sd</code>).</td>
</tr>
<tr class="even">
<td><code>pnorm(q = ?, mean = ?, sd = ?)</code></td>
<td>What is the probability of observing a value less than or equal to <code>q</code> if values come from a normal distribution with the given <code>mean</code> and standard deviation (<code>sd</code>)?</td>
</tr>
<tr class="odd">
<td><code>qnorm(p = ?, mean = ?, sd = ?)</code></td>
<td>What is the value (“quantile”) for which there is a probability <code>p</code> of observing a value that is less than or equal to that value, if the value comes from a normal distribution with the given <code>mean</code> and standard deviation (<code>sd</code>)?</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="wrap-up-4" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Wrap-up</h2>
<p>In this session we explored the functions built into R that allow us to use the binomial and normal distributions as “models” for various situations. We saw how we could describe a situation in terms of <strong>parameters</strong> and use R to simulate different outcomes, figure out probabilities of different types of outcomes, and for the normal distribution, how to find “quantiles” when we know the corresponding cumulative probability.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="48">
<li id="fn48"><p>Notice that the <code>rbinom</code> function also requires us to give it things named <code>prob</code> and <code>size</code>, like our old simulation code. How is the way we use <code>prob</code> and <code>size</code> similar between the two pieces of code? How are they different?<a href="lab5.html#fnref48" class="footnote-back">↩︎</a></p></li>
<li id="fn49"><p>Describe what the 3 columns in the table (“result,” “n,” and “p”) each represent.<a href="lab5.html#fnref49" class="footnote-back">↩︎</a></p></li>
<li id="fn50"><p>What parameter would you change in order to get the binomial distribution to describe probabilities of winning or losing a single game?<a href="lab5.html#fnref50" class="footnote-back">↩︎</a></p></li>
<li id="fn51"><p>Compare the code for the <code>dbinom</code> and <code>rbinom</code> functions. What is similar and what is different?<a href="lab5.html#fnref51" class="footnote-back">↩︎</a></p></li>
<li id="fn52"><p>What code would give us this probability?<a href="lab5.html#fnref52" class="footnote-back">↩︎</a></p></li>
<li id="fn53"><p>How would we change the <code>pbinom</code> code to get this answer?<a href="lab5.html#fnref53" class="footnote-back">↩︎</a></p></li>
<li id="fn54"><p>What code would tell us the probability of the Yankees winning 5 or more games in a series?<a href="lab5.html#fnref54" class="footnote-back">↩︎</a></p></li>
<li id="fn55"><p>Compare the code for <code>rnorm</code> to the code for <code>rbinom</code>. What is similar and what is different?<a href="lab5.html#fnref55" class="footnote-back">↩︎</a></p></li>
<li id="fn56"><p>What code would use the normal distribution to simulate the heights of 10 adult women?<a href="lab5.html#fnref56" class="footnote-back">↩︎</a></p></li>
<li id="fn57"><p>What parameter of the normal distribution do we need to change in order to simulate adult male heights, rather than adult female heights?<a href="lab5.html#fnref57" class="footnote-back">↩︎</a></p></li>
<li id="fn58"><p>When you simulated male and female heights, were there any women who were taller than at least one of the men? Why do you think this might be, even though men are on average taller than women?<a href="lab5.html#fnref58" class="footnote-back">↩︎</a></p></li>
<li id="fn59"><p>What code did you use to find the probability that a woman is more than 60 inches tall?<a href="lab5.html#fnref59" class="footnote-back">↩︎</a></p></li>
<li id="fn60"><p>What code did you use to find the probability that a woman is between 71 and 72 inches tall?<a href="lab5.html#fnref60" class="footnote-back">↩︎</a></p></li>
<li id="fn61"><p>What code would answer this question?<a href="lab5.html#fnref61" class="footnote-back">↩︎</a></p></li>
<li id="fn62"><p>What code did you use to find the 0.99 quantile for male heights? <em>Hint: which parameter of the normal distribution is different for heights of men and women?</em><a href="lab5.html#fnref62" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["APSY210 Labs.pdf", "APSY210 Labs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
