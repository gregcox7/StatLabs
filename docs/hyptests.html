<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>B Hypothesis Tests | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Central tendency and variability</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Scatterplots and correlation</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Probability and simulation</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Models: The Binomial and the Normal</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></li>
<li><a class="" href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></li>
<li><a class="" href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="coderef.html"><span class="header-section-number">A</span> Distributions</a></li>
<li><a class="active" href="hyptests.html"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="hyptests" class="section level1" number="14">
<h1>
<span class="header-section-number">B</span> Hypothesis Tests<a class="anchor" aria-label="anchor" href="#hyptests"><i class="fas fa-link"></i></a>
</h1>
<div id="t-tests" class="section level2" number="14.1">
<h2>
<span class="header-section-number">B.1</span> <span class="math inline">\(t\)</span> tests<a class="anchor" aria-label="anchor" href="#t-tests"><i class="fas fa-link"></i></a>
</h2>
<div id="doing-them-step-by-step" class="section level3" number="14.1.1">
<h3>
<span class="header-section-number">B.1.1</span> Doing them step-by-step<a class="anchor" aria-label="anchor" href="#doing-them-step-by-step"><i class="fas fa-link"></i></a>
</h3>
<div id="one-sample-t-test-1" class="section level4" number="14.1.1.1">
<h4>
<span class="header-section-number">B.1.1.1</span> One-sample <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#one-sample-t-test-1"><i class="fas fa-link"></i></a>
</h4>
<p>For the following example, I’ve labeled the collection of observed data as <code>X</code>. If you put your own collection of values under the same label, the following code will give you what you need to do a <span class="math inline">\(t\)</span> test on your own data.</p>
<div class="sourceCode" id="cb602"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.58</span>, <span class="fl">1.02</span>, <span class="fl">1.25</span>, <span class="op">-</span><span class="fl">0.02</span>, <span class="fl">1.15</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>I will assume in this example that the population mean if the null hypothesis is true is <span class="math inline">\(\mu = 0\)</span>, but you can replace this with your own <code>null_mean</code> as you need.</p>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Decide on an <strong>alpha level</strong>.</p></li>
<li><p>Find the <span class="math inline">\(t\)</span> value (<span class="math inline">\(t = \frac{\bar{X} - \mu}{\hat{\sigma} / \sqrt{N}}\)</span>):</p></li>
</ol>
<div class="sourceCode" id="cb604"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">-</span> <span class="va">null_mean</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Find the <span class="math inline">\(p\)</span> value.</li>
</ol>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Direction of test</th>
<th>Is <span class="math inline">\(t\)</span> value positive or negative?</th>
<th>Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-tailed (less)</td>
<td>NA</td>
<td><code><a href="https://rdrr.io/r/stats/TDist.html">pt(q = t, df = length(X) - 1)</a></code></td>
</tr>
<tr class="even">
<td>One-tailed (greater)</td>
<td>NA</td>
<td><code>1 - pt(q = t, df = length(X) - 1)</code></td>
</tr>
<tr class="odd">
<td>Two-tailed</td>
<td>Positive</td>
<td><code>2 * (1 - pt(q = t, df = length(X) - 1))</code></td>
</tr>
<tr class="even">
<td>Two-tailed</td>
<td>Negative</td>
<td><code>2 * pt(q = t, df = length(X) - 1)</code></td>
</tr>
</tbody>
</table></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
<div id="paired-samples-t-test" class="section level4" number="14.1.1.2">
<h4>
<span class="header-section-number">B.1.1.2</span> Paired samples <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#paired-samples-t-test"><i class="fas fa-link"></i></a>
</h4>
<p>For the following example, I’ve labeled the pairs of observed values as <code>X_1</code> and <code>X_2</code>. If you put your own collection of values under the same labels, the following code will give you what you need to do a <span class="math inline">\(t\)</span> test on your own data.</p>
<div class="sourceCode" id="cb605"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.58</span>, <span class="fl">1.02</span>, <span class="fl">1.25</span>, <span class="op">-</span><span class="fl">0.02</span>, <span class="fl">1.15</span><span class="op">)</span>
<span class="va">X_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.05</span>, <span class="op">-</span><span class="fl">0.92</span>, <span class="op">-</span><span class="fl">1.18</span>, <span class="op">-</span><span class="fl">0.16</span>, <span class="fl">0.73</span><span class="op">)</span></code></pre></div>
<p>We then need to get the <em>difference</em> between each pair of values, like so:</p>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">X_1</span> <span class="op">-</span> <span class="va">X_2</span></code></pre></div>
<p>Remember to keep track of the order in which you did the subtraction!</p>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>I will assume in this example that the population mean difference if the null hypothesis is true is <span class="math inline">\(\mu_D = 0\)</span>, since this is the most common use for a paired-sample <span class="math inline">\(t\)</span> test, but you can replace this with your own <code>null_mean</code> as you need.</p>
<div class="sourceCode" id="cb607"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Decide on an <strong>alpha level</strong>.</p></li>
<li><p>Find the <span class="math inline">\(t\)</span> value (<span class="math inline">\(t = \frac{\bar{D} - \mu_D}{\hat{\sigma}_D / \sqrt{N}}\)</span>).</p></li>
</ol>
<div class="sourceCode" id="cb608"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">-</span> <span class="va">null_mean</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Find the <span class="math inline">\(p\)</span> value.</li>
</ol>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Direction of test</th>
<th>Is <span class="math inline">\(t\)</span> value positive or negative?</th>
<th>Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-tailed (less)</td>
<td>NA</td>
<td><code><a href="https://rdrr.io/r/stats/TDist.html">pt(q = t, df = length(D) - 1)</a></code></td>
</tr>
<tr class="even">
<td>One-tailed (greater)</td>
<td>NA</td>
<td><code>1 - pt(q = t, df = length(D) - 1)</code></td>
</tr>
<tr class="odd">
<td>Two-tailed</td>
<td>Positive</td>
<td><code>2 * (1 - pt(q = t, df = length(D) - 1))</code></td>
</tr>
<tr class="even">
<td>Two-tailed</td>
<td>Negative</td>
<td><code>2 * pt(q = t, df = length(D) - 1)</code></td>
</tr>
</tbody>
</table></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
<div id="independent-samples-t-test-1" class="section level4" number="14.1.1.3">
<h4>
<span class="header-section-number">B.1.1.3</span> Independent samples <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#independent-samples-t-test-1"><i class="fas fa-link"></i></a>
</h4>
<p>For the following example, I’ve labeled the pairs of observed values as <code>X_1</code> and <code>X_2</code>. Note that they are different from above and that they are not the same size. If you put your own collection of values under the same labels, the following code will give you what you need to do a <span class="math inline">\(t\)</span> test on your own data.</p>
<div class="sourceCode" id="cb609"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.87</span>, <span class="op">-</span><span class="fl">0.13</span>, <span class="fl">0.13</span>, <span class="op">-</span><span class="fl">0.14</span>, <span class="op">-</span><span class="fl">0.45</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">X_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="op">-</span><span class="fl">0.99</span>, <span class="fl">0.47</span>, <span class="fl">0.86</span>, <span class="fl">0.06</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>I will assume in this example that the difference in population means if the null hypothesis is true is <span class="math inline">\(\mu_1 - \mu_2 = 0\)</span>, since this is the most common use for a independent samples <span class="math inline">\(t\)</span> test, but you can replace this with your own <code>null_mean</code> as you need.</p>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Decide on an <strong>alpha level</strong>.</p></li>
<li><p>Find the <span class="math inline">\(t\)</span> value.</p></li>
</ol>
<p>First, we need to find the pooled sample standard deviation (<span class="math inline">\(\hat{\sigma}_P = \sqrt{\frac{df_1 \hat{\sigma}_1^2 + df_2 \hat{\sigma}_2^2}{df_1 + df_2}}\)</span>)</p>
<div class="sourceCode" id="cb611"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="va">df_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>

<span class="va">sd_pooled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">df_1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">df_2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">df_1</span> <span class="op">+</span> <span class="va">df_2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now we can get the <span class="math inline">\(t\)</span> value (<span class="math inline">\(t = \frac{\bar{X}_1 - \bar{X}_2 - (\mu_1 - \mu_2)}{\hat{\sigma}_P \sqrt{\frac{1}{N_1} + \frac{1}{N_2}}}\)</span>):</p>
<div class="sourceCode" id="cb612"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span> <span class="op">-</span> <span class="va">null_mean</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sd_pooled</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Find the <span class="math inline">\(p\)</span> value.</li>
</ol>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Direction of test</th>
<th>Is <span class="math inline">\(t\)</span> value positive or negative?</th>
<th>Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-tailed (less)</td>
<td>NA</td>
<td><code><a href="https://rdrr.io/r/stats/TDist.html">pt(q = t, df = df_1 + df_2)</a></code></td>
</tr>
<tr class="even">
<td>One-tailed (greater)</td>
<td>NA</td>
<td><code>1 - pt(q = t, df = df_1 + df_2)</code></td>
</tr>
<tr class="odd">
<td>Two-tailed</td>
<td>Positive</td>
<td><code>2 * (1 - pt(q = t, df = df_1 + df_2))</code></td>
</tr>
<tr class="even">
<td>Two-tailed</td>
<td>Negative</td>
<td><code>2 * pt(q = t, df = df_1 + df_2)</code></td>
</tr>
</tbody>
</table></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
</div>
<div id="doing-them-all-at-once" class="section level3" number="14.1.2">
<h3>
<span class="header-section-number">B.1.2</span> Doing them all at once<a class="anchor" aria-label="anchor" href="#doing-them-all-at-once"><i class="fas fa-link"></i></a>
</h3>
<p>If we’re going to do <span class="math inline">\(t\)</span> tests all at once, we need to make sure we have loaded the <code>tidyverse</code> and <code>infer</code> packages:</p>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></code></pre></div>
<div id="one-sample-t-test-2" class="section level4" number="14.1.2.1">
<h4>
<span class="header-section-number">B.1.2.1</span> One-sample <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#one-sample-t-test-2"><i class="fas fa-link"></i></a>
</h4>
<p>In this example, I’ll use some simple artificial data:</p>
<div class="sourceCode" id="cb618"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/one_sample_t_test_data.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 5 Columns: 2</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (2): ID, X</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb622"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##      ID     X
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1 -0.58
## 2     2  1.02
## 3     3  1.25
## 4     4 -0.02
## 5     5  1.15</code></pre>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>I will assume in this example that the population mean according to our null hypothesis is <span class="math inline">\(\mu = 0\)</span>, but you can change this as you need:</p>
<div class="sourceCode" id="cb624"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Decide on an <strong>alpha level</strong>.</li>
</ol>
<p>I will tell R to remember our choice of alpha level like so:</p>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_level</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(t\)</span> value.</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value.</p></li>
</ol>
<p>Both the previous two steps are accomplished in the same chunk of code:</p>
<div class="sourceCode" id="cb626"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/t_test.html">t_test</a></span><span class="op">(</span>
        response <span class="op">=</span> <span class="va">X</span>,
        alternative <span class="op">=</span> <span class="st">"two.sided"</span>,
        mu <span class="op">=</span> <span class="va">null_mean</span>,
        conf_level <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span>
    <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   statistic  t_df p_value alternative lower_ci upper_ci
##       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1      1.54     4   0.198 two.sided     -0.451     1.58</code></pre>
<p>To do this with your own data, make sure to tell R the name of your dataset (replace <code>my_data</code>) and the name of your response variable (replace <code>X</code>). And make sure R is remembering the correct values for <code>null_mean</code> and <code>alpha_level</code>, which we set in steps 1 and 2 above.</p>
<p>You will need to change what you put for <code>alternative</code> depending on your null and alternative hypotheses:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Direction of test</th>
<th>Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-tailed (less)</td>
<td><code>alternative = "less"</code></td>
</tr>
<tr class="even">
<td>One-tailed (greater)</td>
<td><code>alternative = "greater"</code></td>
</tr>
<tr class="odd">
<td>Two-tailed</td>
<td><code>alternative = "two.sided"</code></td>
</tr>
</tbody>
</table></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
<div id="paired-samples-t-test-1" class="section level4" number="14.1.2.2">
<h4>
<span class="header-section-number">B.1.2.2</span> Paired samples <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#paired-samples-t-test-1"><i class="fas fa-link"></i></a>
</h4>
<p>In this example, I’ll use some simple artificial data:</p>
<div class="sourceCode" id="cb628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/paired_sample_t_test_data.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 5 Columns: 3</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (3): ID, X_1, X_2</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##      ID   X_1   X_2
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 -0.58 -2.05
## 2     2  1.02 -0.92
## 3     3  1.25 -1.18
## 4     4 -0.02 -0.16
## 5     5  1.15  0.73</code></pre>
<p><strong>Preliminary step:</strong> If the data does not already have a variable for the difference scores, we need to create it using the <code>mutate</code> function and then tell R to update the original data.</p>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">my_data</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>D <span class="op">=</span> <span class="va">X_1</span> <span class="op">-</span> <span class="va">X_2</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>I will assume in this example that the population mean according to our null hypothesis is <span class="math inline">\(\mu_D = 0\)</span>, but you can change this as you need:</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Decide on an <strong>alpha level</strong>.</li>
</ol>
<p>I will tell R to remember our choice of alpha level like so:</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_level</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(t\)</span> value.</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value.</p></li>
</ol>
<p>Both the previous two steps are accomplished in the same chunk of code:</p>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/t_test.html">t_test</a></span><span class="op">(</span>
        response <span class="op">=</span> <span class="va">D</span>,
        alternative <span class="op">=</span> <span class="st">"two.sided"</span>,
        mu <span class="op">=</span> <span class="va">null_mean</span>,
        conf_level <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span>
    <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   statistic  t_df p_value alternative lower_ci upper_ci
##       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1      2.92     4  0.0431 two.sided     0.0645     2.50</code></pre>
<p>To do this with your own data, make sure to tell R the name of your dataset (replace <code>my_data</code>) and the name of your response variable (replace <code>D</code>). And make sure R is remembering the correct values for <code>null_mean</code> and <code>alpha_level</code>, which we set in steps 1 and 2 above.</p>
<p>You will need to change what you put for <code>alternative</code> depending on your null and alternative hypotheses:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Direction of test</th>
<th>Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-tailed (less)</td>
<td><code>alternative = "less"</code></td>
</tr>
<tr class="even">
<td>One-tailed (greater)</td>
<td><code>alternative = "greater"</code></td>
</tr>
<tr class="odd">
<td>Two-tailed</td>
<td><code>alternative = "two.sided"</code></td>
</tr>
</tbody>
</table></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
<div id="independent-samples-t-test-2" class="section level4" number="14.1.2.3">
<h4>
<span class="header-section-number">B.1.2.3</span> Independent samples <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#independent-samples-t-test-2"><i class="fas fa-link"></i></a>
</h4>
<p>In this example, I’ll use some simple artificial data:</p>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/indep_samples_t_test_data.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 11 Columns: 3</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (3): ID, Group, X</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span></code></pre></div>
<pre><code>## # A tibble: 11 × 3
##       ID Group     X
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1 -0.87
##  2     2     1 -0.13
##  3     3     1  0.13
##  4     4     1 -0.14
##  5     5     1 -0.45
##  6     6     1 -1   
##  7     7     2  0.06
##  8     8     2 -0.99
##  9     9     2  0.47
## 10    10     2  0.86
## 11    11     2  0.06</code></pre>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>I will assume in this example that the population mean according to our null hypothesis is <span class="math inline">\(\mu_1 - \mu_2 = 0\)</span>, but you can change this as you need:</p>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">null_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Decide on an <strong>alpha level</strong>.</li>
</ol>
<p>I will tell R to remember our choice of alpha level like so:</p>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_level</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(t\)</span> value.</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value.</p></li>
</ol>
<p>Both the previous two steps are accomplished in the same chunk of code:</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/t_test.html">t_test</a></span><span class="op">(</span>
        <span class="va">X</span> <span class="op">~</span> <span class="va">Group</span>,
        alternative <span class="op">=</span> <span class="st">"two.sided"</span>,
        mu <span class="op">=</span> <span class="va">null_mean</span>,
        var.equal <span class="op">=</span> <span class="cn">TRUE</span>,
        conf_level <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha_level</span>
    <span class="op">)</span></code></pre></div>
<pre><code>## Warning: The statistic is based on a difference or ratio; by default, for
## difference-based statistics, the explanatory variable is subtracted in the order
## "1" - "2", or divided in the order "1" / "2" for ratio-based statistics. To
## specify this order yourself, supply `order = c("1", "2")`.</code></pre>
<pre><code>## # A tibble: 1 × 6
##   statistic  t_df p_value alternative lower_ci upper_ci
##       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1     -1.46     9   0.179 two.sided      -1.28    0.277</code></pre>
<p>To do this with your own data, make sure to tell R the name of your dataset (replace <code>my_data</code>), the name of your response variable (replace <code>X</code>), and the name of your explanatory variable that designates which of the two samples each observation came from (replace <code>Group</code>). And make sure R is remembering the correct values for <code>null_mean</code> and <code>alpha_level</code>, which we set in steps 1 and 2 above.</p>
<p>In the above example, we assumed that the variances between the two groups were approximately equal; this is what the line <code>var.equal = TRUE</code> means. If we have reason to believe they are not equal, we can say <code>var.equal = FALSE</code>, but we won’t be using that option in this course.</p>
<p>You will need to change what you put for <code>alternative</code> depending on your null and alternative hypotheses:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Direction of test</th>
<th>Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-tailed (less)</td>
<td><code>alternative = "less"</code></td>
</tr>
<tr class="even">
<td>One-tailed (greater)</td>
<td><code>alternative = "greater"</code></td>
</tr>
<tr class="odd">
<td>Two-tailed</td>
<td><code>alternative = "two.sided"</code></td>
</tr>
</tbody>
</table></div>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
</div>
</div>
<div id="analysis-of-variance-anova" class="section level2" number="14.2">
<h2>
<span class="header-section-number">B.2</span> Analysis of Variance (ANOVA)<a class="anchor" aria-label="anchor" href="#analysis-of-variance-anova"><i class="fas fa-link"></i></a>
</h2>
<p>As we’ve seen, ANOVA is not something that is typically done by hand, so we will only illustrate how to do it all at once. To do ANOVA, we need to load both the <code>tidyverse</code> and the <code>magrittr</code> packages from R’s library:</p>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'magrittr'</code></pre>
<pre><code>## The following object is masked from 'package:purrr':
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     extract</code></pre>
<p>As we’ve seen, ANOVA has two stages: First, we conduct an ANOVA to see if we have evidence that groups tend to differ from one another on average. Second, if we are able to reject the null hypothesis with our ANOVA, we move on to conduct post hoc pairwise <span class="math inline">\(t\)</span> tests to see if we have evidence about which groups differ from one another.</p>
<p>For these examples, we will use a simple example dataset:</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/anova_data.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 15 Columns: 3</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (3): ID, Group, X</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>This is what this example looks like:</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span></code></pre></div>
<pre><code>## # A tibble: 15 × 3
##       ID Group     X
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1 -0.58
##  2     2     1 -0.29
##  3     3     1 -1.01
##  4     4     1 -1.81
##  5     5     1 -0.47
##  6     6     1 -0.23
##  7     7     2 -0.21
##  8     8     2  0.96
##  9     9     2  0.5 
## 10    10     2  0.8 
## 11    11     3  0.68
## 12    12     3  0.53
## 13    13     3 -0.31
## 14    14     3  1.53
## 15    15     3  0.52</code></pre>
<div id="anova" class="section level3" number="14.2.1">
<h3>
<span class="header-section-number">B.2.1</span> ANOVA<a class="anchor" aria-label="anchor" href="#anova"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>As we’ve seen, this part is easy because the null hypothesis in ANOVA is always the same: The null hypothesis is that all samples come from populations that have equal means (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2 = \cdots = \mu_G\)</span>). The alternative hypothesis is that the samples come from populations with means that are not all equal; in other words, at least one population mean is different from the others.</p>
<ol start="2" style="list-style-type: decimal">
<li>Decide on an <strong>alpha level</strong>.</li>
</ol>
<p>Let’s assume that we have adopted an alpha level of 0.05.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(F\)</span> value.</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value.</p></li>
</ol>
<p>Both the previous two steps are accomplished in the same chunk of code:</p>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">X</span> <span class="op">~</span> <span class="va">Group</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: X
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Group      1 4.9824  4.9824  12.245 0.00392 **
## Residuals 13 5.2897  0.4069                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>To do this with your own data, make sure to tell R the name of your dataset (replace <code>my_data</code>), the name of your response variable (replace <code>X</code>), and the name of your explanatory variable that designates which sample each observation came from (replace <code>Group</code>).</p>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>
</div>
<div id="post-hoc-pairwise-t-tests" class="section level3" number="14.2.2">
<h3>
<span class="header-section-number">B.2.2</span> Post hoc pairwise <span class="math inline">\(t\)</span> tests<a class="anchor" aria-label="anchor" href="#post-hoc-pairwise-t-tests"><i class="fas fa-link"></i></a>
</h3>
<p>If we reject the ANOVA null hypothesis (as we did in the above example), then we proceed to do “post hoc” pairwise <span class="math inline">\(t\)</span> tests. The purpose of these tests is to see if we have evidence about which groups differ from one another.</p>
<p>“Under the hood,” R is doing independent samples <span class="math inline">\(t\)</span> tests between each pair of groups in our data. Each of those tests is two-tailed, meaning the null hypothesis for each of these tests is <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 - \mu_2 = 0\)</span> (step 1). We retain the same alpha level that we used in our ANOVA (step 2). R does not show us the <span class="math inline">\(t\)</span> values (step 3), only the <span class="math inline">\(p\)</span> values (step 4) from each test. These <span class="math inline">\(p\)</span> values are “adjusted” in order to avoid increasing the probability of a Type I error, and we have to tell R what adjustment to use. Finally, it us up to us to decide whether or not to reject the null hypothesis <em>in each test</em> based on the <span class="math inline">\(p\)</span> values and our alpha level.</p>
<p>This is how it is done in R:</p>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span>
        x <span class="op">=</span> <span class="va">X</span>,
        g <span class="op">=</span> <span class="va">Group</span>,
        p.adjust.method <span class="op">=</span> <span class="st">'bonferroni'</span>
    <span class="op">)</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  X and Group 
## 
##   1     2    
## 2 0.022 -    
## 3 0.010 1.000
## 
## P value adjustment method: bonferroni</code></pre>
<p>As above, remember that you’ll need to swap out <code>my_data</code> for your own data, as well as changing the names of the response variable (in <code>x = ___</code>) and the explanatory variable (in <code>g = ___</code>).</p>
</div>
</div>
<div id="linear-regression" class="section level2" number="14.3">
<h2>
<span class="header-section-number">B.3</span> Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"><i class="fas fa-link"></i></a>
</h2>
<p>With linear regression, we are interested in asking whether the linear relationship between the explanatory and response variables—this relationship is a “<strong>linear model</strong>”—actually helps explain differences in the response variable. The resulting hypothesis test procedure is very similar to that for ANOVA.</p>
<p>The difference is that ANOVA asks about an explanatory variable that is on a <em>nominal</em> scale, i.e., it just tells us which group an observation came from; linear regression asks about an explanatory variable that is on an <em>interval</em> or <em>ratio</em> scale, i.e., it tells us a specific number that is on a meaningful scale.</p>
<p>For this example, we will use a simple artificial dataset:</p>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/linreg_example_data.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 30 Columns: 2</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (2): X, Y</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>This is what the data look like:</p>
<div class="sourceCode" id="cb668"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span></code></pre></div>
<pre><code>## # A tibble: 30 × 2
##        X      Y
##    &lt;dbl&gt;  &lt;dbl&gt;
##  1 -1.85 -2.02 
##  2 -1.78 -3.82 
##  3 -1.53 -4.28 
##  4 -1.53 -0.400
##  5 -1.33 -2.72 
##  6 -1.03 -0.768
##  7 -0.96 -0.861
##  8 -0.84 -1.61 
##  9 -0.63 -0.529
## 10 -0.59 -0.806
## # … with 20 more rows</code></pre>
<p>We will use the <code>X</code> variable as the <strong>explanatory</strong> variable and the <code>Y</code> variable as the <strong>response</strong> variable.</p>
<ol style="list-style-type: decimal">
<li>Translate your <strong>research question</strong> into a <strong>null</strong> and <strong>alternative</strong> hypothesis.</li>
</ol>
<p>As with ANOVA, this part is easy because the null hypothesis in linear regression is always the same: The null hypothesis is that the true value of the <em>slope</em> of the linear relationship is zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(b_1 = 0\)</span>). The alternative hypothesis is that the true value of the slope is not equal to zero (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(b_1 \neq 0\)</span>).</p>
<ol start="2" style="list-style-type: decimal">
<li>Decide on an <strong>alpha level</strong>.</li>
</ol>
<p>Let’s assume that we have adopted an alpha level of 0.05.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Find the <span class="math inline">\(F\)</span> value.</p></li>
<li><p>Find the <span class="math inline">\(p\)</span> value.</p></li>
</ol>
<p>Both the previous two steps are accomplished in the same chunk of code:</p>
<div class="sourceCode" id="cb670"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_data</span> <span class="op">%$%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Y
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## X          1 24.141 24.1408  33.078 3.581e-06 ***
## Residuals 28 20.435  0.7298                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>To do this with your own data, make sure to tell R the name of your dataset (replace <code>my_data</code>), the name of your response variable (replace <code>X</code>), and the name of your explanatory variable (replace <code>Y</code>).</p>
<ol start="5" style="list-style-type: decimal">
<li>Decide whether or not to reject the null hypothesis.</li>
</ol>
<p>If the <span class="math inline">\(p\)</span> value is less than the alpha level, you <em>reject</em> the null hypothesis, otherwise you <em>fail to reject</em> it.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="coderef.html"><span class="header-section-number">A</span> Distributions</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#hyptests"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li>
<a class="nav-link" href="#t-tests"><span class="header-section-number">B.1</span> \(t\) tests</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#doing-them-step-by-step"><span class="header-section-number">B.1.1</span> Doing them step-by-step</a></li>
<li><a class="nav-link" href="#doing-them-all-at-once"><span class="header-section-number">B.1.2</span> Doing them all at once</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#analysis-of-variance-anova"><span class="header-section-number">B.2</span> Analysis of Variance (ANOVA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#anova"><span class="header-section-number">B.2.1</span> ANOVA</a></li>
<li><a class="nav-link" href="#post-hoc-pairwise-t-tests"><span class="header-section-number">B.2.2</span> Post hoc pairwise \(t\) tests</a></li>
</ul>
</li>
<li><a class="nav-link" href="#linear-regression"><span class="header-section-number">B.3</span> Linear Regression</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/98-hyp_tests.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/98-hyp_tests.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-08-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
