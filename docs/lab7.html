<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 7 Confidence intervals and hypothesis testing | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Central tendency and variability</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Scatterplots and correlation</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Probability and simulation</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Models: The Binomial and the Normal</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></li>
<li><a class="active" href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></li>
<li><a class="" href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></li>
<li><a class="" href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="coderef.html"><span class="header-section-number">A</span> Distributions</a></li>
<li><a class="" href="hyptests.html"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab7" class="section level1" number="7">
<h1>
<span class="header-section-number">Lab 7</span> Confidence intervals and hypothesis testing<a class="anchor" aria-label="anchor" href="#lab7"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/heart_clock.jpg" width="100%"></div>
<p>As we’ve seen, one of the remarkable fruits of the “central limit theorem” is the <strong>confidence interval</strong>. This interval tells us where sample means are likely to be, assuming</p>
<ol style="list-style-type: decimal">
<li>Samples are selected from the population using simple random sampling; and</li>
<li>That we either know or hypothesize the parameters of the population we are sampling from.</li>
</ol>
<p>We explored the consequences of sampling last time. Today, we will see more about how to find confidence intervals in R and use them to test <strong>hypotheses</strong>. Specifically, we will use confidence intervals to test “null” hypotheses. As we’ve seen, there are four basic steps to testing a hypothesis using a confidence interval.</p>
<ol style="list-style-type: decimal">
<li>Figure out what parameters would describe the population <em>if</em> the hypothesis were true.</li>
<li>Decide how wide to make our confidence interval.</li>
<li>Figure out the upper and lower boundaries of the confidence interval.</li>
<li>Compare our sample to the confidence interval and, if it is outside the interval, <em>reject</em> our original hypothesis.</li>
</ol>
<p>In the first part of the session, we will do hypothesis tests with simulated data where we know whether the null hypothesis is true or not. In the second part of the session, we will do a hypothesis test on real data and see what we can learn about the population from which it was sampled.</p>
<p>Before we begin, make sure you’ve got the “tidyverse” package loaded from R’s library.</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="be-still-my-artificial-heart" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Be still, my (artificial) heart<a class="anchor" aria-label="anchor" href="#be-still-my-artificial-heart"><i class="fas fa-link"></i></a>
</h2>
<p>The resting heart rate within the typical US adult population has a mean of <span class="math inline">\(\mu = 71\)</span> beats-per-minute with a standard deviation of <span class="math inline">\(\sigma = 9\)</span> beats-per-minute. We all know that sudden excitement or shock tends to increase our heart rate, but interestingly, the effect of chronic stress on heart rate is not well established. There is evidence for both a <em>higher</em> resting heart rate due to sustained minor stress, as well as a <em>lower</em> resting heart rate due to frequent major stressful life events. In any case, it is clear that detecting abnormal heart rate can be important not just for physiological health, but psychological health as well.</p>
<p>In this part of the session, we will simulate different samples of individuals with different resting heart rates and test the hypothesis that these individuals come from a population with the same heart rate parameters as the typical US adult population. We will follow the steps above to construct a confidence interval (steps 1–3), then compare our simulated sample against it (step 4).</p>
<div id="constructing-confidence-intervals" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Constructing confidence intervals<a class="anchor" aria-label="anchor" href="#constructing-confidence-intervals"><i class="fas fa-link"></i></a>
</h3>
<p>Before we can even get to step 1, we need to be clear what our hypothesis is that we are testing. Our <em>research</em> hypothesis is that the sample of individuals comes from a population with a <em>different</em> mean heart rate than the typical US adult. The <strong>statistical hypothesis</strong> that we are testing is the <strong>null</strong> hypothesis.</p>
<blockquote>
<p>The <strong>null hypothesis</strong> is that our sample comes from a population with the <strong>same</strong> mean heart rate as the typical US adult population, with <span class="math inline">\(\mu = 71\)</span>.</p>
</blockquote>
<p>If we can <em>reject</em> this null hypothesis, then we have reason to believe that our sample is meaningfully different from the typical population and we say it is <strong>statistically significant</strong>.</p>
<div id="figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true" class="section level4" number="7.1.1.1">
<h4>
<span class="header-section-number">7.1.1.1</span> Figure out what parameters would describe the population <em>if</em> the hypothesis were true<a class="anchor" aria-label="anchor" href="#figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true"><i class="fas fa-link"></i></a>
</h4>
<p>From the description above, we know the population mean (<span class="math inline">\(\mu = 71\)</span>) and standard deviation (<span class="math inline">\(\sigma = 9\)</span>). Let us assume that our sample size is <span class="math inline">\(n = 40\)</span>, which is typical for this kind of research. The central limit theorem tells us that our sample means will, then, have a normal distribution with mean <span class="math inline">\(\mu = 71\)</span> and <strong>standard error of the mean</strong> <span class="math inline">\(\frac{\sigma}{\sqrt{n}} = \frac{9}{\sqrt{40}}\)</span>. We can use R to calculate what the standard error is.</p>

<div class="exercise">
<p><span id="exr:ex0701" class="exercise"><strong>Exercise 7.1  </strong></span>
What R code would give us the standard error of the mean?</p>
</div>
<pre><code>## [1] 1.423025</code></pre>
</div>
<div id="decide-how-wide-to-make-our-confidence-interval" class="section level4" number="7.1.1.2">
<h4>
<span class="header-section-number">7.1.1.2</span> Decide how wide to make our confidence interval<a class="anchor" aria-label="anchor" href="#decide-how-wide-to-make-our-confidence-interval"><i class="fas fa-link"></i></a>
</h4>
<p>Our confidence interval is defined by how unlikely a sample has to be before we are willing to reject the null hypothesis. A standard rule is to say that if a result has probability <span class="math inline">\(0.05\)</span> or less if the null hypothesis were true, then we can <em>reject</em> the null hypothesis. This standard rule corresponds to a “95% confidence interval,” where the “95%” refers to <span class="math inline">\(1 - 0.05 = 0.95\)</span>, which is the probability that we will <em>fail to reject</em> the null hypothesis when it is true.</p>
<p>Let us adopt the standard rule for now and use the 95% confidence interval.</p>
</div>
<div id="figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval" class="section level4" number="7.1.1.3">
<h4>
<span class="header-section-number">7.1.1.3</span> Figure out the upper and lower boundaries of the confidence interval<a class="anchor" aria-label="anchor" href="#figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval"><i class="fas fa-link"></i></a>
</h4>
<p>To find the upper and lower boundaries of the confidence interval, we have to divide the <span class="math inline">\(0.05\)</span> probability of being outside the interval between the upper and lower ends of the scale. This means that there is a probability of <span class="math inline">\(\frac{0.05}{2} = 0.025\)</span> of being <em>less than</em> the lower boundary and a probability of <span class="math inline">\(0.025 + 0.95 = 0.975\)</span> of being <em>less than</em> the upper boundary.</p>
<p>The <strong>lower</strong> boundary of the 95% confidence interval is then</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.025</span>, mean <span class="op">=</span> <span class="fl">71</span>, sd <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 68.21092</code></pre>
<p>while the <strong>upper</strong> boundary is</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.975</span>, mean <span class="op">=</span> <span class="fl">71</span>, sd <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 73.78908</code></pre>

<div class="exercise">
<p><span id="exr:ex0702" class="exercise"><strong>Exercise 7.2  </strong></span>
Based on the upper and lower boundaries we just found, what is the <em>margin of error</em>?</p>
</div>
</div>
<div id="visualization" class="section level4" number="7.1.1.4">
<h4>
<span class="header-section-number">7.1.1.4</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization"><i class="fas fa-link"></i></a>
</h4>
<p>The logic of hypothesis testing can be easier to understand if we visualize the distribution of sample means and the 95% confidence interval. To do that, we will first use the normal distribution to simulate different sample means, then make a colored histogram of those sample means that distinguishes between ones that are inside the confidence interval and ones that are outside the confidence interval.</p>
<p>First, let’s simulate a large number of means of possible samples of size <span class="math inline">\(n = 40\)</span> that we might observe if the null hypothesis were true.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, mean <span class="op">=</span> <span class="fl">71</span>, sd <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now let’s turn those into “data” so we can use R to make a histogram of these simulated sample means.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means_size40</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">M</span><span class="op">)</span></code></pre></div>
<p>And finally make the histogram</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means_size40</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-confidence_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<p>Now we need to color in this histogram depending on whether the sample mean is inside or outside the confidence interval. To do that, let’s tell R to remember the upper and lower boundaries we found earlier</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.025</span>, mean <span class="op">=</span> <span class="fl">71</span>, sd <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span>
<span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.975</span>, mean <span class="op">=</span> <span class="fl">71</span>, sd <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>That makes it easier to fill the bars with different colors:</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_means_size40</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="op">(</span><span class="va">M</span> <span class="op">&gt;</span> <span class="va">ci_lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="va">ci_upper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-confidence_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
</div>
</div>
<div id="compare-our-sample-to-the-confidence-interval" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Compare our sample to the confidence interval<a class="anchor" aria-label="anchor" href="#compare-our-sample-to-the-confidence-interval"><i class="fas fa-link"></i></a>
</h3>
<p>In this part of our session, we will <em>simulate</em> different samples and compare them to the confidence interval we just found. We will see how different our sample needs to be from the typical population before we consistently reject the null hypothesis.</p>
<div id="when-the-null-hypothesis-is-true" class="section level4" number="7.1.2.1">
<h4>
<span class="header-section-number">7.1.2.1</span> When the null hypothesis is <em>true</em><a class="anchor" aria-label="anchor" href="#when-the-null-hypothesis-is-true"><i class="fas fa-link"></i></a>
</h4>
<p>First, let’s imagine that the sample of individuals we get actually does come from a population with the same mean heart rate as typical US adults, i.e. with <span class="math inline">\(\mu = 71\)</span>. We will tell R to remember our sample under the label “heart_rate_sample.”</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heart_rate_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">71</span>, sd <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></code></pre></div>

<div class="exercise">
<p><span id="exr:ex0703" class="exercise"><strong>Exercise 7.3  </strong></span>
Compare the code just we used to simulate a sample of heart rates with the code we used to simulate sample means. Why is the mean the same? Why is the standard deviation different?</p>
</div>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">heart_rate_sample</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 70.02283</code></pre>
<p>Is the sample mean outside the confidence interval, which would lead us to <em>reject</em> the null hypothesis, even though it is actually true?</p>

<div class="exercise">
<p><span id="exr:ex0704" class="exercise"><strong>Exercise 7.4  </strong></span>Try running the previous two lines of code a few more times (simulate a new sample and find its mean). How many times did it take before you simulated a sample with a mean that fell <em>outside</em> the 95% confidence interval?</p>
</div>
</div>
<div id="when-the-null-hypothesis-is-false" class="section level4" number="7.1.2.2">
<h4>
<span class="header-section-number">7.1.2.2</span> When the null hypothesis is <em>false</em><a class="anchor" aria-label="anchor" href="#when-the-null-hypothesis-is-false"><i class="fas fa-link"></i></a>
</h4>
<p>Now let’s imagine that the sample we get comes from a population that has a higher resting heart rate, on average, than the typical US adult population. Will we correctly reject the null hypothesis?</p>
<p>Let’s say that the mean heart rate in this <em>different</em> population is 74.</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heart_rate_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">74</span>, sd <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></code></pre></div>
<p>How does the mean of this sample compare to the confidence interval we found above?</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">heart_rate_sample</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 74.82869</code></pre>

<div class="exercise">
<p><span id="exr:ex0705" class="exercise"><strong>Exercise 7.5  </strong></span>
Run the previous two lines of code 10 times. Out of those ten times, how often did the sample mean fall outside the 95% confidence interval?</p>
</div>

<div class="exercise">
<p><span id="exr:ex0706" class="exercise"><strong>Exercise 7.6  </strong></span>
In the code we just used, we assumed that our samples came from a population with a mean of 74. How much bigger do you think this mean would need to be before almost all samples would fall outside the 95% confidence interval? 75? 76? 100? Why?</p>
</div>
</div>
</div>
</div>
<div id="lay-your-weary-head-to-rest" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Lay your weary head to rest<a class="anchor" aria-label="anchor" href="#lay-your-weary-head-to-rest"><i class="fas fa-link"></i></a>
</h2>
<p>Having tested hypotheses using simulated resting heart rate data, let’s see about testing a hypothesis using some real data. These data have to do with a different kind of rest, sleep. These are the number of hours slept in a particular night for a simple random sample of <span class="math inline">\(n = 110\)</span> US college students. We will use hypothesis testing with confidence intervals to <em>infer</em> whether college students tend to sleep the recommended amount per night.</p>
<p>First, let’s make sure to download the data to get it into R</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">student_sleep</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/student_sleep.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 110 Columns: 1</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (1): hours</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>If you click on the “student_sleep” data in R’s environment pane in the upper right, you’ll see that it is just a single column called “hours,” where each row in the number of hours slept by a different student.</p>
<p>Let’s also make a histogram to get a sense of what the data look like.</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">student_sleep</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hours</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-confidence_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex0707" class="exercise"><strong>Exercise 7.7  </strong></span>
Describe the shape of the distribution of number of hours slept. Does it seem symmetrical, skewed? How many modes does the distribution seem to have?</p>
</div>
<div id="figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true-1" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Figure out what parameters would describe the population <em>if</em> the hypothesis were true<a class="anchor" aria-label="anchor" href="#figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true-1"><i class="fas fa-link"></i></a>
</h3>
<p>Our <em>research</em> hypothesis is that college students do <em>not</em> sleep the recommended amount per night. According to the National Sleep Foundation, the recommended distribution of sleep for young adults has a mean of <span class="math inline">\(\mu = 8\)</span> hours and a standard deviation of <span class="math inline">\(\sigma = 1\)</span> hour. As a result, the <strong>null hypothesis</strong> that we are going to test is that the mean number of hours slept by college students is <em>equal to</em> the recommended population mean of <span class="math inline">\(\mu = 8\)</span>.</p>
<p>Notice that we are again using a “hypothetical” population to specify our null hypothesis. This hypothetical population is college students who sleep the recommended amount per night. We are going to see if our sample could plausibly have come from such a population.</p>
</div>
<div id="decide-how-wide-to-make-our-confidence-interval-1" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Decide how wide to make our confidence interval<a class="anchor" aria-label="anchor" href="#decide-how-wide-to-make-our-confidence-interval-1"><i class="fas fa-link"></i></a>
</h3>
<p>Again, we have a choice to make here about how willing we are to make a “Type I error,” that is, to reject the null hypothesis even when it is true. For the sake of argument, let’s say that we want to be very conservative and will try to minimize our risk of making a Type I error. So instead of a 95% confidence interval, let’s make a 99% confidence interval. This means that the probability of making a Type I error is only <span class="math inline">\(0.01\)</span>.</p>
</div>
<div id="figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval-1" class="section level3" number="7.2.3">
<h3>
<span class="header-section-number">7.2.3</span> Figure out the upper and lower boundaries of the confidence interval<a class="anchor" aria-label="anchor" href="#figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval-1"><i class="fas fa-link"></i></a>
</h3>
<p>We now have all the ingredients we need to make a confidence interval. We have the population mean (<span class="math inline">\(\mu = 8\)</span>), population standard deviation (<span class="math inline">\(\sigma = 1\)</span>), sample size (<span class="math inline">\(n = 110\)</span>), and confidence interval width (99%).</p>
<p>The lower bound of our confidence interval is then</p>
<pre><code>## [1] 7.754404</code></pre>
<p>while the upper boundary is</p>
<pre><code>## [1] 8.245596</code></pre>

<div class="exercise">
<p><span id="exr:ex0708" class="exercise"><strong>Exercise 7.8  </strong></span>
What is the R code for finding those lower and upper boundaries of the 99% confidence interval? <em>Hint: what do you need to change in the code we used for finding the confidence interval boundaries in the heart rate example above?</em></p>
</div>
</div>
<div id="compare-our-sample-to-the-confidence-interval-1" class="section level3" number="7.2.4">
<h3>
<span class="header-section-number">7.2.4</span> Compare our sample to the confidence interval<a class="anchor" aria-label="anchor" href="#compare-our-sample-to-the-confidence-interval-1"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, let’s find our sample mean and compare it to the confidence interval to decide whether or not to reject our null hypothesis:</p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">student_sleep</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hours</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       M
##   &lt;dbl&gt;
## 1  7.42</code></pre>
<p>That is definitely outside the bounds of our 99% confidence interval! As a result, we <strong>reject</strong> the hypothesis that the mean number of hours slept by the population of college students is equal to the recommended amount of <span class="math inline">\(\mu = 8\)</span> hours.</p>

<div class="exercise">
<p><span id="exr:ex0709" class="exercise"><strong>Exercise 7.9  </strong></span>
Although we rejected the null hypothesis in this case, take a look at the histogram we made above of the complete distribution of student sleep time. Is it the case that every single student sleeps less than the recommended amount? What does this mean for how we should interpret the results of our hypothesis test?</p>
</div>
</div>
</div>
<div id="wrap-up-6" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-6"><i class="fas fa-link"></i></a>
</h2>
<p>In this session, we saw how we can use R to find confidence intervals and how we can use those intervals to test null hypotheses. We saw how hypothesis tests are not perfect—they can lead us to reject the null hypothesis even if it is true (Type I error) and they don’t always lead us to reject the null hypothesis even when it is false (Type II error). Even so, hypothesis tests can be a powerful way to learn about the world using data.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></div>
<div class="next"><a href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab7"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li>
<a class="nav-link" href="#be-still-my-artificial-heart"><span class="header-section-number">7.1</span> Be still, my (artificial) heart</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#constructing-confidence-intervals"><span class="header-section-number">7.1.1</span> Constructing confidence intervals</a></li>
<li><a class="nav-link" href="#compare-our-sample-to-the-confidence-interval"><span class="header-section-number">7.1.2</span> Compare our sample to the confidence interval</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#lay-your-weary-head-to-rest"><span class="header-section-number">7.2</span> Lay your weary head to rest</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true-1"><span class="header-section-number">7.2.1</span> Figure out what parameters would describe the population if the hypothesis were true</a></li>
<li><a class="nav-link" href="#decide-how-wide-to-make-our-confidence-interval-1"><span class="header-section-number">7.2.2</span> Decide how wide to make our confidence interval</a></li>
<li><a class="nav-link" href="#figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval-1"><span class="header-section-number">7.2.3</span> Figure out the upper and lower boundaries of the confidence interval</a></li>
<li><a class="nav-link" href="#compare-our-sample-to-the-confidence-interval-1"><span class="header-section-number">7.2.4</span> Compare our sample to the confidence interval</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-6"><span class="header-section-number">7.3</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/07-confidence.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/07-confidence.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-08-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
