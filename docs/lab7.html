<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 7 The normal distribution | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Sampling</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Describing data</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Relationships Between Numerical Variables</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Hypothesis testing with randomization</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Confidence intervals with bootstrapping</a></li>
<li><a class="active" href="lab7.html"><span class="header-section-number">7</span> The normal distribution</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Inference for proportions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab7" class="section level1" number="7">
<h1>
<span class="header-section-number">Lab 7</span> The normal distribution<a class="anchor" aria-label="anchor" href="#lab7"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/tree_road.jpg" width="100%"></div>
<p>The venerable <strong>normal distribution</strong> or “bell curve” is almost like a mascot for statistics. Although there are variables in real life that are distributed according to a normal distribution, its real value is in describing sampling distributions. We have seen sampling distributions in both hypothesis testing and confidence intervals: Sampling distributions represent the variability in a point estimate like a proportion or mean that is due to the randomness involved in selecting samples from a population. According to the <strong>central limit theorem</strong>, much of the time, sampling distributions will be approximately normal in shape.</p>
<p>In this session, we will first use the normal distribution as a model for population distributions, that is the distribution of values on a particular variable across a whole population. Along the way, we will get the hang of using R to find proportions and intervals based on the normal distribution. Then, in the second part, we will use the normal distribution as a model for sampling distributions. This will give us some insight into how <strong>standard error</strong> relates to things like sample size.</p>
<div id="required-packages-tidyverse-and-infer" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Required packages: <code>tidyverse</code> and <code>infer</code><a class="anchor" aria-label="anchor" href="#required-packages-tidyverse-and-infer"><i class="fas fa-link"></i></a>
</h2>
<p>We will require both the <code>tidyverse</code> and <code>infer</code> packages for this session, so make sure to load both from R’s library:</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre class="Rout text-info"><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre class="Rout text-info"><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre class="Rout text-info"><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="the-data-national-health-and-nutrition-examination-surveys-nhanes" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> The data: National Health and Nutrition Examination Surveys (NHANES)<a class="anchor" aria-label="anchor" href="#the-data-national-health-and-nutrition-examination-surveys-nhanes"><i class="fas fa-link"></i></a>
</h2>
<p>The data we will be using in this lab were originally collected by the US National Center for Heath Statistics between 2009 and 2012. This is a subset of what is effectively a simple random sample from the entire US population, though we will only use some of the observations out of the many they collected. Load the data with the following line:</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nhanes</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/nhanes.csv"</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-info"><code>## Rows: 4924 Columns: 76</code></pre>
<pre class="Rout text-info"><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (31): SurveyYr, Gender, AgeDecade, Race1, Race3, Education, MaritalStatu...
## dbl (41): ID, Age, AgeMonths, HHIncomeMid, Poverty, HomeRooms, Weight, Heigh...
## lgl  (4): Length, HeadCirc, TVHrsDayChild, CompHrsDayChild</code></pre>
<pre class="Rout text-info"><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="the-normal-distribution-as-a-model-for-a-population-distribution" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> The normal distribution as a model for a population distribution<a class="anchor" aria-label="anchor" href="#the-normal-distribution-as-a-model-for-a-population-distribution"><i class="fas fa-link"></i></a>
</h2>
<div id="hours-of-sleep-sleephrsnight" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Hours of Sleep (<code>SleepHrsNight</code>)<a class="anchor" aria-label="anchor" href="#hours-of-sleep-sleephrsnight"><i class="fas fa-link"></i></a>
</h3>
<p>The variable we will focus on in this section is the number of hours people report sleeping each night, measured in hours. This is recorded for each individual in the sample under the variable <code>SleepHrsNight</code>.</p>
<div id="visualize-the-distribution" class="section level4" number="7.3.1.1">
<h4>
<span class="header-section-number">7.3.1.1</span> Visualize the distribution<a class="anchor" aria-label="anchor" href="#visualize-the-distribution"><i class="fas fa-link"></i></a>
</h4>
<p>As usual, we begin by visualizing the actual data. As a reminder, we will assume for the time being that these data constitute the entire population of interest. The histogram below shows the population distribution of nightly hours of sleep:</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">SleepHrsNight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-normal_distribution_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
</div>
<div id="is-the-normal-distribution-a-good-model" class="section level4" number="7.3.1.2">
<h4>
<span class="header-section-number">7.3.1.2</span> Is the normal distribution a good model?<a class="anchor" aria-label="anchor" href="#is-the-normal-distribution-a-good-model"><i class="fas fa-link"></i></a>
</h4>
<p>Next, we want to know whether the normal distribution will be a good model of the population distribution we just visualized. To do this, we will draw a curve representing the normal distribution on top of the histogram we just made.</p>
<p>But remember that the normal distribution is just a shape. Its center and spread are determined by two population parameters: the <strong>mean</strong> (<span class="math inline">\(\mu\)</span>) and <strong>standard deviation</strong> (<span class="math inline">\(\sigma\)</span>). What should those parameters be?</p>
<p>Let’s first take a wild guess and say they should be <span class="math inline">\(\mu = 8\)</span> and <span class="math inline">\(\sigma = 1\)</span>. We can draw this distribution using the chunk of code below:</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">SleepHrsNight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">8</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'darkred'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-normal_distribution_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<p>Notice that we needed to add <code>aes(y = ..density..)</code> to our histogram line, for reasons which will be clear in the next paragraph. The final line lets us draw a <code>function</code> on our graph. The <code>fun</code>ction is called <code>dnorm</code> for “<code>d</code>ensity of a <code>norm</code>al distribution.” We had to say what the <code>arg</code>ument<code>s</code> of that function should be, which are a <code>list</code> in which we say what the <code>mean</code> and <code>sd</code> of the normal distribution should be.</p>
<p>The whole “density” thing comes from this: A histogram shows <em>absolute</em> counts. But a normal distribution only specifies the <em>relative</em> frequency of different values. The relative frequency is called the “density.” This is what the <code>dnorm</code> function gives us for the normal distribution. So adding <code>aes(y = ..density..)</code> to the histogram line told R to show the density (relative frequency) rather than the absolute counts.</p>
<p>Anyway, it is clear that a mean of 8 hours and standard deviation of 1 hour do not make a good fit. What we should use instead are the actual mean and SD from our data:</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SleepHrsNight</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">SleepHrsNight</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 1 × 2
##   `mean(SleepHrsNight)` `sd(SleepHrsNight)`
##                   &lt;dbl&gt;               &lt;dbl&gt;
## 1                  6.86                1.32</code></pre>
<p>Let’s give those numbers a label so we can use them later:</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mean_sleep</span> <span class="op">&lt;-</span> <span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SleepHrsNight</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span>

<span class="va">sd_sleep</span> <span class="op">&lt;-</span> <span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">SleepHrsNight</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-44" class="exercise"><strong>Exercise 7.1  </strong></span>Fill in the blanks in the code below to visualize the fit of the normal distribution using the values for the mean and SD we just found.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="lab7.html#cb212-1" aria-hidden="true" tabindex="-1"></a>nhanes <span class="sc">%&gt;%</span></span>
<span id="cb212-2"><a href="lab7.html#cb212-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> SleepHrsNight)) <span class="sc">+</span></span>
<span id="cb212-3"><a href="lab7.html#cb212-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb212-4"><a href="lab7.html#cb212-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> ___, <span class="at">sd =</span> ___), <span class="at">color =</span> <span class="st">'darkred'</span>)</span></code></pre></div>
<p>Does the normal distribution do a good job approximating the shape of the population distribution?</p>
</div>
</div>
<div id="proportions-from-a-normal-distribution" class="section level4" number="7.3.1.3">
<h4>
<span class="header-section-number">7.3.1.3</span> Proportions from a normal distribution<a class="anchor" aria-label="anchor" href="#proportions-from-a-normal-distribution"><i class="fas fa-link"></i></a>
</h4>
<p>Using a normal distribution, it is possible to estimate what proportion of values will be above or below some number. For example, the following uses the normal distribution to estimate the proportion of people who say they get less than eight hours of sleep per night:</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">8</span>, mean <span class="op">=</span> <span class="va">mean_sleep</span>, sd <span class="op">=</span> <span class="va">sd_sleep</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## [1] 0.8058069</code></pre>
<p>Conversely, this is the proportion that get <em>more</em> than eight hours of sleep per night:</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">8</span>, mean <span class="op">=</span> <span class="va">mean_sleep</span>, sd <span class="op">=</span> <span class="va">sd_sleep</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## [1] 0.1941931</code></pre>
<p>Notice that the difference is whether <code>lower.tail</code> is <code>TRUE</code> or <code>FALSE</code>. If <code>lower.tail = TRUE</code>, we are asking the proportion that is <em>below</em> the value <code>q</code>, but if <code>lower.tail = FALSE</code> we are asking the proportion that is <em>above</em> the value <code>q</code>.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-45" class="exercise"><strong>Exercise 7.2  </strong></span>Use the <code>pnorm</code> function to find the following proportions:</p>
<ol style="list-style-type: lower-alpha">
<li>The proportion of people who get <em>less than</em> 6 hours of sleep per night.</li>
<li>The proportion of people who get <em>more than</em> 10 hours of sleep per night.</li>
<li>The proportion of people who get <em>either</em> less than 6 hours of sleep per night <em>or</em> more than 10 hours of sleep per night (<em>Hint:</em> you can add proportions of things that do not overlap.)</li>
</ol>
</div>
</div>
<div id="quantiles-from-a-normal-distribution" class="section level4" number="7.3.1.4">
<h4>
<span class="header-section-number">7.3.1.4</span> Quantiles from a normal distribution<a class="anchor" aria-label="anchor" href="#quantiles-from-a-normal-distribution"><i class="fas fa-link"></i></a>
</h4>
<p>As we saw last time, things like confidence intervals are defined in terms of “quantiles.” Finding a quantile is the opposite of finding a proportion. In R, this opposite relationship is clear because we just swap the <code>p</code> and <code>q</code>. The <code>qnorm</code> function find the value <code>q</code> for which the proportion <code>p</code> of values are either below or above <code>q</code>.</p>
<p>For example, if we want to know the “25th percentile,” this is the quantile <code>q</code> for which <code>p = 0.25</code> are <em>less than</em> that value:</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.25</span>, mean <span class="op">=</span> <span class="va">mean_sleep</span>, sd <span class="op">=</span> <span class="va">sd_sleep</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## [1] 5.964337</code></pre>
<p>Here’s a neat trick, though: If 0.25 are <em>less than</em> some value, that means 0.75 are <em>more than</em> that value. So if we flip <code>lower.tail</code> to <code>FALSE</code> and <code>p</code> to <code>0.75</code>, we will get the same answer:</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.75</span>, mean <span class="op">=</span> <span class="va">mean_sleep</span>, sd <span class="op">=</span> <span class="va">sd_sleep</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## [1] 5.964337</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-46" class="exercise"><strong>Exercise 7.3  </strong></span>Use the <code>qnorm</code> function to find the following quantiles:</p>
<ol style="list-style-type: lower-alpha">
<li>What is the quantile for which 0.025 of the data are <em>below</em> that value?</li>
<li>What is the quantile for which 0.025 of the data are <em>above</em> that value?</li>
<li>Between which two values does the middle 95% of the data fall? (<em>Hint:</em> how much of the data would fall above and below the middle 95%?)</li>
</ol>
</div>
</div>
</div>
<div id="bad-days-daysmenthlthbad" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> Bad Days (<code>DaysMentHlthBad</code>)<a class="anchor" aria-label="anchor" href="#bad-days-daysmenthlthbad"><i class="fas fa-link"></i></a>
</h3>
<p>As part of the same survey, people were asked how many days out of the last 30 would they consider their mental health to have been poor. This is recorded under the variable named <code>DaysMentHlthBad</code>.</p>
<p>Just like we did for the number of hours slept per night, find the mean and standard deviation of <code>DaysMentHlthBad</code> and see whether the normal distribution seems to provide a good approximation to the population distribution.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-47" class="exercise"><strong>Exercise 7.4  </strong></span>Fill in the blanks in the chunk of code below to find the mean and standard deviation of <code>DaysMentHlthBad</code> and plot the data along with the approximating normal distribution.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="lab7.html#cb221-1" aria-hidden="true" tabindex="-1"></a>mean_mental_health <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb221-2"><a href="lab7.html#cb221-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">mean</span>(___)) <span class="sc">%&gt;%</span></span>
<span id="cb221-3"><a href="lab7.html#cb221-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb221-4"><a href="lab7.html#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="lab7.html#cb221-5" aria-hidden="true" tabindex="-1"></a>sd_mental_health <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb221-6"><a href="lab7.html#cb221-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">sd</span>(___)) <span class="sc">%&gt;%</span></span>
<span id="cb221-7"><a href="lab7.html#cb221-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb221-8"><a href="lab7.html#cb221-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-9"><a href="lab7.html#cb221-9" aria-hidden="true" tabindex="-1"></a>nhanes <span class="sc">%&gt;%</span></span>
<span id="cb221-10"><a href="lab7.html#cb221-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb221-11"><a href="lab7.html#cb221-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb221-12"><a href="lab7.html#cb221-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> ___, <span class="at">sd =</span> ___), <span class="at">color =</span> <span class="st">'darkred'</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Describe the shape of the distribution of the observed data shown in the histogram.</li>
<li>Does the normal distribution provide a good fit to these data?</li>
<li>Make a reasoned guess about why the population distribution might have the shape that it has, taking note of the fact that respondents had to give a number of days out of 30.</li>
</ol>
</div>
</div>
</div>
<div id="the-normal-distribution-as-a-model-for-a-sampling-distribution" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> The normal distribution as a model for a sampling distribution<a class="anchor" aria-label="anchor" href="#the-normal-distribution-as-a-model-for-a-sampling-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>In the previous section, we got a sense of how we can use the normal distribution to approximate a distribution of observed values from a population:</p>
<ol style="list-style-type: decimal">
<li>Find the mean and standard deviation.</li>
<li>Check to see how well the normal distribution with that mean and standard deviation fits the histogram of the observed data.</li>
</ol>
<p>We will now follow these same two steps, but instead of using the normal distribution to model a population distribution, we will use it to model a <strong>sampling distribution</strong>, that is, the distribution of summary statistics that we would get across many samples from the same population.</p>
<p>In this section, we will again assume that the <code>nhanes</code> dataset represents the <em>entire population</em> of interest. We will <em>simulate</em> drawing many different samples of different sizes from this population and calculate a summary statistic on each sample. The <strong>sampling distribution</strong> is the distribution of those summary statistics and we will see how well we can approximate it with a normal distribution.</p>
<p>We will focus on just one of the questions asked on the NHANES survey. This question asks whether someone has ever tried using marijuana. This information resides in the variable <code>Marijuana</code> and a person’s response is either “Yes” or “No.”</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-48" class="exercise"><strong>Exercise 7.5  </strong></span>Without even looking at the data, would it make sense to try to use a normal distribution to approximate the population distribution of the responses to the <code>Marijuana</code> question? Why or why not?</p>
</div>
<div id="the-true-proportion" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> The “true” proportion<a class="anchor" aria-label="anchor" href="#the-true-proportion"><i class="fas fa-link"></i></a>
</h3>
<p>Because we are assuming that the <code>nhanes</code> data represent an entire population, we can directly find the “true” value of the population parameter <span class="math inline">\(\pi_{\text{Marijuana}}\)</span>, that is, the proportion of people who have ever tried marijuana. We can use the code below:</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">Marijuana</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>pi <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 2 × 3
##   Marijuana     n    pi
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 No         2045 0.415
## 2 Yes        2879 0.585</code></pre>
<p>Actually, since we are only interested in the proportion who said “Yes,” we can find that proportion using some more compact code:</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>pi_marijuana <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Marijuana</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 1 × 1
##   pi_marijuana
##          &lt;dbl&gt;
## 1        0.585</code></pre>
<p>The “trick” in the previous chunk of code is this: <code>Marijuana == "Yes"</code> checks to see, for each person, whether their response to the <code>Marijuana</code> question was “Yes.” If it was, it gives that person a “score” of 1, but if not, it gives that person a “score” of 0. Recall that the mean is the <em>sum</em> of a set of numbers divided by the <em>total number</em> of numbers. So when we find the <code>mean</code> of those scores using <code><a href="https://rdrr.io/r/base/mean.html">mean(Marijuana == "Yes")</a></code>, we are really adding up the number of people who “scored” a 1 and dividing by the total number of people.</p>
</div>
<div id="simulating-many-samples" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Simulating many samples<a class="anchor" aria-label="anchor" href="#simulating-many-samples"><i class="fas fa-link"></i></a>
</h3>
<p>Last time, we used <em>bootstrapping</em> to simulate what would happen if we collected many samples from a population by using the sample we actually had to <em>estimate</em> the whole population. Now, we have access to that population directly. We can therefore draw as many samples of a given size as we want!</p>
<p>For example, the following chunk of code randomly samples 5 people from the population and gets R to remember that sample under the name <code>sample_size5</code>.</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_size5</span> <span class="op">&lt;-</span> <span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu">sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="va">sample_size5</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 5 × 76
##      ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3 Education   
##   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       
## 1 65978 2011_12  male      57 50-59            NA White   White Some College
## 2 53457 2009_10  female    30 30-39           364 Mexican &lt;NA&gt;  8th Grade   
## 3 53965 2009_10  male      31 30-39           375 Mexican &lt;NA&gt;  Some College
## 4 54006 2009_10  male      20 20-29           240 Mexican &lt;NA&gt;  Some College
## 5 63200 2011_12  female    59 50-59            NA White   White College Grad
## # … with 67 more variables: MaritalStatus &lt;chr&gt;, HHIncome &lt;chr&gt;,
## #   HHIncomeMid &lt;dbl&gt;, Poverty &lt;dbl&gt;, HomeRooms &lt;dbl&gt;, HomeOwn &lt;chr&gt;,
## #   Work &lt;chr&gt;, Weight &lt;dbl&gt;, Length &lt;lgl&gt;, HeadCirc &lt;lgl&gt;, Height &lt;dbl&gt;,
## #   BMI &lt;dbl&gt;, BMICatUnder20yrs &lt;chr&gt;, BMI_WHO &lt;chr&gt;, Pulse &lt;dbl&gt;,
## #   BPSysAve &lt;dbl&gt;, BPDiaAve &lt;dbl&gt;, BPSys1 &lt;dbl&gt;, BPDia1 &lt;dbl&gt;, BPSys2 &lt;dbl&gt;,
## #   BPDia2 &lt;dbl&gt;, BPSys3 &lt;dbl&gt;, BPDia3 &lt;dbl&gt;, Testosterone &lt;dbl&gt;,
## #   DirectChol &lt;dbl&gt;, TotChol &lt;dbl&gt;, UrineVol1 &lt;dbl&gt;, UrineFlow1 &lt;dbl&gt;, …</code></pre>
<p>Notice that we still have all of those people’s responses to each question on the NHANES survey. That means we can get a <em>summary statistic</em> for the <code>Marijuana</code> variable from this sample, just like we did from the population.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-49" class="exercise"><strong>Exercise 7.6  </strong></span>Based on the code we used above to find the “true” proportion in the population, get the point estimate based on the sample of 5 people you just drew (<code>sample_size5</code>).</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="lab7.html#cb228-1" aria-hidden="true" tabindex="-1"></a>___ <span class="sc">%&gt;%</span></span>
<span id="cb228-2"><a href="lab7.html#cb228-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">p_hat =</span> ___)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>What is the proportion of people who tried marijuana in your sample?</li>
<li>Would you expect to get the same proportion from another random sample from the population? Why or why not?</li>
</ol>
</div>
<p>As we’ve seen, the great thing about computers is that they can do boring repetitive things for us very quickly. Now, we will draw 1000 samples of size 5 from the population and get R to remember them under the name <code>samples_size5</code>.</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samples_size5</span> <span class="op">&lt;-</span> <span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="va">samples_size5</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 5,000 × 77
## # Groups:   replicate [1,000]
##    replicate    ID SurveyYr Gender   Age AgeDecade AgeMonths Race1   Race3
##        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;
##  1         1 54148 2009_10  male      34 30-39           418 Mexican &lt;NA&gt; 
##  2         1 60229 2009_10  male      50 50-59           605 Mexican &lt;NA&gt; 
##  3         1 68152 2011_12  male      56 50-59            NA Black   Black
##  4         1 57109 2009_10  female    41 40-49           500 Other   &lt;NA&gt; 
##  5         1 71164 2011_12  male      48 40-49            NA White   White
##  6         2 57175 2009_10  male      49 40-49           590 White   &lt;NA&gt; 
##  7         2 69456 2011_12  male      52 50-59            NA Black   Black
##  8         2 66289 2011_12  male      41 40-49            NA White   White
##  9         2 59541 2009_10  male      49 40-49           593 White   &lt;NA&gt; 
## 10         2 67261 2011_12  male      57 50-59            NA White   White
## # … with 4,990 more rows, and 68 more variables: Education &lt;chr&gt;,
## #   MaritalStatus &lt;chr&gt;, HHIncome &lt;chr&gt;, HHIncomeMid &lt;dbl&gt;, Poverty &lt;dbl&gt;,
## #   HomeRooms &lt;dbl&gt;, HomeOwn &lt;chr&gt;, Work &lt;chr&gt;, Weight &lt;dbl&gt;, Length &lt;lgl&gt;,
## #   HeadCirc &lt;lgl&gt;, Height &lt;dbl&gt;, BMI &lt;dbl&gt;, BMICatUnder20yrs &lt;chr&gt;,
## #   BMI_WHO &lt;chr&gt;, Pulse &lt;dbl&gt;, BPSysAve &lt;dbl&gt;, BPDiaAve &lt;dbl&gt;, BPSys1 &lt;dbl&gt;,
## #   BPDia1 &lt;dbl&gt;, BPSys2 &lt;dbl&gt;, BPDia2 &lt;dbl&gt;, BPSys3 &lt;dbl&gt;, BPDia3 &lt;dbl&gt;,
## #   Testosterone &lt;dbl&gt;, DirectChol &lt;dbl&gt;, TotChol &lt;dbl&gt;, UrineVol1 &lt;dbl&gt;, …</code></pre>
</div>
<div id="summary-statistics-for-each-sample" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> Summary statistics for each sample<a class="anchor" aria-label="anchor" href="#summary-statistics-for-each-sample"><i class="fas fa-link"></i></a>
</h3>
<p>Notice that the different samples are labeled using the variable <code>replicate</code>. We can use this to get the proportion of marijuana triers in each sample using the old <code>group_by</code> routine. We will tell R to remember these sample proportions under the name <code>sample_props_mari_size5</code>:</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_props_mari_size5</span> <span class="op">&lt;-</span> <span class="va">samples_size5</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>p_hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Marijuana</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span>

<span class="va">sample_props_mari_size5</span></code></pre></div>
<pre class="Rout text-muted"><code>## # A tibble: 1,000 × 2
##    replicate p_hat
##        &lt;int&gt; &lt;dbl&gt;
##  1         1   0  
##  2         2   0.8
##  3         3   0.6
##  4         4   0.8
##  5         5   0.4
##  6         6   0.8
##  7         7   0.4
##  8         8   0.8
##  9         9   1  
## 10        10   0.6
## # … with 990 more rows</code></pre>
<p>Notice that the proportions calculated from each sample will tend to vary. We can visualize this using a histogram:</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_props_mari_size5</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-normal_distribution_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
</div>
<div id="approximating-with-a-normal-distribution" class="section level3" number="7.4.4">
<h3>
<span class="header-section-number">7.4.4</span> Approximating with a normal distribution<a class="anchor" aria-label="anchor" href="#approximating-with-a-normal-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, to see whether we can approximate this sampling distribution with a normal distribution, we need to find the <em>mean</em> and <em>standard deviation</em> of the sampling distribution. Recall, that the standard deviation of a sampling distribution has a special name: the <strong>standard error (SE)</strong>.</p>
<p>We will tell R to remember this numbers under the names <code>mean_props_mari_size5</code> and <code>se_props_mari_size5</code>:</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mean_props_mari_size5</span> <span class="op">&lt;-</span> <span class="va">sample_props_mari_size5</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span>

<span class="va">se_props_mari_size5</span> <span class="op">&lt;-</span> <span class="va">sample_props_mari_size5</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Now we will draw the normal curve on top of the histogram we made earlier:</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_props_mari_size5</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean_props_mari_size5</span>, sd <span class="op">=</span> <span class="va">se_props_mari_size5</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'darkred'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-normal_distribution_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<p>Not bad!</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-50" class="exercise"><strong>Exercise 7.7  </strong></span>Use the <code>qnorm</code> function to help you find the 95% confidence interval for the proportion of marijuana triers based on samples of size 5.</p>
<p>It may help to start from the “skeleton” below, which will put the lower and upper boundaries of the confidence interval under the labels <code>ci_lower</code> and <code>ci_upper</code> respectively.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="lab7.html#cb236-1" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> ___, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___, <span class="at">lower.tail =</span> ___)</span>
<span id="cb236-2"><a href="lab7.html#cb236-2" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> ___, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___, <span class="at">lower.tail =</span> ___)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>What is the 95% confidence interval, according to the normal distribution?</li>
<li>Is there anything strange about this interval, given that it is meant to describe plausible values for a <em>proportion</em>? What does this suggest about whether or not the normal distribution is a good approximation to this particular sampling distribution?</li>
</ol>
</div>
</div>
<div id="a-larger-sample" class="section level3" number="7.4.5">
<h3>
<span class="header-section-number">7.4.5</span> A larger sample<a class="anchor" aria-label="anchor" href="#a-larger-sample"><i class="fas fa-link"></i></a>
</h3>
<p>The following chunk of code re-does everything we just did, but now with a sample size of 80 instead of 5:</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">samples_size80</span> <span class="op">&lt;-</span> <span class="va">nhanes</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">80</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="va">sample_props_mari_size80</span> <span class="op">&lt;-</span> <span class="va">samples_size80</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>p_hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Marijuana</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span>

<span class="va">mean_props_mari_size80</span> <span class="op">&lt;-</span> <span class="va">sample_props_mari_size80</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span>

<span class="va">se_props_mari_size80</span> <span class="op">&lt;-</span> <span class="va">sample_props_mari_size80</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pull</span><span class="op">(</span><span class="op">)</span>

<span class="va">sample_props_mari_size80</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.0125</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean_props_mari_size80</span>, sd <span class="op">=</span> <span class="va">se_props_mari_size80</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'darkred'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-normal_distribution_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-51" class="exercise"><strong>Exercise 7.8  </strong></span>–</p>
<ol style="list-style-type: lower-alpha">
<li>Does the normal distribution provide a good “fit” to the sampling distribution for samples of size 80?</li>
<li>What is the 95% confidence interval based on a sample size of 80, according to the normal distribution? (<em>Hint:</em> see the previous exercise.)</li>
<li>Compare the standard error when samples were size 5 (<code>se_props_mari_size5</code>) to when samples were size 80 (<code>se_props_mari_size80</code>). How does the standard error change with sample size?</li>
<li>Compare the mean of the sampling distributions for samples of size 5 (<code>mean_props_mari_size5</code>) and samples of size 80 (<code>mean_props_mari_size80</code>). Does the mean change much with sample size? How close are these means to the “true” proportion in the population that we found earlier?</li>
<li>Based on the relationships between the mean of a sampling distribution, the standard error, and sample size, conjecture a reason why we might call the standard deviation of a sampling distribution a “standard error.” (<em>Hint:</em> consider that we are typically trying to use a sample statistic as an imperfect estimate of a population parameter.)</li>
</ol>
</div>
</div>
</div>
<div id="wrap-up-6" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-6"><i class="fas fa-link"></i></a>
</h2>
<p>In this session, we saw how we can use the normal distribution as a model of either a population distribution or a sampling distribution. Sometimes the normal distribution fits well, and sometimes it does not, and it is important for us to check whether it provides a reasonable approximation or not. We saw how to use the normal distribution to find intervals and proportions. When using the normal distribution to model a sampling distribution, its standard deviation (spread) is called the “standard error” and has a close relationship with sample size.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab6.html"><span class="header-section-number">6</span> Confidence intervals with bootstrapping</a></div>
<div class="next"><a href="lab8.html"><span class="header-section-number">8</span> Inference for proportions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab7"><span class="header-section-number">7</span> The normal distribution</a></li>
<li><a class="nav-link" href="#required-packages-tidyverse-and-infer"><span class="header-section-number">7.1</span> Required packages: tidyverse and infer</a></li>
<li><a class="nav-link" href="#the-data-national-health-and-nutrition-examination-surveys-nhanes"><span class="header-section-number">7.2</span> The data: National Health and Nutrition Examination Surveys (NHANES)</a></li>
<li>
<a class="nav-link" href="#the-normal-distribution-as-a-model-for-a-population-distribution"><span class="header-section-number">7.3</span> The normal distribution as a model for a population distribution</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#hours-of-sleep-sleephrsnight"><span class="header-section-number">7.3.1</span> Hours of Sleep (SleepHrsNight)</a></li>
<li><a class="nav-link" href="#bad-days-daysmenthlthbad"><span class="header-section-number">7.3.2</span> Bad Days (DaysMentHlthBad)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#the-normal-distribution-as-a-model-for-a-sampling-distribution"><span class="header-section-number">7.4</span> The normal distribution as a model for a sampling distribution</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-true-proportion"><span class="header-section-number">7.4.1</span> The “true” proportion</a></li>
<li><a class="nav-link" href="#simulating-many-samples"><span class="header-section-number">7.4.2</span> Simulating many samples</a></li>
<li><a class="nav-link" href="#summary-statistics-for-each-sample"><span class="header-section-number">7.4.3</span> Summary statistics for each sample</a></li>
<li><a class="nav-link" href="#approximating-with-a-normal-distribution"><span class="header-section-number">7.4.4</span> Approximating with a normal distribution</a></li>
<li><a class="nav-link" href="#a-larger-sample"><span class="header-section-number">7.4.5</span> A larger sample</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-6"><span class="header-section-number">7.5</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/07-normal_distribution.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/07-normal_distribution.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-10-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
