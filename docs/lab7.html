<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 7 Confidence intervals and hypothesis testing | Labs</title>
  <meta name="description" content="Laboratory exercises for APSY210." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 7 Confidence intervals and hypothesis testing | Labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Laboratory exercises for APSY210." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 7 Confidence intervals and hypothesis testing | Labs" />
  
  <meta name="twitter:description" content="Laboratory exercises for APSY210." />
  

<meta name="author" content="Greg Cox" />


<meta name="date" content="2021-04-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab6.html"/>
<link rel="next" href="lab8.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Labs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>1</b> Exploring Data with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lab1.html"><a href="lab1.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="lab1.html"><a href="lab1.html#meet-your-data"><i class="fa fa-check"></i><b>1.2</b> Meet your data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lab1.html"><a href="lab1.html#check-out-the-variables"><i class="fa fa-check"></i><b>1.2.1</b> Check out the variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab1.html"><a href="lab1.html#answering-questions-with-data"><i class="fa fa-check"></i><b>1.3</b> Answering questions with data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="lab1.html"><a href="lab1.html#frequency-tables"><i class="fa fa-check"></i><b>1.3.1</b> Frequency tables</a></li>
<li class="chapter" data-level="1.3.2" data-path="lab1.html"><a href="lab1.html#bar-charts"><i class="fa fa-check"></i><b>1.3.2</b> Bar charts</a></li>
<li class="chapter" data-level="1.3.3" data-path="lab1.html"><a href="lab1.html#histograms"><i class="fa fa-check"></i><b>1.3.3</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="lab1.html"><a href="lab1.html#wrap-up"><i class="fa fa-check"></i><b>1.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab2.html"><a href="lab2.html"><i class="fa fa-check"></i><b>2</b> Central tendency and variability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lab2.html"><a href="lab2.html#simple-cases"><i class="fa fa-check"></i><b>2.1</b> Simple cases</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lab2.html"><a href="lab2.html#central-tendency"><i class="fa fa-check"></i><b>2.1.1</b> Central tendency</a></li>
<li class="chapter" data-level="2.1.2" data-path="lab2.html"><a href="lab2.html#variability"><i class="fa fa-check"></i><b>2.1.2</b> Variability</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lab2.html"><a href="lab2.html#dealing-with-real-data"><i class="fa fa-check"></i><b>2.2</b> Dealing with real data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lab2.html"><a href="lab2.html#setting-the-stage"><i class="fa fa-check"></i><b>2.2.1</b> Setting the stage</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab2.html"><a href="lab2.html#getting-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Getting the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="lab2.html"><a href="lab2.html#visualizing-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Visualizing the data</a></li>
<li class="chapter" data-level="2.2.4" data-path="lab2.html"><a href="lab2.html#central-tendency-1"><i class="fa fa-check"></i><b>2.2.4</b> Central tendency</a></li>
<li class="chapter" data-level="2.2.5" data-path="lab2.html"><a href="lab2.html#variability-1"><i class="fa fa-check"></i><b>2.2.5</b> Variability</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab2.html"><a href="lab2.html#wrap-up-1"><i class="fa fa-check"></i><b>2.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lab3.html"><a href="lab3.html"><i class="fa fa-check"></i><b>3</b> Scatterplots and correlation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lab3.html"><a href="lab3.html#calculating-the-pearson-correlation-coefficient"><i class="fa fa-check"></i><b>3.1</b> Calculating the Pearson correlation coefficient</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lab3.html"><a href="lab3.html#from-x-to-z"><i class="fa fa-check"></i><b>3.1.1</b> From <span class="math inline">\(X\)</span> to <span class="math inline">\(z\)</span></a></li>
<li class="chapter" data-level="3.1.2" data-path="lab3.html"><a href="lab3.html#finding-the-correlation-coefficient"><i class="fa fa-check"></i><b>3.1.2</b> Finding the correlation coefficient</a></li>
<li class="chapter" data-level="3.1.3" data-path="lab3.html"><a href="lab3.html#dealing-with-real-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Dealing with real data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lab3.html"><a href="lab3.html#scatterplots"><i class="fa fa-check"></i><b>3.2</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lab3.html"><a href="lab3.html#making-a-group-of-scatterplots"><i class="fa fa-check"></i><b>3.2.1</b> Making a group of scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lab3.html"><a href="lab3.html#some-bigger-data"><i class="fa fa-check"></i><b>3.3</b> Some bigger data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lab3.html"><a href="lab3.html#import-the-data"><i class="fa fa-check"></i><b>3.3.1</b> Import the data</a></li>
<li class="chapter" data-level="3.3.2" data-path="lab3.html"><a href="lab3.html#experience-and-memory-for-barbies"><i class="fa fa-check"></i><b>3.3.2</b> Experience and memory for Barbies</a></li>
<li class="chapter" data-level="3.3.3" data-path="lab3.html"><a href="lab3.html#experience-and-memory-for-transformers"><i class="fa fa-check"></i><b>3.3.3</b> Experience and memory for Transformers</a></li>
<li class="chapter" data-level="3.3.4" data-path="lab3.html"><a href="lab3.html#experience-with-barbies-and-memory-for-transformers"><i class="fa fa-check"></i><b>3.3.4</b> Experience with Barbies and memory for Transformers</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lab3.html"><a href="lab3.html#wrap-up-2"><i class="fa fa-check"></i><b>3.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab4.html"><a href="lab4.html"><i class="fa fa-check"></i><b>4</b> Probability and simulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab4.html"><a href="lab4.html#simulation-basics"><i class="fa fa-check"></i><b>4.1</b> Simulation basics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lab4.html"><a href="lab4.html#single-coin-flips"><i class="fa fa-check"></i><b>4.1.1</b> Single coin flips</a></li>
<li class="chapter" data-level="4.1.2" data-path="lab4.html"><a href="lab4.html#a-sequence-of-coin-flips"><i class="fa fa-check"></i><b>4.1.2</b> A sequence of coin flips</a></li>
<li class="chapter" data-level="4.1.3" data-path="lab4.html"><a href="lab4.html#remembering-simulated-results"><i class="fa fa-check"></i><b>4.1.3</b> Remembering simulated results</a></li>
<li class="chapter" data-level="4.1.4" data-path="lab4.html"><a href="lab4.html#turning-simulated-results-into-data"><i class="fa fa-check"></i><b>4.1.4</b> Turning simulated results into “data”</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lab4.html"><a href="lab4.html#estimating-probabilities"><i class="fa fa-check"></i><b>4.2</b> Estimating probabilities</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lab4.html"><a href="lab4.html#frequency-table"><i class="fa fa-check"></i><b>4.2.1</b> Frequency table</a></li>
<li class="chapter" data-level="4.2.2" data-path="lab4.html"><a href="lab4.html#estimating-probability-from-frequency"><i class="fa fa-check"></i><b>4.2.2</b> Estimating probability from frequency</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lab4.html"><a href="lab4.html#more-advanced-simulation-tricks"><i class="fa fa-check"></i><b>4.3</b> More advanced simulation tricks</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lab4.html"><a href="lab4.html#making-up-our-own-probabilities"><i class="fa fa-check"></i><b>4.3.1</b> Making up our own probabilities</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab4.html"><a href="lab4.html#expanding-the-sample-space"><i class="fa fa-check"></i><b>4.3.2</b> Expanding the sample space</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lab4.html"><a href="lab4.html#estimating-probabilities-in-data"><i class="fa fa-check"></i><b>4.4</b> Estimating probabilities in data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lab4.html"><a href="lab4.html#what-was-kobes-hit-rate"><i class="fa fa-check"></i><b>4.4.1</b> What was Kobe’s hit rate?</a></li>
<li class="chapter" data-level="4.4.2" data-path="lab4.html"><a href="lab4.html#a-simulated-kobe"><i class="fa fa-check"></i><b>4.4.2</b> A simulated Kobe</a></li>
<li class="chapter" data-level="4.4.3" data-path="lab4.html"><a href="lab4.html#hot--or-cold-handed"><i class="fa fa-check"></i><b>4.4.3</b> Hot- or cold-handed</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lab4.html"><a href="lab4.html#wrap-up-3"><i class="fa fa-check"></i><b>4.5</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab5.html"><a href="lab5.html"><i class="fa fa-check"></i><b>5</b> Models: The Binomial and the Normal</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lab5.html"><a href="lab5.html#the-binomial-distribution-in-r"><i class="fa fa-check"></i><b>5.1</b> The binomial distribution in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lab5.html"><a href="lab5.html#translating-from-sample-to-rbinom"><i class="fa fa-check"></i><b>5.1.1</b> Translating from <code>sample</code> to <code>rbinom</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="lab5.html"><a href="lab5.html#outcomes-from-different-sequences-of-events"><i class="fa fa-check"></i><b>5.1.2</b> Outcomes from different sequences of events</a></li>
<li class="chapter" data-level="5.1.3" data-path="lab5.html"><a href="lab5.html#simulated-relative-frequencies-and-probabilities"><i class="fa fa-check"></i><b>5.1.3</b> Simulated relative frequencies and probabilities</a></li>
<li class="chapter" data-level="5.1.4" data-path="lab5.html"><a href="lab5.html#calculating-binomial-probabilities-directly"><i class="fa fa-check"></i><b>5.1.4</b> Calculating binomial probabilities directly</a></li>
<li class="chapter" data-level="5.1.5" data-path="lab5.html"><a href="lab5.html#cumulative-probabilities-with-the-binomial"><i class="fa fa-check"></i><b>5.1.5</b> Cumulative probabilities with the binomial</a></li>
<li class="chapter" data-level="5.1.6" data-path="lab5.html"><a href="lab5.html#summary-of-rs-built-in-binomial-distribution"><i class="fa fa-check"></i><b>5.1.6</b> Summary of R’s built-in binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lab5.html"><a href="lab5.html#the-normal-distribution-in-r"><i class="fa fa-check"></i><b>5.2</b> The normal distribution in R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lab5.html"><a href="lab5.html#simulating-outcomes-from-a-normal-distribution"><i class="fa fa-check"></i><b>5.2.1</b> Simulating outcomes from a normal distribution</a></li>
<li class="chapter" data-level="5.2.2" data-path="lab5.html"><a href="lab5.html#the-mean-and-standard-deviation"><i class="fa fa-check"></i><b>5.2.2</b> The mean and standard deviation</a></li>
<li class="chapter" data-level="5.2.3" data-path="lab5.html"><a href="lab5.html#calculating-probabilities-with-the-normal-distribution"><i class="fa fa-check"></i><b>5.2.3</b> Calculating probabilities with the normal distribution</a></li>
<li class="chapter" data-level="5.2.4" data-path="lab5.html"><a href="lab5.html#finding-quantiles-with-the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> Finding “quantiles” with the normal distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="lab5.html"><a href="lab5.html#summary-of-rs-built-in-normal-distribution"><i class="fa fa-check"></i><b>5.2.5</b> Summary of R’s built-in normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lab5.html"><a href="lab5.html#wrap-up-4"><i class="fa fa-check"></i><b>5.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab6.html"><a href="lab6.html"><i class="fa fa-check"></i><b>6</b> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lab6.html"><a href="lab6.html#before-we-begin"><i class="fa fa-check"></i><b>6.1</b> Before we begin…</a></li>
<li class="chapter" data-level="6.2" data-path="lab6.html"><a href="lab6.html#heights"><i class="fa fa-check"></i><b>6.2</b> Heights</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lab6.html"><a href="lab6.html#a-simulated-population"><i class="fa fa-check"></i><b>6.2.1</b> A simulated population</a></li>
<li class="chapter" data-level="6.2.2" data-path="lab6.html"><a href="lab6.html#a-sample-from-our-simulated-population"><i class="fa fa-check"></i><b>6.2.2</b> A sample from our simulated population</a></li>
<li class="chapter" data-level="6.2.3" data-path="lab6.html"><a href="lab6.html#many-samples-from-our-simulated-population"><i class="fa fa-check"></i><b>6.2.3</b> Many samples from our simulated population</a></li>
<li class="chapter" data-level="6.2.4" data-path="lab6.html"><a href="lab6.html#many-larger-samples"><i class="fa fa-check"></i><b>6.2.4</b> Many larger samples</a></li>
<li class="chapter" data-level="6.2.5" data-path="lab6.html"><a href="lab6.html#the-probability-of-being-wrong"><i class="fa fa-check"></i><b>6.2.5</b> The probability of being wrong</a></li>
<li class="chapter" data-level="6.2.6" data-path="lab6.html"><a href="lab6.html#biased-samples"><i class="fa fa-check"></i><b>6.2.6</b> Biased samples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lab6.html"><a href="lab6.html#the-wisdom-of-the-crowd"><i class="fa fa-check"></i><b>6.3</b> The Wisdom of the Crowd</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="lab6.html"><a href="lab6.html#grab-the-data"><i class="fa fa-check"></i><b>6.3.1</b> Grab the data</a></li>
<li class="chapter" data-level="6.3.2" data-path="lab6.html"><a href="lab6.html#make-a-histogram"><i class="fa fa-check"></i><b>6.3.2</b> Make a histogram</a></li>
<li class="chapter" data-level="6.3.3" data-path="lab6.html"><a href="lab6.html#what-is-the-right-answer"><i class="fa fa-check"></i><b>6.3.3</b> What is the right answer?</a></li>
<li class="chapter" data-level="6.3.4" data-path="lab6.html"><a href="lab6.html#what-about-the-average"><i class="fa fa-check"></i><b>6.3.4</b> What about the average?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lab6.html"><a href="lab6.html#wrap-up-5"><i class="fa fa-check"></i><b>6.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lab7.html"><a href="lab7.html"><i class="fa fa-check"></i><b>7</b> Confidence intervals and hypothesis testing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lab7.html"><a href="lab7.html#be-still-my-artificial-heart"><i class="fa fa-check"></i><b>7.1</b> Be still, my (artificial) heart</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="lab7.html"><a href="lab7.html#constructing-confidence-intervals"><i class="fa fa-check"></i><b>7.1.1</b> Constructing confidence intervals</a></li>
<li class="chapter" data-level="7.1.2" data-path="lab7.html"><a href="lab7.html#compare-our-sample-to-the-confidence-interval"><i class="fa fa-check"></i><b>7.1.2</b> Compare our sample to the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="lab7.html"><a href="lab7.html#lay-your-weary-head-to-rest"><i class="fa fa-check"></i><b>7.2</b> Lay your weary head to rest</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="lab7.html"><a href="lab7.html#figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true-1"><i class="fa fa-check"></i><b>7.2.1</b> Figure out what parameters would describe the population <em>if</em> the hypothesis were true</a></li>
<li class="chapter" data-level="7.2.2" data-path="lab7.html"><a href="lab7.html#decide-how-wide-to-make-our-confidence-interval-1"><i class="fa fa-check"></i><b>7.2.2</b> Decide how wide to make our confidence interval</a></li>
<li class="chapter" data-level="7.2.3" data-path="lab7.html"><a href="lab7.html#figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval-1"><i class="fa fa-check"></i><b>7.2.3</b> Figure out the upper and lower boundaries of the confidence interval</a></li>
<li class="chapter" data-level="7.2.4" data-path="lab7.html"><a href="lab7.html#compare-our-sample-to-the-confidence-interval-1"><i class="fa fa-check"></i><b>7.2.4</b> Compare our sample to the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="lab7.html"><a href="lab7.html#wrap-up-6"><i class="fa fa-check"></i><b>7.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lab8.html"><a href="lab8.html"><i class="fa fa-check"></i><b>8</b> Statistical Power</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lab8.html"><a href="lab8.html#the-power-of-positive-feedback"><i class="fa fa-check"></i><b>8.1</b> The Power of Positive Feedback</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="lab8.html"><a href="lab8.html#look-at-the-data"><i class="fa fa-check"></i><b>8.1.1</b> Look at the data</a></li>
<li class="chapter" data-level="8.1.2" data-path="lab8.html"><a href="lab8.html#specifying-our-null-hypothesis"><i class="fa fa-check"></i><b>8.1.2</b> Specifying our null hypothesis</a></li>
<li class="chapter" data-level="8.1.3" data-path="lab8.html"><a href="lab8.html#building-our-confidence-interval"><i class="fa fa-check"></i><b>8.1.3</b> Building our confidence interval</a></li>
<li class="chapter" data-level="8.1.4" data-path="lab8.html"><a href="lab8.html#visualizing-the-distribution-of-sample-means"><i class="fa fa-check"></i><b>8.1.4</b> Visualizing the distribution of sample means</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="lab8.html"><a href="lab8.html#achieving-a-target-level-of-power"><i class="fa fa-check"></i><b>8.2</b> Achieving a target level of power</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="lab8.html"><a href="lab8.html#effect-size"><i class="fa fa-check"></i><b>8.2.1</b> Effect size</a></li>
<li class="chapter" data-level="8.2.2" data-path="lab8.html"><a href="lab8.html#sample-size"><i class="fa fa-check"></i><b>8.2.2</b> Sample size</a></li>
<li class="chapter" data-level="8.2.3" data-path="lab8.html"><a href="lab8.html#alpha-level"><i class="fa fa-check"></i><b>8.2.3</b> Alpha level</a></li>
<li class="chapter" data-level="8.2.4" data-path="lab8.html"><a href="lab8.html#population-standard-deviation"><i class="fa fa-check"></i><b>8.2.4</b> Population standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lab8.html"><a href="lab8.html#using-data-to-test-the-null-hypothesis"><i class="fa fa-check"></i><b>8.3</b> Using data to test the null hypothesis</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="lab8.html"><a href="lab8.html#confidence-interval-limits"><i class="fa fa-check"></i><b>8.3.1</b> Confidence interval limits</a></li>
<li class="chapter" data-level="8.3.2" data-path="lab8.html"><a href="lab8.html#the-p-value"><i class="fa fa-check"></i><b>8.3.2</b> The <span class="math inline">\(p\)</span> value</a></li>
<li class="chapter" data-level="8.3.3" data-path="lab8.html"><a href="lab8.html#estimated-power"><i class="fa fa-check"></i><b>8.3.3</b> Estimated power</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="lab8.html"><a href="lab8.html#wrap-up-7"><i class="fa fa-check"></i><b>8.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lab9.html"><a href="lab9.html"><i class="fa fa-check"></i><b>9</b> <span class="math inline">\(t\)</span> tests</a>
<ul>
<li class="chapter" data-level="9.1" data-path="lab9.html"><a href="lab9.html#t-tests-on-tiny-data"><i class="fa fa-check"></i><b>9.1</b> <span class="math inline">\(t\)</span> tests on tiny data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="lab9.html"><a href="lab9.html#one-sample-t-test"><i class="fa fa-check"></i><b>9.1.1</b> One-sample <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="9.1.2" data-path="lab9.html"><a href="lab9.html#paired-sample-t-test"><i class="fa fa-check"></i><b>9.1.2</b> Paired sample <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="9.1.3" data-path="lab9.html"><a href="lab9.html#independent-samples-t-test"><i class="fa fa-check"></i><b>9.1.3</b> Independent samples <span class="math inline">\(t\)</span> test</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="lab9.html"><a href="lab9.html#t-tests-with-real-data"><i class="fa fa-check"></i><b>9.2</b> <span class="math inline">\(t\)</span> tests with real data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="lab9.html"><a href="lab9.html#check-out-the-data"><i class="fa fa-check"></i><b>9.2.1</b> Check out the data</a></li>
<li class="chapter" data-level="9.2.2" data-path="lab9.html"><a href="lab9.html#did-infants-show-any-prior-bias"><i class="fa fa-check"></i><b>9.2.2</b> Did infants show any prior bias?</a></li>
<li class="chapter" data-level="9.2.3" data-path="lab9.html"><a href="lab9.html#do-infants-prefer-to-look-at-the-singer-of-the-familiar-melody"><i class="fa fa-check"></i><b>9.2.3</b> Do infants prefer to look at the singer of the familiar melody?</a></li>
<li class="chapter" data-level="9.2.4" data-path="lab9.html"><a href="lab9.html#did-their-preferences-change"><i class="fa fa-check"></i><b>9.2.4</b> Did their preferences change?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="lab9.html"><a href="lab9.html#wrap-up-8"><i class="fa fa-check"></i><b>9.3</b> Wrap-up</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="coderef.html"><a href="coderef.html"><i class="fa fa-check"></i><b>A</b> R Code Reference</a>
<ul>
<li class="chapter" data-level="A.1" data-path="coderef.html"><a href="coderef.html#binomial-distribution"><i class="fa fa-check"></i><b>A.1</b> Binomial distribution</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="coderef.html"><a href="coderef.html#probability-of-observing-an-outcome-exactly-equal-to-a-given-value"><i class="fa fa-check"></i><b>A.1.1</b> Probability of observing an outcome exactly equal to a given value</a></li>
<li class="chapter" data-level="A.1.2" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-less-than-or-equal-to-a-given-value"><i class="fa fa-check"></i><b>A.1.2</b> Probability of observing a value less than or equal to a given value</a></li>
<li class="chapter" data-level="A.1.3" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-greater-than-a-given-value"><i class="fa fa-check"></i><b>A.1.3</b> Probability of observing a value greater than a given value</a></li>
<li class="chapter" data-level="A.1.4" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-inside-an-interval-between-an-upper-and-lower-value"><i class="fa fa-check"></i><b>A.1.4</b> Probability of observing a value inside an interval between an upper and lower value</a></li>
<li class="chapter" data-level="A.1.5" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-outside-an-interval-between-an-upper-and-lower-value"><i class="fa fa-check"></i><b>A.1.5</b> Probability of observing a value outside an interval between an upper and lower value</a></li>
<li class="chapter" data-level="A.1.6" data-path="coderef.html"><a href="coderef.html#the-value-for-which-there-is-a-given-probability-of-observing-an-outcome-less-than-or-equal-to-that-value"><i class="fa fa-check"></i><b>A.1.6</b> The value for which there is a given probability of observing an outcome less than or equal to that value</a></li>
<li class="chapter" data-level="A.1.7" data-path="coderef.html"><a href="coderef.html#testing-a-null-hypothesis"><i class="fa fa-check"></i><b>A.1.7</b> Testing a null hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="coderef.html"><a href="coderef.html#normal-distribution"><i class="fa fa-check"></i><b>A.2</b> Normal distribution</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-less-than-or-equal-to-a-given-value-1"><i class="fa fa-check"></i><b>A.2.1</b> Probability of observing a value less than or equal to a given value</a></li>
<li class="chapter" data-level="A.2.2" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-greater-than-a-given-value-1"><i class="fa fa-check"></i><b>A.2.2</b> Probability of observing a value greater than a given value</a></li>
<li class="chapter" data-level="A.2.3" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-inside-an-interval-between-an-upper-and-lower-value-1"><i class="fa fa-check"></i><b>A.2.3</b> Probability of observing a value inside an interval between an upper and lower value</a></li>
<li class="chapter" data-level="A.2.4" data-path="coderef.html"><a href="coderef.html#probability-of-observing-a-value-outside-an-interval-between-an-upper-and-lower-value-1"><i class="fa fa-check"></i><b>A.2.4</b> Probability of observing a value outside an interval between an upper and lower value</a></li>
<li class="chapter" data-level="A.2.5" data-path="coderef.html"><a href="coderef.html#the-value-for-which-there-is-a-given-probability-of-observing-an-outcome-less-than-or-equal-to-that-value-1"><i class="fa fa-check"></i><b>A.2.5</b> The value for which there is a given probability of observing an outcome less than or equal to that value</a></li>
<li class="chapter" data-level="A.2.6" data-path="coderef.html"><a href="coderef.html#testing-a-null-hypothesis-1"><i class="fa fa-check"></i><b>A.2.6</b> Testing a null hypothesis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Labs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab7" class="section level1" number="7">
<h1><span class="header-section-number">Lab 7</span> Confidence intervals and hypothesis testing</h1>
<p><img src="img/heart_clock.jpg" width="100%" /></p>
<p>As we’ve seen, one of the remarkable fruits of the “central limit theorem” is the <strong>confidence interval</strong>. This interval tells us where sample means are likely to be, assuming</p>
<ol style="list-style-type: decimal">
<li>Samples are selected from the population using simple random sampling; and</li>
<li>That we either know or hypothesize the parameters of the population we are sampling from.</li>
</ol>
<p>We explored the consequences of sampling last time. Today, we will see more about how to find confidence intervals in R and use them to test <strong>hypotheses</strong>. Specifically, we will use confidence intervals to test “null” hypotheses. As we’ve seen, there are four basic steps to testing a hypothesis using a confidence interval.</p>
<ol style="list-style-type: decimal">
<li>Figure out what parameters would describe the population <em>if</em> the hypothesis were true.</li>
<li>Decide how wide to make our confidence interval.</li>
<li>Figure out the upper and lower boundaries of the confidence interval.</li>
<li>Compare our sample to the confidence interval and, if it is outside the interval, <em>reject</em> our original hypothesis.</li>
</ol>
<p>In the first part of the session, we will do hypothesis tests with simulated data where we know whether the null hypothesis is true or not. In the second part of the session, we will do a hypothesis test on real data and see what we can learn about the population from which it was sampled.</p>
<p>Before we begin, make sure you’ve got the “tidyverse” package loaded from R’s library.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="lab7.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.5     ✓ dplyr   1.0.3
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="be-still-my-artificial-heart" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Be still, my (artificial) heart</h2>
<p>The resting heart rate within the typical US adult population has a mean of <span class="math inline">\(\mu = 71\)</span> beats-per-minute with a standard deviation of <span class="math inline">\(\sigma = 9\)</span> beats-per-minute. We all know that sudden excitement or shock tends to increase our heart rate, but interestingly, the effect of chronic stress on heart rate is not well established. There is evidence for both a <em>higher</em> resting heart rate due to sustained minor stress, as well as a <em>lower</em> resting heart rate due to frequent major stressful life events. In any case, it is clear that detecting abnormal heart rate can be important not just for physiological health, but psychological health as well.</p>
<p>In this part of the session, we will simulate different samples of individuals with different resting heart rates and test the hypothesis that these individuals come from a population with the same heart rate parameters as the typical US adult population. We will follow the steps above to construct a confidence interval (steps 1–3), then compare our simulated sample against it (step 4).</p>
<div id="constructing-confidence-intervals" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Constructing confidence intervals</h3>
<p>Before we can even get to step 1, we need to be clear what our hypothesis is that we are testing. Our <em>research</em> hypothesis is that the sample of individuals comes from a population with a <em>different</em> mean heart rate than the typical US adult. The <strong>statistical hypothesis</strong> that we are testing is the <strong>null</strong> hypothesis.</p>
<blockquote>
<p>The <strong>null hypothesis</strong> is that our sample comes from a population with the <strong>same</strong> mean heart rate as the typical US adult population, with <span class="math inline">\(\mu = 71\)</span>.</p>
</blockquote>
<p>If we can <em>reject</em> this null hypothesis, then we have reason to believe that our sample is meaningfully different from the typical population and we say it is <strong>statistically significant</strong>.</p>
<div id="figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true" class="section level4" number="7.1.1.1">
<h4><span class="header-section-number">7.1.1.1</span> Figure out what parameters would describe the population <em>if</em> the hypothesis were true</h4>
<p>From the description above, we know the population mean (<span class="math inline">\(\mu = 71\)</span>) and standard deviation (<span class="math inline">\(\sigma = 9\)</span>). Let us assume that our sample size is <span class="math inline">\(n = 40\)</span>, which is typical for this kind of research. The central limit theorem tells us that our sample means will, then, have a normal distribution with mean <span class="math inline">\(\mu = 71\)</span> and <strong>standard error of the mean</strong> <span class="math inline">\(\frac{\sigma}{\sqrt{n}} = \frac{9}{\sqrt{40}}\)</span>. We can use R to calculate what the standard error is.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-3" class="exercise"><strong>Exercise 7.1  </strong></span>What R code would give us the standard error of the mean?
</div>
<pre><code>## [1] 1.423025</code></pre>
</div>
<div id="decide-how-wide-to-make-our-confidence-interval" class="section level4" number="7.1.1.2">
<h4><span class="header-section-number">7.1.1.2</span> Decide how wide to make our confidence interval</h4>
<p>Our confidence interval is defined by how unlikely a sample has to be before we are willing to reject the null hypothesis. A standard rule is to say that if a result has probability <span class="math inline">\(0.05\)</span> or less if the null hypothesis were true, then we can <em>reject</em> the null hypothesis. This standard rule corresponds to a “95% confidence interval,” where the “95%” refers to <span class="math inline">\(1 - 0.05 = 0.95\)</span>, which is the probability that we will <em>fail to reject</em> the null hypothesis when it is true.</p>
<p>Let us adopt the standard rule for now and use the 95% confidence interval.</p>
</div>
<div id="figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval" class="section level4" number="7.1.1.3">
<h4><span class="header-section-number">7.1.1.3</span> Figure out the upper and lower boundaries of the confidence interval</h4>
<p>To find the upper and lower boundaries of the confidence interval, we have to divide the <span class="math inline">\(0.05\)</span> probability of being outside the interval between the upper and lower ends of the scale. This means that there is a probability of <span class="math inline">\(\frac{0.05}{2} = 0.025\)</span> of being <em>less than</em> the lower boundary and a probability of <span class="math inline">\(0.025 + 0.95 = 0.975\)</span> of being <em>less than</em> the upper boundary.</p>
<p>The <strong>lower</strong> boundary of the 95% confidence interval is then</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="lab7.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">mean =</span> <span class="dv">71</span>, <span class="at">sd =</span> <span class="dv">9</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>))</span></code></pre></div>
<pre><code>## [1] 68.21092</code></pre>
<p>while the <strong>upper</strong> boundary is</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="lab7.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">71</span>, <span class="at">sd =</span> <span class="dv">9</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>))</span></code></pre></div>
<pre><code>## [1] 73.78908</code></pre>

<div class="exercise">
<span id="exr:unnamed-chunk-7" class="exercise"><strong>Exercise 7.2  </strong></span>Based on the upper and lower boundaries we just found, what is the <em>margin of error</em>?
</div>
</div>
<div id="visualization" class="section level4" number="7.1.1.4">
<h4><span class="header-section-number">7.1.1.4</span> Visualization</h4>
<p>The logic of hypothesis testing can be easier to understand if we visualize the distribution of sample means and the 95% confidence interval. To do that, we will first use the normal distribution to simulate different sample means, then make a colored histogram of those sample means that distinguishes between ones that are inside the confidence interval and ones that are outside the confidence interval.</p>
<p>First, let’s simulate a large number of means of possible samples of size <span class="math inline">\(n = 40\)</span> that we might observe if the null hypothesis were true.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="lab7.html#cb270-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">71</span>, <span class="at">sd =</span> <span class="dv">9</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>))</span></code></pre></div>
<p>Now let’s turn those into “data” so we can use R to make a histogram of these simulated sample means.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="lab7.html#cb271-1" aria-hidden="true" tabindex="-1"></a>sample_means_size40 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(M)</span></code></pre></div>
<p>And finally make the histogram</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="lab7.html#cb272-1" aria-hidden="true" tabindex="-1"></a>sample_means_size40 <span class="sc">%&gt;%</span></span>
<span id="cb272-2"><a href="lab7.html#cb272-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> M)) <span class="sc">+</span></span>
<span id="cb272-3"><a href="lab7.html#cb272-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="07-confidence_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Now we need to color in this histogram depending on whether the sample mean is inside or outside the confidence interval. To do that, let’s tell R to remember the upper and lower boundaries we found earlier</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="lab7.html#cb273-1" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">mean =</span> <span class="dv">71</span>, <span class="at">sd =</span> <span class="dv">9</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>))</span>
<span id="cb273-2"><a href="lab7.html#cb273-2" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">71</span>, <span class="at">sd =</span> <span class="dv">9</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">40</span>))</span></code></pre></div>
<p>That makes it easier to fill the bars with different colors:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="lab7.html#cb274-1" aria-hidden="true" tabindex="-1"></a>sample_means_size40 <span class="sc">%&gt;%</span></span>
<span id="cb274-2"><a href="lab7.html#cb274-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> M, <span class="at">fill =</span> (M <span class="sc">&gt;</span> ci_lower) <span class="sc">&amp;</span> (M <span class="sc">&lt;</span> ci_upper))) <span class="sc">+</span></span>
<span id="cb274-3"><a href="lab7.html#cb274-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="07-confidence_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="compare-our-sample-to-the-confidence-interval" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Compare our sample to the confidence interval</h3>
<p>In this part of our session, we will <em>simulate</em> different samples and compare them to the confidence interval we just found. We will see how different our sample needs to be from the typical population before we consistently reject the null hypothesis.</p>
<div id="when-the-null-hypothesis-is-true" class="section level4" number="7.1.2.1">
<h4><span class="header-section-number">7.1.2.1</span> When the null hypothesis is <em>true</em></h4>
<p>First, let’s imagine that the sample of individuals we get actually does come from a population with the same mean heart rate as typical US adults, i.e. with <span class="math inline">\(\mu = 71\)</span>. We will tell R to remember our sample under the label “heart_rate_sample.”</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="lab7.html#cb275-1" aria-hidden="true" tabindex="-1"></a>heart_rate_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">71</span>, <span class="at">sd =</span> <span class="dv">9</span>)</span></code></pre></div>

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>Exercise 7.3  </strong></span>Compare the code just we used to simulate a sample of heart rates with the code we used to simulate sample means. Why is the mean the same? Why is the standard deviation different?
</div>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="lab7.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(heart_rate_sample)</span></code></pre></div>
<pre><code>## [1] 70.02283</code></pre>
<p>Is the sample mean outside the confidence interval, which would lead us to <em>reject</em> the null hypothesis, even though it is actually true?</p>

<div class="exercise">
<span id="exr:unnamed-chunk-16" class="exercise"><strong>Exercise 7.4  </strong></span>Try running the previous two lines of code a few more times (simulate a new sample and find its mean). How many times did it take before you simulated a sample with a mean that fell <em>outside</em> the 95% confidence interval?
</div>
</div>
<div id="when-the-null-hypothesis-is-false" class="section level4" number="7.1.2.2">
<h4><span class="header-section-number">7.1.2.2</span> When the null hypothesis is <em>false</em></h4>
<p>Now let’s imagine that the sample we get comes from a population that has a higher resting heart rate, on average, than the typical US adult population. Will we correctly reject the null hypothesis?</p>
<p>Let’s say that the mean heart rate in this <em>different</em> population is 74.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="lab7.html#cb278-1" aria-hidden="true" tabindex="-1"></a>heart_rate_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">74</span>, <span class="at">sd =</span> <span class="dv">9</span>)</span></code></pre></div>
<p>How does the mean of this sample compare to the confidence interval we found above?</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="lab7.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(heart_rate_sample)</span></code></pre></div>
<pre><code>## [1] 74.82869</code></pre>

<div class="exercise">
<span id="exr:unnamed-chunk-19" class="exercise"><strong>Exercise 7.5  </strong></span>Run the previous two lines of code 10 times. Out of those ten times, how often did the sample mean fall outside the 95% confidence interval?
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-20" class="exercise"><strong>Exercise 7.6  </strong></span>In the code we just used, we assumed that our samples came from a population with a mean of 74. How much bigger do you think this mean would need to be before almost all samples would fall outside the 95% confidence interval? 75? 76? 100? Why?
</div>
</div>
</div>
</div>
<div id="lay-your-weary-head-to-rest" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Lay your weary head to rest</h2>
<p>Having tested hypotheses using simulated resting heart rate data, let’s see about testing a hypothesis using some real data. These data have to do with a different kind of rest, sleep. These are the number of hours slept in a particular night for a simple random sample of <span class="math inline">\(n = 110\)</span> US college students. We will use hypothesis testing with confidence intervals to <em>infer</em> whether college students tend to sleep the recommended amount per night.</p>
<p>First, let’s make sure to download the data to get it into R</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="lab7.html#cb281-1" aria-hidden="true" tabindex="-1"></a>student_sleep <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/student_sleep.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   hours = col_double()
## )</code></pre>
<p>If you click on the “student_sleep” data in R’s environment pane in the upper right, you’ll see that it is just a single column called “hours,” where each row in the number of hours slept by a different student.</p>
<p>Let’s also make a histogram to get a sense of what the data look like.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="lab7.html#cb283-1" aria-hidden="true" tabindex="-1"></a>student_sleep <span class="sc">%&gt;%</span></span>
<span id="cb283-2"><a href="lab7.html#cb283-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hours)) <span class="sc">+</span></span>
<span id="cb283-3"><a href="lab7.html#cb283-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="07-confidence_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>

<div class="exercise">
<span id="exr:unnamed-chunk-23" class="exercise"><strong>Exercise 7.7  </strong></span>Describe the shape of the distribution of number of hours slept. Does it seem symmetrical, skewed? How many modes does the distribution seem to have?
</div>
<div id="figure-out-what-parameters-would-describe-the-population-if-the-hypothesis-were-true-1" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Figure out what parameters would describe the population <em>if</em> the hypothesis were true</h3>
<p>Our <em>research</em> hypothesis is that college students do <em>not</em> sleep the recommended amount per night. According to the National Sleep Foundation, the recommended distribution of sleep for young adults has a mean of <span class="math inline">\(\mu = 8\)</span> hours and a standard deviation of <span class="math inline">\(\sigma = 1\)</span> hour. As a result, the <strong>null hypothesis</strong> that we are going to test is that the mean number of hours slept by college students is <em>equal to</em> the recommended population mean of <span class="math inline">\(\mu = 8\)</span>.</p>
<p>Notice that we are again using a “hypothetical” population to specify our null hypothesis. This hypothetical population is college students who sleep the recommended amount per night. We are going to see if our sample could plausibly have come from such a population.</p>
</div>
<div id="decide-how-wide-to-make-our-confidence-interval-1" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Decide how wide to make our confidence interval</h3>
<p>Again, we have a choice to make here about how willing we are to make a “Type I error,” that is, to reject the null hypothesis even when it is true. For the sake of argument, let’s say that we want to be very conservative and will try to minimize our risk of making a Type I error. So instead of a 95% confidence interval, let’s make a 99% confidence interval. This means that the probability of making a Type I error is only <span class="math inline">\(0.01\)</span>.</p>
</div>
<div id="figure-out-the-upper-and-lower-boundaries-of-the-confidence-interval-1" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Figure out the upper and lower boundaries of the confidence interval</h3>
<p>We now have all the ingredients we need to make a confidence interval. We have the population mean (<span class="math inline">\(\mu = 8\)</span>), population standard deviation (<span class="math inline">\(\sigma = 1\)</span>), sample size (<span class="math inline">\(n = 110\)</span>), and confidence interval width (99%).</p>
<p>The lower bound of our confidence interval is then</p>
<pre><code>## [1] 7.754404</code></pre>
<p>while the upper boundary is</p>
<pre><code>## [1] 8.245596</code></pre>

<div class="exercise">
<span id="exr:unnamed-chunk-26" class="exercise"><strong>Exercise 7.8  </strong></span>What is the R code for finding those lower and upper boundaries of the 99% confidence interval? <em>Hint: what do you need to change in the code we used for finding the confidence interval boundaries in the heart rate example above?</em>
</div>
</div>
<div id="compare-our-sample-to-the-confidence-interval-1" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Compare our sample to the confidence interval</h3>
<p>Finally, let’s find our sample mean and compare it to the confidence interval to decide whether or not to reject our null hypothesis:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="lab7.html#cb286-1" aria-hidden="true" tabindex="-1"></a>student_sleep <span class="sc">%&gt;%</span></span>
<span id="cb286-2"><a href="lab7.html#cb286-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">M =</span> <span class="fu">mean</span>(hours))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       M
##   &lt;dbl&gt;
## 1  7.42</code></pre>
<p>That is definitely outside the bounds of our 99% confidence interval! As a result, we <strong>reject</strong> the hypothesis that the mean number of hours slept by the population of college students is equal to the recommended amount of <span class="math inline">\(\mu = 8\)</span> hours.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-28" class="exercise"><strong>Exercise 7.9  </strong></span>Although we rejected the null hypothesis in this case, take a look at the histogram we made above of the complete distribution of student sleep time. Is it the case that every single student sleeps less than the recommended amount? What does this mean for how we should interpret the results of our hypothesis test?
</div>
</div>
</div>
<div id="wrap-up-6" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Wrap-up</h2>
<p>In this session, we saw how we can use R to find confidence intervals and how we can use those intervals to test null hypotheses. We saw how hypothesis tests are not perfect—they can lead us to reject the null hypothesis even if it is true (Type I error) and they don’t always lead us to reject the null hypothesis even when it is false (Type II error). Even so, hypothesis tests can be a powerful way to learn about the world using data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["APSY210 Labs.pdf", "APSY210 Labs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
