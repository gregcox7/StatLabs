<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 9 \(t\) tests | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring Data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Central tendency and variability</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Scatterplots and correlation</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Probability and simulation</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Models: The Binomial and the Normal</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> Confidence intervals and hypothesis testing</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></li>
<li><a class="active" href="lab9.html"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></li>
<li><a class="" href="lab11.html"><span class="header-section-number">11</span> Linear Regression</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">12</span> Exploring Data with R, Part II</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="coderef.html"><span class="header-section-number">A</span> Distributions</a></li>
<li><a class="" href="hyptests.html"><span class="header-section-number">B</span> Hypothesis Tests</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab9" class="section level1" number="9">
<h1>
<span class="header-section-number">Lab 9</span> <span class="math inline">\(t\)</span> tests<a class="anchor" aria-label="anchor" href="#lab9"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/lullaby.png" width="100%"></div>
<p>In this session, we will see how we can use R to do all the calculations involved in conducting the various types of <span class="math inline">\(t\)</span> test we have been learning about. In addition, we will begin to get acquainted with some more advanced R functions that make it easier to do these tests on real data, including some helpful visualizations for understanding the relationship between <span class="math inline">\(t\)</span> values and <span class="math inline">\(p\)</span> values.</p>
<p>For this session, we are going to need to load both our standard <code>tidyverse</code> package as well as the <code>infer</code> package from R’s library.</p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.3     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   2.0.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></code></pre></div>
<div id="t-tests-on-tiny-data" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> <span class="math inline">\(t\)</span> tests on tiny data<a class="anchor" aria-label="anchor" href="#t-tests-on-tiny-data"><i class="fas fa-link"></i></a>
</h2>
<p>To get acquainted with how <span class="math inline">\(t\)</span> tests work in R, let’s first try them out on some simple artificial data before applying them to some real data. Imagine that we’re designing an advertisement and want to make sure it is attention-grabbing. The ad will be embedded in a webpage. We use an eye tracker to monitor people’s eye movements over the course of 1 minute while looking at a fake webpage containing the ad. We <em>operationalize</em> the construct of attention-grabbing by measuring the proportion of that time that a person is looking at the ad.</p>
<p>The result is, for each person, a number between 0 (never looked at the ad) and 1 (only looked at the ad). Here are measurements from a sample of <span class="math inline">\(N = 5\)</span> individuals:</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.507</span>, <span class="fl">0.052</span>, <span class="fl">0.172</span>, <span class="fl">0.066</span>, <span class="fl">0.204</span><span class="op">)</span></code></pre></div>
<p>Notice that we have labeled them <code>X_1</code> because we will soon have more than one set of measurements.</p>
<div id="one-sample-t-test" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> One-sample <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#one-sample-t-test"><i class="fas fa-link"></i></a>
</h3>
<p>If participants were looking at the ad half the time on average, their population mean would be <span class="math inline">\(\mu = 0.5\)</span>. Our first <strong>research question</strong> is therefore, “do people look at the ad more than half the time?”</p>
<div id="state-your-hypotheses" class="section level4" number="9.1.1.1">
<h4>
<span class="header-section-number">9.1.1.1</span> State your hypotheses<a class="anchor" aria-label="anchor" href="#state-your-hypotheses"><i class="fas fa-link"></i></a>
</h4>
<p>Given this research question, our <strong>null hypothesis</strong> is that the mean ad proportion is less than or equal to 0.5 (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu \leq 0.5\)</span>) while our <strong>alternative hypothesis</strong> is that the mean ad proportion is more than 0.5 (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu &gt; 0.5\)</span>). This is, therefore, a <strong>one-sided</strong> test.</p>
</div>
<div id="set-your-alpha-level" class="section level4" number="9.1.1.2">
<h4>
<span class="header-section-number">9.1.1.2</span> Set your alpha level<a class="anchor" aria-label="anchor" href="#set-your-alpha-level"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s adopt a relatively lenient alpha level of 0.1.</p>
</div>
<div id="find-the-t-value" class="section level4" number="9.1.1.3">
<h4>
<span class="header-section-number">9.1.1.3</span> Find the <span class="math inline">\(t\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-t-value"><i class="fas fa-link"></i></a>
</h4>
<p>To get the ingredients we need for the <span class="math inline">\(t\)</span> value, we need to know the deviation of the <em>sample mean</em> from the null hypothesis as well as the <em>estimated standard error</em> of the mean. The deviation from the null hypothesis is the difference between the sample mean and that specified by the null hypothesis, which is 0.5.</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span></code></pre></div>
<pre><code>## [1] -0.2998</code></pre>
<p>Meanwhile, the <em>estimated standard error</em> is the sample standard deviation (<code><a href="https://rdrr.io/r/stats/sd.html">sd(X_1)</a></code>) divided by the square root of the sample size (<code><a href="https://rdrr.io/r/base/length.html">length(X_1)</a></code>).</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.08213063</code></pre>
<p>Taking the ratio of the above two quantities gives us our <span class="math inline">\(t\)</span> value:</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span></code></pre></div>
<pre><code>## [1] -3.650283</code></pre>
</div>
<div id="find-the-p-value" class="section level4" number="9.1.1.4">
<h4>
<span class="header-section-number">9.1.1.4</span> Find the <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-p-value"><i class="fas fa-link"></i></a>
</h4>
<p>Because this is a <em>one-sided</em> test and the alternative hypothesis is that the population mean is <em>greater</em> than 0.5, we need to to know the probability of observing a value that is <em>at least as <strong>large</strong></em> as the one we have. We also need to know the degrees of freedom, which in this case is <span class="math inline">\(5 - 1 = 4\)</span> (<code>length(X_1) - 1</code>).</p>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">t</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.989117</code></pre>
</div>
<div id="decide-whether-or-not-to-reject-the-null-hypothesis" class="section level4" number="9.1.1.5">
<h4>
<span class="header-section-number">9.1.1.5</span> Decide whether or not to reject the null hypothesis<a class="anchor" aria-label="anchor" href="#decide-whether-or-not-to-reject-the-null-hypothesis"><i class="fas fa-link"></i></a>
</h4>
<p>Since the <span class="math inline">\(p\)</span> value is <em>bigger</em> than our alpha level, we <strong>fail to reject</strong> the null hypothesis. We have no evidence that people look at the ad more than half the time.</p>
</div>
</div>
<div id="paired-sample-t-test" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Paired sample <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#paired-sample-t-test"><i class="fas fa-link"></i></a>
</h3>
<p>Perhaps spurred by the disappointing results of that one-sample <span class="math inline">\(t\)</span> test, we decide to change the colors in the ad and bring the same sample of 5 people back. Again, we record the proportion of the time that they spend looking at our new ad, which we label <code>X_2</code>:</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.907</span>, <span class="fl">0.115</span>, <span class="fl">0.548</span>, <span class="fl">0.202</span>, <span class="fl">0.347</span><span class="op">)</span></code></pre></div>
<p>Now we have a <em>pair</em> of measurements from each person. So the first entry in <code>X_1</code> and the first entry in <code>X_2</code> come from the same person, same for the second entry, third entry, etc. Our <strong>research question</strong> now is, “did changing the ad affect how much people looked at it at all?”</p>
<p>To address this question, we will do a <strong>paired sample <span class="math inline">\(t\)</span> test</strong>. This involves looking at the <em>differences</em> for each person, which we can find in R like so (we will also give them a label <code>D</code> to make it easier):</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">X_2</span> <span class="op">-</span> <span class="va">X_1</span></code></pre></div>
<p>(<em>Note that you can do the subtraction in any order, the important thing is to remember which order you picked so you know what the difference means!</em>)</p>
<div id="state-your-hypotheses-1" class="section level4" number="9.1.2.1">
<h4>
<span class="header-section-number">9.1.2.1</span> State your hypotheses<a class="anchor" aria-label="anchor" href="#state-your-hypotheses-1"><i class="fas fa-link"></i></a>
</h4>
<p>Notice that now our question is about any kind of effect, so this will be a <strong>two-tailed</strong> test. The <strong>null hypothesis</strong> is that the mean difference is zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_D = 0\)</span>) and the <strong>alternative hypothesis</strong> is that the mean difference is <em>not</em> zero (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu_D \neq 0\)</span>).</p>
</div>
<div id="set-your-alpha-level-1" class="section level4" number="9.1.2.2">
<h4>
<span class="header-section-number">9.1.2.2</span> Set your alpha level<a class="anchor" aria-label="anchor" href="#set-your-alpha-level-1"><i class="fas fa-link"></i></a>
</h4>
<p>Again, let’s keep our alpha level from before and say that our alpha level is 0.1.</p>
</div>
<div id="find-the-t-value-1" class="section level4" number="9.1.2.3">
<h4>
<span class="header-section-number">9.1.2.3</span> Find the <span class="math inline">\(t\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-t-value-1"><i class="fas fa-link"></i></a>
</h4>
<p>Remember that the paired sample <span class="math inline">\(t\)</span> test is much like the one-sample <span class="math inline">\(t\)</span> test, only instead of using raw measurements, we use the <em>differences</em> which we labeled <code>D</code>.</p>
<pre><code>## [1] 3.256259</code></pre>

<div class="exercise">
<p><span id="exr:ex0901" class="exercise"><strong>Exercise 9.1  </strong></span>
Modify the slice of code we used in the previous section to find the <span class="math inline">\(t\)</span> value given above and make sure that it is labeled <code>t_D</code> (the “D” is for “difference”). What code did you write to find this new <span class="math inline">\(t\)</span> value? <em>Hint: remember what the mean from the null hypothesis is!</em></p>
</div>
</div>
<div id="find-the-p-value-1" class="section level4" number="9.1.2.4">
<h4>
<span class="header-section-number">9.1.2.4</span> Find the <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-p-value-1"><i class="fas fa-link"></i></a>
</h4>
<p>Since the <span class="math inline">\(t\)</span> value is positive, this means it is on the upper end of the <span class="math inline">\(t\)</span> distribution. To find the probability of seeing a value that is at least as high as the one we saw, we can use</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">t_D</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.01559538</code></pre>
<p>But remember that we have to multiply that by <code>2</code> since this is a <em>two-tailed test</em>. So this is our <span class="math inline">\(p\)</span> value:</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">t_D</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.03119075</code></pre>
</div>
<div id="decide-whether-or-not-to-reject-the-null-hypothesis-1" class="section level4" number="9.1.2.5">
<h4>
<span class="header-section-number">9.1.2.5</span> Decide whether or not to reject the null hypothesis<a class="anchor" aria-label="anchor" href="#decide-whether-or-not-to-reject-the-null-hypothesis-1"><i class="fas fa-link"></i></a>
</h4>
<p>Since the <span class="math inline">\(p\)</span> value is <em>smaller</em> than our alpha level, we <strong>reject</strong> the null hypothesis. We have reason to believe that changing the ad really did affect each individual’s viewing patterns.</p>

<div class="exercise">
<p><span id="exr:ex0902" class="exercise"><strong>Exercise 9.2  </strong></span>
Although the test we just did was only about differences in <em>any</em> direction, based on the <span class="math inline">\(t\)</span> value does it seem like changing the ad increased or decreased the proportion of time people spent looking at the ad?</p>
</div>
</div>
</div>
<div id="independent-samples-t-test" class="section level3" number="9.1.3">
<h3>
<span class="header-section-number">9.1.3</span> Independent samples <span class="math inline">\(t\)</span> test<a class="anchor" aria-label="anchor" href="#independent-samples-t-test"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s imagine that, instead of bringing back the same sample of 5 people to view our new ad, we brought in a different sample. While we’re imagining, let’s say that this new sample still produce the <em>same</em> measurements. So our “data” is the same, only now it is not “paired,” it comes from two <em>independent samples</em>.</p>
<p>Our <strong>research question</strong> remains the same: “did changing the ad affect how much people looked at it at all?” But now, to address this question, we will do an <strong>independent samples <span class="math inline">\(t\)</span> test</strong>.</p>
<div id="state-your-hypotheses-2" class="section level4" number="9.1.3.1">
<h4>
<span class="header-section-number">9.1.3.1</span> State your hypotheses<a class="anchor" aria-label="anchor" href="#state-your-hypotheses-2"><i class="fas fa-link"></i></a>
</h4>
<p>Because we have two samples from (potentially) two populations, our null and alternative hypotheses are about a difference in population parameters. This is still a <strong>two-tailed</strong> test. The <strong>null hypothesis</strong> is that the mean difference is zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_2 - \mu_1 = 0\)</span>) and the <strong>alternative hypothesis</strong> is that the mean difference is <em>not</em> zero (<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu_2 - \mu_1 \neq 0\)</span>).</p>
<p>Notice that we are keeping the order of the subtraction (2 minus 1) the same as above, to make it easier to compare.</p>
</div>
<div id="set-your-alpha-level-2" class="section level4" number="9.1.3.2">
<h4>
<span class="header-section-number">9.1.3.2</span> Set your alpha level<a class="anchor" aria-label="anchor" href="#set-your-alpha-level-2"><i class="fas fa-link"></i></a>
</h4>
<p>Again, let’s keep our alpha level from before and say that our alpha level is 0.1.</p>
</div>
<div id="find-the-t-value-2" class="section level4" number="9.1.3.3">
<h4>
<span class="header-section-number">9.1.3.3</span> Find the <span class="math inline">\(t\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-t-value-2"><i class="fas fa-link"></i></a>
</h4>
<p>To find the <span class="math inline">\(t\)</span> value, remember that we first have to find the <strong>pooled sample standard deviation</strong>. In mathematical terms, this is <span class="math inline">\(\hat{\sigma}_P = \sqrt{\frac{df_1 \hat{\sigma}^2_1 + df_2 \hat{\sigma}^2_2}{df_1 + df_2}}\)</span>. We can write that out in R like so:</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="va">df_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>

<span class="va">sd_pooled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">df_1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">df_2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">df_1</span> <span class="op">+</span> <span class="va">df_2</span><span class="op">)</span><span class="op">)</span>
<span class="va">sd_pooled</span></code></pre></div>
<pre><code>## [1] 0.2584249</code></pre>
<p>With our pooled SD in hand, we can now find the <span class="math inline">\(t\)</span> value</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_Indep</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sd_pooled</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t_Indep</span></code></pre></div>
<pre><code>## [1] 1.368067</code></pre>
</div>
<div id="find-the-p-value-2" class="section level4" number="9.1.3.4">
<h4>
<span class="header-section-number">9.1.3.4</span> Find the <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-p-value-2"><i class="fas fa-link"></i></a>
</h4>
<p>Again, since the <span class="math inline">\(t\)</span> value is positive, this means it is on the upper end of the <span class="math inline">\(t\)</span> distribution. To find the probability of seeing a value that is at least as high as the one we saw, we can use</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">t_Indep</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.1042398</code></pre>
<p>Note that we have a different number of <strong>degrees of freedom</strong> here because we are treating these data as being from two independent samples. But again we have to multiply the probability above by <code>2</code> since this is a <em>two-tailed test</em>. So this is our final <span class="math inline">\(p\)</span> value:</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">t_Indep</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X_2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.2084797</code></pre>
</div>
<div id="decide-whether-or-not-to-reject-the-null-hypothesis-2" class="section level4" number="9.1.3.5">
<h4>
<span class="header-section-number">9.1.3.5</span> Decide whether or not to reject the null hypothesis<a class="anchor" aria-label="anchor" href="#decide-whether-or-not-to-reject-the-null-hypothesis-2"><i class="fas fa-link"></i></a>
</h4>
<p>This time, the <span class="math inline">\(p\)</span> value is <em>bigger</em> than our alpha level, so we <strong>fail to reject</strong> the null hypothesis. Funny—the same data lead us to different conclusions depending on whether it came from just one sample versus two independent samples!</p>

<div class="exercise">
<p><span id="exr:ex0903" class="exercise"><strong>Exercise 9.3  </strong></span>
Why do you think we were able to reject the null hypothesis using the paired samples <span class="math inline">\(t\)</span> test, but not with the independent samples <span class="math inline">\(t\)</span> test, even though the actual data were the same in both cases? Think about the fact that there is variability both between different individuals and within a single individual (e.g., if you do something multiple times, chances are you won’t act exactly the same each time). Does one type of test effectively eliminate one of these kinds of variability? How might that affect the ability to the test to detect particular kinds of differences?</p>
</div>
</div>
</div>
</div>
<div id="t-tests-with-real-data" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> <span class="math inline">\(t\)</span> tests with real data<a class="anchor" aria-label="anchor" href="#t-tests-with-real-data"><i class="fas fa-link"></i></a>
</h2>
<p>We’ve now seen how to do all the calculations for a <span class="math inline">\(t\)</span> test in R. Because R was built for statistics, you won’t be surprised that it can automate many of those things for us, as we’ll see. As usual, though, when a computer does the “mindless” work, we have to be even more “mindful” of how to interpret the results it gives us.</p>
<p>In this example, we will look at a study by Sam Mehr, Lee Ann Song (aptly named), and Liz Spelke <span class="citation">(<a href="references.html#ref-MehrEtAl2016" role="doc-biblioref">Mehr et al., 2016</a>)</span>. They wanted to see whether music is an important social cue for infants. Specifically, they wondered whether infants tend to prefer people who sing familiar songs. The idea is that someone singing a song you know is probably a member of the same social group as you are.</p>
<p>They conducted an experiment in which a child’s parents were taught a new melody and were instructed to sing it to their child at home over the course of 1–2 weeks. After this exposure period, the parents brought their infant back to the lab. The infant was seated in front of a screen showing videos of two unfamiliar adults just smiling in silence. They recorded the proportion of the time that the infant looked at each individual during this “before” phase. Then, one of these unfamiliar people sang the melody that the parents had been singing for 1–2 weeks, while the other sang a totally new song. Finally, during the “after” phase, the infant saw the same videos of each person silently smiling and the researchers recorded the proportion of the time spent looking at the person who sang the familiar song.</p>
<p>The overall aim of this experiment is to see whether infants will prefer to look at the singer of the familiar melody after hearing them sing it, even though they’ve never seen this person before.</p>
<div id="check-out-the-data" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Check out the data<a class="anchor" aria-label="anchor" href="#check-out-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>First, let’s get the data into R:</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/lullaby_wide.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 32 Columns: 3</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (3): id, Before, After</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Have a look at the data by clicking on <code>lullaby</code> in RStudio’s “Environment” pane. Each row is data from a specific infant. There are three variables in this dataset:</p>
<ul>
<li>“id”: Identifies each infant in the study.</li>
<li>“Before”: In the phase before the infants heard anyone sing, what proportion of the time did they look at the person who would eventually sing the familiar melody?</li>
<li>“After”: In the phase after the infants heard the two people sing, what proportion of the time did they look at the person who sang the familiar melody?</li>
</ul>
<p>Let’s summarize the looking preferences for infants before and after hearing the people sing:</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>M_before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Before</span><span class="op">)</span>, S_before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Before</span><span class="op">)</span>, M_after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">After</span><span class="op">)</span>, S_after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">After</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   M_before S_before M_after S_after
##      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1    0.521    0.177   0.593   0.179</code></pre>

<div class="exercise">
<p><span id="exr:ex0904" class="exercise"><strong>Exercise 9.4  </strong></span>
Based on the sample means and standard deviations we just found, does it seem like there might be a preference to look more at the person who would sing the familiar melody, either before or after hearing them sing?</p>
</div>
</div>
<div id="did-infants-show-any-prior-bias" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Did infants show any prior bias?<a class="anchor" aria-label="anchor" href="#did-infants-show-any-prior-bias"><i class="fas fa-link"></i></a>
</h3>
<p>Before we can ask whether infants prefer to look at someone who sings a familiar melody, we need to see whether they show any kind of <em>bias</em> to look at one person or another <em>before</em> hearing them sing. If they did show a bias to look at one of the individuals before hearing them, then we wouldn’t be able to attribute their behavior to the familiarity of the song.</p>
<p>Let’s first inspect the data by making a histogram:</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Before</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="09-ttests_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex0905" class="exercise"><strong>Exercise 9.5  </strong></span>
Based on the histogram above, does it seem like there are any outliers or skew that are very far from a normal distribution?</p>
</div>
<p>Our <strong>research question</strong> is, “do infants prefer to look at one person over the other, even before hearing them sing?” We will address this question using a <strong>one-sample <span class="math inline">\(t\)</span> test</strong>.</p>
<div id="state-your-hypotheses-3" class="section level4" number="9.2.2.1">
<h4>
<span class="header-section-number">9.2.2.1</span> State your hypotheses<a class="anchor" aria-label="anchor" href="#state-your-hypotheses-3"><i class="fas fa-link"></i></a>
</h4>
<p>An unbiased infant would look equally often at both people, so the proportion of the time they looked at the singer of the familiar song would be 0.5. This is our <strong>null hypothesis</strong>: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = 0\)</span>. So our <strong>alternative hypothesis</strong> is just that <span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu \neq 0\)</span>.</p>
</div>
<div id="set-your-alpha-level-3" class="section level4" number="9.2.2.2">
<h4>
<span class="header-section-number">9.2.2.2</span> Set your alpha level<a class="anchor" aria-label="anchor" href="#set-your-alpha-level-3"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s choose an alpha level of 0.05, same as the one <span class="citation"><a href="references.html#ref-MehrEtAl2016" role="doc-biblioref">Mehr et al.</a> (<a href="references.html#ref-MehrEtAl2016" role="doc-biblioref">2016</a>)</span> chose.</p>
</div>
<div id="find-the-t-value-3" class="section level4" number="9.2.2.3">
<h4>
<span class="header-section-number">9.2.2.3</span> Find the <span class="math inline">\(t\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-t-value-3"><i class="fas fa-link"></i></a>
</h4>
<p>R’s <code>infer</code> package makes it easy to get our <span class="math inline">\(t\)</span> value. Let’s first look at the code for doing this, then explain line-by-line what it means:</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">Before</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">'point'</span>, mu <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##    stat
##   &lt;dbl&gt;
## 1 0.674</code></pre>
<p>The first line, like usual, tells R what data to work with. In the second line, we <code>specify</code> that the variable we want to use for our test is the <code>Before</code> variable. The variable we are interested in is called a <code>response</code> variable. In the third line, we tell R that our null hypothesis is a “point” (that is, a single value) at <code>mu = 0.5</code>. Finally, the fourth line tells R to <code>calculate</code> the <code>t</code> <code>stat</code>istic based on what we told it in the first 3 lines.</p>
<p>Let’s tell R to remember that <span class="math inline">\(t\)</span> value. We’ll call it <code>t_before</code>, since it refers to the looking <em>before</em> the infants heard anything.</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_before</span> <span class="op">&lt;-</span> <span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">Before</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">'point'</span>, mu <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span></code></pre></div>
</div>
<div id="find-the-p-value-3" class="section level4" number="9.2.2.4">
<h4>
<span class="header-section-number">9.2.2.4</span> Find the <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-p-value-3"><i class="fas fa-link"></i></a>
</h4>
<p>We can do something fancy now and <code>visualize</code> the appropriate <span class="math inline">\(t\)</span> distribution corresponding to our null hypothesis:</p>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_before</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'theoretical'</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Check to make sure the conditions have been met for the theoretical
## method. {infer} currently does not check these for you.</code></pre>
<div class="inline-figure"><img src="09-ttests_files/figure-html/unnamed-chunk-23-1.png" width="672"></div>
<p>The first line tells R to use the <span class="math inline">\(t\)</span> value we just found as “data.” The second line instructs R to visualize the <code>theoretical</code> <span class="math inline">\(t\)</span> distribution if the null hypothesis were true. This distribution is what will let us calculate the <span class="math inline">\(p\)</span> value.</p>
<p>In fact, we can visualize what the <span class="math inline">\(p\)</span> value will be by showing where the <span class="math inline">\(t\)</span> statistic for our sample falls on the <span class="math inline">\(t\)</span> distribution:</p>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_before</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'theoretical'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">t_before</span>, direction <span class="op">=</span> <span class="st">'two-sided'</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Check to make sure the conditions have been met for the theoretical
## method. {infer} currently does not check these for you.</code></pre>
<div class="inline-figure"><img src="09-ttests_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<p>All we did was add a third line where we told R to <code>shade</code> the area of the <span class="math inline">\(t\)</span> distribution that is <em>at least as extreme</em> as our sample (that’s what <code>obs_stat = t_before</code> did). What counts as “extreme” depends on whether our test is one- or two-sided, so we had to tell R that the <code>direction</code> of our test was <code>two-sided</code>. The <em>area</em> of the shaded region on the plot above is what our <span class="math inline">\(p\)</span> value is.</p>
<p>But of course, we can’t get a number just by looking at a graph. Here’s how we actually get all the numbers we need out of R:</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/t_test.html">t_test</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">Before</span>,
           alternative <span class="op">=</span> <span class="st">'two-sided'</span>,
           mu <span class="op">=</span> <span class="fl">0.5</span>,
           conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   statistic  t_df p_value alternative lower_ci upper_ci
##       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1     0.674    31   0.505 two.sided      0.457    0.585</code></pre>
<p>The first line, as usual, tells R what data to use. The remaining lines tell R all about the <code>t_test</code> we want to perform. We tell R that the <code>response</code> variable (the one we want to test) is <code>Preference</code>; that we are doing a test with an <code>alternative</code> hypothesis that is <code>two-sided</code>; that the mean according to the null hypothesis is <code>mu = 0.5</code>; and that our confidence level (<code>conf_level</code>) is 0.95, which is one minus our alpha level.</p>
<p>The output we got from R told us a lot:</p>
<ul>
<li>
<code>statistic</code>: The value of the <span class="math inline">\(t\)</span> statistic.</li>
<li>
<code>t_df</code>: The number of degrees of freedom.</li>
<li>
<code>p_value</code>: The <span class="math inline">\(p\)</span> value.</li>
<li>
<code>alternative</code>: Reminding us that we were doing a two-sided test.</li>
<li>
<code>lower_ci</code>: The lower limit of the <em>updated</em> confidence interval (assuming the population mean is equal to the sample mean). The width of the interval is defined by the <code>conf_level</code> we told R already.</li>
<li>
<code>upper_ci</code>: The upper limit of the <em>updated</em> confidence interval (assuming the population mean is equal to the sample mean).</li>
</ul>
</div>
<div id="decide-whether-or-not-to-reject-the-null-hypothesis-3" class="section level4" number="9.2.2.5">
<h4>
<span class="header-section-number">9.2.2.5</span> Decide whether or not to reject the null hypothesis<a class="anchor" aria-label="anchor" href="#decide-whether-or-not-to-reject-the-null-hypothesis-3"><i class="fas fa-link"></i></a>
</h4>
<p>Finally, we can use the <span class="math inline">\(p\)</span> value we just found, in combination with the alpha level from above (which we decided was 0.05) to say that we <strong>fail to reject</strong> the null hypothesis. As a result, we have no reason to believe that there is any bias in who the infants look at before hearing them sing.</p>
</div>
</div>
<div id="do-infants-prefer-to-look-at-the-singer-of-the-familiar-melody" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Do infants prefer to look at the singer of the familiar melody?<a class="anchor" aria-label="anchor" href="#do-infants-prefer-to-look-at-the-singer-of-the-familiar-melody"><i class="fas fa-link"></i></a>
</h3>
<p>What about where infants look <em>after</em> they hear the two people sing? Do they show any kind of preference? Again, we can use a <strong>one-sample <span class="math inline">\(t\)</span> test</strong> to find out. In fact, all we need to do is reuse different bits of code from the previous section, just changing the variable of interest from “Before” to “After.”</p>
<p>Let’s begin by making a histogram of the <code>After</code> variable.</p>
<div class="inline-figure"><img src="09-ttests_files/figure-html/unnamed-chunk-26-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex0906" class="exercise"><strong>Exercise 9.6  </strong></span>
What code did you use to make the histogram above? Do you see any evidence of outliers or skew that are very different from what we might see in a normal distribution?</p>
</div>
<p>Our <strong>research question</strong> is, “do infants prefer to look at one person over the other <em>after</em> hearing them sing?”</p>
<div id="state-your-hypotheses-4" class="section level4" number="9.2.3.1">
<h4>
<span class="header-section-number">9.2.3.1</span> State your hypotheses<a class="anchor" aria-label="anchor" href="#state-your-hypotheses-4"><i class="fas fa-link"></i></a>
</h4>
<p>Again, an infant without any preference would look equally often at both people, so the proportion of the time they looked at the singer of the familiar song would be 0.5. This is, again, our <strong>null hypothesis</strong>: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu = 0\)</span>. Again, our <strong>alternative hypothesis</strong> is just that <span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu \neq 0\)</span>.</p>
</div>
<div id="set-your-alpha-level-4" class="section level4" number="9.2.3.2">
<h4>
<span class="header-section-number">9.2.3.2</span> Set your alpha level<a class="anchor" aria-label="anchor" href="#set-your-alpha-level-4"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s keep our alpha level of 0.05.</p>
</div>
<div id="find-the-t-value-4" class="section level4" number="9.2.3.3">
<h4>
<span class="header-section-number">9.2.3.3</span> Find the <span class="math inline">\(t\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-t-value-4"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s tell R to remember our <em>new</em> <span class="math inline">\(t\)</span> value so that we can visualize it like we did before. We’re going to call this new <span class="math inline">\(t\)</span> value <code>t_after</code> to keep it distinct.</p>

<div class="exercise">
<p><span id="exr:ex0907" class="exercise"><strong>Exercise 9.7  </strong></span>
What code did you use to make <code>t_after</code>? (<em>Hint: what do you change in the code we used above to make <code>t_before</code>?</em>)</p>
</div>
</div>
<div id="find-the-p-value-4" class="section level4" number="9.2.3.4">
<h4>
<span class="header-section-number">9.2.3.4</span> Find the <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-p-value-4"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s visualize our <span class="math inline">\(t\)</span> statistic to get a sense of what the <span class="math inline">\(p\)</span> value will be</p>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_after</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'theoretical'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">t_after</span>, direction <span class="op">=</span> <span class="st">'two-sided'</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Check to make sure the conditions have been met for the theoretical
## method. {infer} currently does not check these for you.</code></pre>
<div class="inline-figure"><img src="09-ttests_files/figure-html/unnamed-chunk-28-1.png" width="672"></div>
<p>Finally, let’s get the whole shebang:</p>
<pre><code>## # A tibble: 1 × 6
##   statistic  t_df p_value alternative lower_ci upper_ci
##       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1      2.96    31 0.00586 two.sided      0.529    0.658</code></pre>

<div class="exercise">
<p><span id="exr:ex0908" class="exercise"><strong>Exercise 9.8  </strong></span>
What code did you use to get the <code>t_test</code> output above?</p>
</div>
</div>
<div id="decide-whether-or-not-to-reject-the-null-hypothesis-4" class="section level4" number="9.2.3.5">
<h4>
<span class="header-section-number">9.2.3.5</span> Decide whether or not to reject the null hypothesis<a class="anchor" aria-label="anchor" href="#decide-whether-or-not-to-reject-the-null-hypothesis-4"><i class="fas fa-link"></i></a>
</h4>
<p>Comparing the <span class="math inline">\(p\)</span> value we just found to our alpha level of 0.05, we <strong>reject</strong> the null hypothesis. We have reason to believe that the infants have a <em>preference</em> to look at one singer over the other.</p>
</div>
</div>
<div id="did-their-preferences-change" class="section level3" number="9.2.4">
<h3>
<span class="header-section-number">9.2.4</span> Did their preferences change?<a class="anchor" aria-label="anchor" href="#did-their-preferences-change"><i class="fas fa-link"></i></a>
</h3>
<p>Based on what we’ve done so far, it seems like before hearing the two people sing, the infants didn’t look at either one more than the other, but <em>after</em> hearing them sing, the infants did show a preference. Now let’s ask a more direct <strong>research question</strong>: For each infant, did hearing someone sing a familiar song lead that infant to prefer looking at that person? This question can be addressed using a <strong>paired samples <span class="math inline">\(t\)</span> test</strong>.</p>
<div id="state-your-hypotheses-5" class="section level4" number="9.2.4.1">
<h4>
<span class="header-section-number">9.2.4.1</span> State your hypotheses<a class="anchor" aria-label="anchor" href="#state-your-hypotheses-5"><i class="fas fa-link"></i></a>
</h4>
<p>Based on the way our research question is phrased, we are looking at a <strong>one-tailed test</strong> because we are asking about a difference in a specific direction—an <em>increase</em> in preferential looking. So our <strong>null hypothesis</strong> is that the difference in preference is less than or equal to zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_D \leq 0\)</span>) while our <strong>alternative hypothesis</strong> is that the difference is greater than zero (<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_D &gt; 0\)</span>).</p>
</div>
<div id="set-your-alpha-level-5" class="section level4" number="9.2.4.2">
<h4>
<span class="header-section-number">9.2.4.2</span> Set your alpha level<a class="anchor" aria-label="anchor" href="#set-your-alpha-level-5"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s stay consistent and say that our <strong>alpha level</strong> is still 0.05.</p>
</div>
<div id="find-the-t-value-5" class="section level4" number="9.2.4.3">
<h4>
<span class="header-section-number">9.2.4.3</span> Find the <span class="math inline">\(t\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-t-value-5"><i class="fas fa-link"></i></a>
</h4>
<p>Like we did above, we need to first find the <em>difference</em> for each infant between their looking preferences before and after hearing the people sing. We can do that in R using the <code>mutate</code> function, which we’ve previously used to calculate probabilities based on relative frequency.</p>
<p>The code below creates a new variable called <code>Difference</code> by subtracting the <code>Before</code> preference from the <code>After</code> preference:</p>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>Difference <span class="op">=</span> <span class="va">After</span> <span class="op">-</span> <span class="va">Before</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 32 × 4
##       id Before After Difference
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
##  1   101  0.437 0.603     0.166 
##  2   102  0.413 0.683     0.270 
##  3   103  0.754 0.724    -0.0304
##  4   104  0.439 0.282    -0.157 
##  5   105  0.475 0.499     0.0239
##  6   106  0.871 0.951     0.0800
##  7   107  0.237 0.418     0.181 
##  8   108  0.759 0.938     0.179 
##  9   109  0.416 0.5       0.0837
## 10   110  0.800 0.586    -0.213 
## # … with 22 more rows</code></pre>
<p>We can insert that second line of code above in order to calculate the <span class="math inline">\(t\)</span> statistic corresponding to our difference scores:</p>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_diff</span> <span class="op">&lt;-</span> <span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>Difference <span class="op">=</span> <span class="va">After</span> <span class="op">-</span> <span class="va">Before</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">Difference</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">'point'</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span></code></pre></div>

<div class="exercise">
<p><span id="exr:ex0909" class="exercise"><strong>Exercise 9.9  </strong></span>
Compare the code used to make <code>t_diff</code> with the code we previously used to make <code>t_before</code> and <code>t_after</code>. What is similar and what is different?</p>
</div>
</div>
<div id="find-the-p-value-5" class="section level4" number="9.2.4.4">
<h4>
<span class="header-section-number">9.2.4.4</span> Find the <span class="math inline">\(p\)</span> value<a class="anchor" aria-label="anchor" href="#find-the-p-value-5"><i class="fas fa-link"></i></a>
</h4>
<p>Now that we have found <code>t_diff</code>, let’s see where our sample falls on the <span class="math inline">\(t\)</span> distribution corresponding to the null hypothesis:</p>
<div class="sourceCode" id="cb399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_diff</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'theoretical'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">t_diff</span>, direction <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Check to make sure the conditions have been met for the theoretical
## method. {infer} currently does not check these for you.</code></pre>
<div class="inline-figure"><img src="09-ttests_files/figure-html/unnamed-chunk-32-1.png" width="672"></div>

<div class="exercise">
<p><span id="exr:ex0910" class="exercise"><strong>Exercise 9.10  </strong></span>
Compare the visualization of the <span class="math inline">\(t\)</span> distribution for <code>t_diff</code> to the ones we made for <code>t_before</code> and <code>t_after</code>. Is there a difference in which sides of the distribution are shaded? Why might this be?</p>
</div>
<p>Finally, we can obtain the <span class="math inline">\(p\)</span> value along with the rest of the results of the <span class="math inline">\(t\)</span> test:</p>
<pre><code>## # A tibble: 1 × 6
##   statistic  t_df p_value alternative lower_ci upper_ci
##       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;
## 1      2.42    31  0.0109 greater       0.0216      Inf</code></pre>

<div class="exercise">
<p><span id="exr:ex0911" class="exercise"><strong>Exercise 9.11  </strong></span>
How did you modify the code we used above for the previous two <span class="math inline">\(t\)</span> tests to get the result above? Do you notice anything different about the output we got from R for this one-tailed test, relative to the two-tailed tests we did above?</p>
</div>
</div>
<div id="decide-whether-or-not-to-reject-the-null-hypothesis-5" class="section level4" number="9.2.4.5">
<h4>
<span class="header-section-number">9.2.4.5</span> Decide whether or not to reject the null hypothesis<a class="anchor" aria-label="anchor" href="#decide-whether-or-not-to-reject-the-null-hypothesis-5"><i class="fas fa-link"></i></a>
</h4>
<p>Comparing the <span class="math inline">\(p\)</span> value we just found to our alpha level of 0.05, we <strong>reject</strong> the null hypothesis. We have reason to believe that infants’ preferences <em>changed</em> after hearing the two people sing, such that they look more often at the singer of the familiar melody.</p>
</div>
</div>
</div>
<div id="wrap-up-8" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-8"><i class="fas fa-link"></i></a>
</h2>
<p>In this session, we saw both how to conduct all the individual calculations in a <span class="math inline">\(t\)</span> test as well as how to use R to do a <span class="math inline">\(t\)</span> test “all at once.” We saw how to do one-sample, paired samples, and independent samples <span class="math inline">\(t\)</span> tests in step-by-step form. We also saw how to do one-sample and paired samples <span class="math inline">\(t\)</span> tests in a fancier form with helpful visual aids that are better suited for dealing with real data. We can also do independent samples <span class="math inline">\(t\)</span> tests in this fancier way, but we will have to wait until next week to see a demonstration. Nonetheless, it is clear that R has powerful facilities for doing the kinds of hypothesis tests that are the bread and butter of inferential statistics.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab8.html"><span class="header-section-number">8</span> Statistical Power</a></div>
<div class="next"><a href="lab10.html"><span class="header-section-number">10</span> Comparing Independent Samples</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab9"><span class="header-section-number">9</span> \(t\) tests</a></li>
<li>
<a class="nav-link" href="#t-tests-on-tiny-data"><span class="header-section-number">9.1</span> \(t\) tests on tiny data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#one-sample-t-test"><span class="header-section-number">9.1.1</span> One-sample \(t\) test</a></li>
<li><a class="nav-link" href="#paired-sample-t-test"><span class="header-section-number">9.1.2</span> Paired sample \(t\) test</a></li>
<li><a class="nav-link" href="#independent-samples-t-test"><span class="header-section-number">9.1.3</span> Independent samples \(t\) test</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#t-tests-with-real-data"><span class="header-section-number">9.2</span> \(t\) tests with real data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#check-out-the-data"><span class="header-section-number">9.2.1</span> Check out the data</a></li>
<li><a class="nav-link" href="#did-infants-show-any-prior-bias"><span class="header-section-number">9.2.2</span> Did infants show any prior bias?</a></li>
<li><a class="nav-link" href="#do-infants-prefer-to-look-at-the-singer-of-the-familiar-melody"><span class="header-section-number">9.2.3</span> Do infants prefer to look at the singer of the familiar melody?</a></li>
<li><a class="nav-link" href="#did-their-preferences-change"><span class="header-section-number">9.2.4</span> Did their preferences change?</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-8"><span class="header-section-number">9.3</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/09-ttests.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/09-ttests.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2021-08-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
