<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab 9 Inference about a mean | Labs</title>
<meta name="author" content="Greg Cox">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.14/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="css/ims-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="lab1.html"><span class="header-section-number">1</span> Exploring data with R</a></li>
<li><a class="" href="lab2.html"><span class="header-section-number">2</span> Sampling</a></li>
<li><a class="" href="lab3.html"><span class="header-section-number">3</span> Describing data</a></li>
<li><a class="" href="lab4.html"><span class="header-section-number">4</span> Relationships between numerical variables</a></li>
<li><a class="" href="lab5.html"><span class="header-section-number">5</span> Hypothesis testing with randomization</a></li>
<li><a class="" href="lab6.html"><span class="header-section-number">6</span> Confidence intervals with bootstrapping</a></li>
<li><a class="" href="lab7.html"><span class="header-section-number">7</span> The normal distribution</a></li>
<li><a class="" href="lab8.html"><span class="header-section-number">8</span> Inference for proportions</a></li>
<li><a class="active" href="lab9.html"><span class="header-section-number">9</span> Inference about a mean</a></li>
<li><a class="" href="lab10.html"><span class="header-section-number">10</span> Inference for comparing two independent means</a></li>
<li><a class="" href="lab12.html"><span class="header-section-number">11</span> Inference for multiple independent groups</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/gregcox7/StatLabs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab9" class="section level1" number="9">
<h1>
<span class="header-section-number">Lab 9</span> Inference about a mean<a class="anchor" aria-label="anchor" href="#lab9"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="img/lullaby.png" width="100%"></div>
<p>In this session, we will learn about doing inference when the response variable is <em>numerical</em> rather than <em>categorical</em>. Specifically, we will focus on how we can use data to draw inferences about what a population average might be, based on a sample. This is very similar to how we have been drawing inferences about a population proportion. As we shall see, simulation methods like bootstrapping work just the same with a numerical response variable as they do with a categorical response variable. Where they differ is that the mathematical model for proportions is a <em>normal</em> distribution whereas the mathematical model for means is a <strong>T distribution</strong>.</p>
<p>These methods are also critical for estimating and testing differences within a <em>pair</em> of measurements. Because each observation is <em>paired</em> with another, in the end we are just analyzing a single number for each case, which is the <em>difference</em> within each pair.</p>
<p>To help with the later exercises in this session, be sure to <strong>download the worksheet for this session</strong> by right-clicking on the following link and selecting “Save link as…”: <a href="https://raw.githubusercontent.com/gregcox7/StatLabs/main/worksheets/ws_lab09.Rmd">Worksheet for Lab 9</a>. Open the saved file (which by default is called “ws_lab09.Rmd”) in RStudio.</p>
<div id="overworked" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Overworked?<a class="anchor" aria-label="anchor" href="#overworked"><i class="fas fa-link"></i></a>
</h2>
<p>To begin, we will first address some questions about the <em>number of hours people work per week</em>. The relevant data was collected as part of the General Social Survey (GSS) in 2010. The first few rows of the survey results look like this:</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">gss</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">degree</th>
<th align="right">HoursWorked</th>
<th align="right">HoursRelax</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">BACHELOR</td>
<td align="right">55</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">BACHELOR</td>
<td align="right">45</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">JUNIOR COLLEGE</td>
<td align="right">45</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">HIGH SCHOOL</td>
<td align="right">40</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">HIGH SCHOOL</td>
<td align="right">48</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">JUNIOR COLLEGE</td>
<td align="right">26</td>
<td align="right">5</td>
</tr>
</tbody>
</table></div>
<p>There are a number of interesting variables here, but the one that we are interested in is called <code>HoursWorked</code>. It is the number of hours that each person in the survey reports working per week.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-54" class="exercise"><strong>Exercise 9.1  </strong></span>Use the following chunk of code to make a histogram of the number of hours worked per week, based on the GSS data. In R, the dataset is called <code>gss</code> and number of hours worked per week is recorded as the variable <code>HoursWorked</code>. Play around with different binwidths until you find one that seems to give a good sense of the shape of the data.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="lab9.html#cb178-1" aria-hidden="true" tabindex="-1"></a>___ <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="lab9.html#cb178-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb178-3"><a href="lab9.html#cb178-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> ___)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Describe the shape of the distribution of <code>HoursWorked</code>, noting whether it is skewed or symmetrical, how many modes it has, and whether there may be any outliers.</li>
<li>Do these data appear to satisfy the “normality” condition for whether we can use a mathematical model?</li>
</ol>
</div>
<div id="confidence-interval-via-bootstrapping" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Confidence interval via bootstrapping<a class="anchor" aria-label="anchor" href="#confidence-interval-via-bootstrapping"><i class="fas fa-link"></i></a>
</h3>
<p>As we’ve noted, we can still use <strong>bootstrapping</strong> to construct a sampling distribution. But now, instead of a sampling distribution for a proportion, we will build a sampling distribution for the <em>mean</em>.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-55" class="exercise"><strong>Exercise 9.2  </strong></span>Use the following chunk of code to use bootstrapping to build a sampling distribution for the mean number of hours worked per week, using the <code>gss</code> data. Set <code>level</code> to give us 95% confidence interval and be sure to generate at least 1000 repetitions. <em>Hint:</em> this will look a lot like when we were working with proportions, but with one important difference—instead of “prop” as the <code>stat</code>istic we calculate for each simulated dataset, we calculate the <code>mean</code>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="lab9.html#cb179-1" aria-hidden="true" tabindex="-1"></a>hours_boot_dist <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="lab9.html#cb179-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(<span class="at">response =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="lab9.html#cb179-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">generate</span>(<span class="at">reps =</span> ___, <span class="at">type =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb179-4"><a href="lab9.html#cb179-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"___"</span>)</span>
<span id="cb179-5"><a href="lab9.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="lab9.html#cb179-6" aria-hidden="true" tabindex="-1"></a>hours_boot_ci <span class="ot">&lt;-</span> hours_boot_dist <span class="sc">%&gt;%</span></span>
<span id="cb179-7"><a href="lab9.html#cb179-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_confidence_interval</span>(<span class="at">level =</span> ___)</span>
<span id="cb179-8"><a href="lab9.html#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="lab9.html#cb179-9" aria-hidden="true" tabindex="-1"></a>hours_boot_dist <span class="sc">%&gt;%</span></span>
<span id="cb179-10"><a href="lab9.html#cb179-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb179-11"><a href="lab9.html#cb179-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shade_confidence_interval</span>(hours_boot_ci)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Report the 95% confidence interval you found and interpret it in context.</li>
<li>Based on your results, is it plausible that people on average work around 40 hours per week?</li>
<li>In your own words, describe the difference between the histogram you made in the previous exercise and the one you made in this exercise. They are both histograms that show a distribution of numbers, but the numbers mean different things.</li>
</ol>
</div>
</div>
<div id="confidence-interval-via-mathematical-model" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Confidence interval via mathematical model<a class="anchor" aria-label="anchor" href="#confidence-interval-via-mathematical-model"><i class="fas fa-link"></i></a>
</h3>
<p>In addition to bootstrapping, when the conditions are met, we can also use a mathematical model for the sampling distribution. This model is the <strong>T distribution</strong>. To use it, we need to know the <strong>standard error</strong> of the mean, which we can calculate using this formula:</p>
<p><span class="math display">\[
SE = \frac{s}{\sqrt{n}}
\]</span></p>
<p>where <span class="math inline">\(s\)</span> is the sample standard deviation and <span class="math inline">\(n\)</span> is the sample size.</p>
<p>Once we have the standard error, we use it to construct a confidence interval using this formula:</p>
<p><span class="math display">\[
\bar{x} \pm t^{\star}_{df} \times SE
\]</span></p>
<p>Remember that <span class="math inline">\(t^{\star}_{df} \times SE\)</span> is the “margin of error” and represents how many standard error’s from the mean (<span class="math inline">\(\bar{x}\)</span>) we believe the true population parameter might be.</p>
<p>We need the T distribution to find <span class="math inline">\(t^{\star}_{df}\)</span>. As we’ve noted, the T distribution has a different shape depending on how many <strong>degrees of freedom</strong> it has. The number of degrees of freedom is one less than the sample size:</p>
<p><span class="math display">\[
df = n - 1
\]</span></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-56" class="exercise"><strong>Exercise 9.3  </strong></span>Fill in the blanks in the code below to use R to carry out the calculations needed to use the T distribution to find a 95% confidence interval. This exercise is about translating the mathematical formulas above into meaningful labels. Notice that the first part of the chunk finds and stores the <code>sample_mean</code>, <code>sample_sd</code> (sample standard deviation), and <code>sample_size</code>. Use these labels to fill in the appropriate blanks. You will also need to supply a number for the <code>confidence_level</code> (which should be between 0 and 1, like in the previous exercise).</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="lab9.html#cb180-1" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="lab9.html#cb180-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">mean</span>(HoursWorked)) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="lab9.html#cb180-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb180-4"><a href="lab9.html#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="lab9.html#cb180-5" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb180-6"><a href="lab9.html#cb180-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">sd</span>(HoursWorked)) <span class="sc">%&gt;%</span></span>
<span id="cb180-7"><a href="lab9.html#cb180-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb180-8"><a href="lab9.html#cb180-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-9"><a href="lab9.html#cb180-9" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb180-10"><a href="lab9.html#cb180-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb180-11"><a href="lab9.html#cb180-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb180-12"><a href="lab9.html#cb180-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-13"><a href="lab9.html#cb180-13" aria-hidden="true" tabindex="-1"></a>standard_error <span class="ot">&lt;-</span> ___ <span class="sc">/</span> <span class="fu">sqrt</span>(___)</span>
<span id="cb180-14"><a href="lab9.html#cb180-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-15"><a href="lab9.html#cb180-15" aria-hidden="true" tabindex="-1"></a>degrees_of_freedom <span class="ot">&lt;-</span> ___ <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb180-16"><a href="lab9.html#cb180-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-17"><a href="lab9.html#cb180-17" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="ot">&lt;-</span> ___</span>
<span id="cb180-18"><a href="lab9.html#cb180-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-19"><a href="lab9.html#cb180-19" aria-hidden="true" tabindex="-1"></a>tail_probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> confidence_level) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb180-20"><a href="lab9.html#cb180-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-21"><a href="lab9.html#cb180-21" aria-hidden="true" tabindex="-1"></a>critical_t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> tail_probability, <span class="at">df =</span> degrees_of_freedom)</span>
<span id="cb180-22"><a href="lab9.html#cb180-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-23"><a href="lab9.html#cb180-23" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(___ <span class="sc">-</span> critical_t <span class="sc">*</span> standard_error, ___ <span class="sc">+</span> critical_t <span class="sc">*</span> standard_error)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>What was the 95% confidence interval that you found?</li>
<li>Compare the 95% confidence interval you found in this exercise with the one you found in the previous exercise using bootstrapping. Are they similar? Why might you expect them to be at least a little different?</li>
</ol>
</div>
</div>
<div id="hypothesis-test-via-mathematical-model" class="section level3" number="9.1.3">
<h3>
<span class="header-section-number">9.1.3</span> Hypothesis test via mathematical model<a class="anchor" aria-label="anchor" href="#hypothesis-test-via-mathematical-model"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, we can use the T distribution to conduct a hypothesis test. To do this, we calculate a <strong>T score</strong> which represents how far our observed result is from what we would expect if the null hypothesis were true. We can then use the T distribution to figure out the <span class="math inline">\(p\)</span> value, i.e., the probability of observing a T score at least as extreme as the one we observed.</p>
<p>Just like a Z score, a T score is defined as the difference between a point estimate and its hypothesized value, relative to the standard error:</p>
<p><span class="math display">\[
\begin{align*}
T &amp; = \frac{\text{point estimate} - \text{null value}}{\text{standard error}} \\
&amp; = \frac{\bar{x} - \mu_0}{SE}
\end{align*}
\]</span></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-57" class="exercise"><strong>Exercise 9.4  </strong></span>Our research question is, “do people on average work <em>more</em> than 40 hours per week?” Fill in the blanks in the code below to find the T score. The final line will calculate the <span class="math inline">\(p\)</span> value using the T distribution. <em>Hint:</em> Like in the last exercise, use the <em>names</em> of stored values (like <code>sample_size</code>) to fill in each blank, with the exception of <code>null_value</code> which you will need to specify based on our research question.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="lab9.html#cb181-1" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="lab9.html#cb181-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">mean</span>(HoursWorked)) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="lab9.html#cb181-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb181-4"><a href="lab9.html#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="lab9.html#cb181-5" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb181-6"><a href="lab9.html#cb181-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">sd</span>(HoursWorked)) <span class="sc">%&gt;%</span></span>
<span id="cb181-7"><a href="lab9.html#cb181-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb181-8"><a href="lab9.html#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="lab9.html#cb181-9" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb181-10"><a href="lab9.html#cb181-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="lab9.html#cb181-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb181-12"><a href="lab9.html#cb181-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-13"><a href="lab9.html#cb181-13" aria-hidden="true" tabindex="-1"></a>null_value <span class="ot">&lt;-</span> ___</span>
<span id="cb181-14"><a href="lab9.html#cb181-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-15"><a href="lab9.html#cb181-15" aria-hidden="true" tabindex="-1"></a>standard_error <span class="ot">&lt;-</span> ___ <span class="sc">/</span> <span class="fu">sqrt</span>(___)</span>
<span id="cb181-16"><a href="lab9.html#cb181-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-17"><a href="lab9.html#cb181-17" aria-hidden="true" tabindex="-1"></a>degrees_of_freedom <span class="ot">&lt;-</span> ___ <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb181-18"><a href="lab9.html#cb181-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-19"><a href="lab9.html#cb181-19" aria-hidden="true" tabindex="-1"></a>t_score <span class="ot">&lt;-</span> (___ <span class="sc">-</span> ___) <span class="sc">/</span> ___</span>
<span id="cb181-20"><a href="lab9.html#cb181-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-21"><a href="lab9.html#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="at">q =</span> t_score, <span class="at">df =</span> ___, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Based on the p value you got, would you reject the null hypothesis? What do you conclude and why?</p>
</div>
</div>
</div>
<div id="do-infants-prefer-people-who-sing-familiar-songs" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Do infants prefer people who sing familiar songs?<a class="anchor" aria-label="anchor" href="#do-infants-prefer-people-who-sing-familiar-songs"><i class="fas fa-link"></i></a>
</h2>
<p>Sam Mehr, Lee Ann Song (aptly named), and Liz Spelke <span class="citation">(<a href="references.html#ref-MehrEtAl2016" role="doc-biblioref">Mehr et al., 2016</a>)</span> were interested in how infants use music as a social cue. When an infant sees someone for the first time, are they more likely to be attracted to that person if they sing a song that the infant already knows?</p>
<p><span class="citation">Mehr et al. (<a href="references.html#ref-MehrEtAl2016" role="doc-biblioref">2016</a>)</span> conducted an experiment in which a child’s parents were taught a new melody and were instructed to sing it to their child at home over the course of 1–2 weeks. After this exposure period, the parents brought their infant back to the lab. The infant was seated in front of a screen showing videos of two adults the infant had never seen before. At first, the two adults just smiled in silence. They recorded the proportion of the time that the infant looked at each stranger during this “before” phase. Then, one of these people sang the melody that the parents had been singing for 1–2 weeks, while the other sang a totally new song. Finally, during the “after” phase, the infant saw the same videos of each person silently smiling and the researchers recorded the proportion of the time spent looking at the person who sang the familiar song. Will infants tend to look more at the stranger who sang the familiar song?</p>
<div id="check-out-the-data-2" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Check out the data<a class="anchor" aria-label="anchor" href="#check-out-the-data-2"><i class="fas fa-link"></i></a>
</h3>
<p>First, let’s take a look at the data, which are saved in R under the name <code>lullaby</code>. These are the first few rows:</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lullaby</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">id</th>
<th align="right">Before</th>
<th align="right">After</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">101</td>
<td align="right">0.4371257</td>
<td align="right">0.6027398</td>
</tr>
<tr class="even">
<td align="right">102</td>
<td align="right">0.4125326</td>
<td align="right">0.6830266</td>
</tr>
<tr class="odd">
<td align="right">103</td>
<td align="right">0.7544910</td>
<td align="right">0.7241379</td>
</tr>
<tr class="even">
<td align="right">104</td>
<td align="right">0.4388778</td>
<td align="right">0.2816538</td>
</tr>
<tr class="odd">
<td align="right">105</td>
<td align="right">0.4746450</td>
<td align="right">0.4985423</td>
</tr>
<tr class="even">
<td align="right">106</td>
<td align="right">0.8709016</td>
<td align="right">0.9509202</td>
</tr>
</tbody>
</table></div>
<p>Each row is data from a specific infant. There are three variables in this dataset:</p>
<ul>
<li>“id”: A number identifying each infant in the study.</li>
<li>“Before”: In the phase before the infants heard anyone sing, what proportion of the time did they look at the person who would eventually sing the familiar melody?</li>
<li>“After”: In the phase after the infants heard the two people sing, what proportion of the time did they look at the person who sang the familiar melody?</li>
</ul>
<div class="exercise">
<p><span id="exr:unlabeled-div-58" class="exercise"><strong>Exercise 9.5  </strong></span>Answer the following questions based on your understanding of how the study was designed:</p>
<ol style="list-style-type: lower-alpha">
<li>If an infant showed no preference during either the Before or After phase, what proportion of the time in that phase would they spend looking at the person who sang the familiar melody?</li>
<li>If an infant did not change who they looked at after hearing each person sing, what would the difference in looking proportions be between the Before and After phase?</li>
</ol>
</div>
</div>
<div id="examine-the-distribution-of-differences" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Examine the distribution of differences<a class="anchor" aria-label="anchor" href="#examine-the-distribution-of-differences"><i class="fas fa-link"></i></a>
</h3>
<p>Our <strong>research question</strong> is whether hearing the two people sing affected infant’s viewing preferences. As a result, we are interested in the <strong>difference</strong> between <code>After</code> and <code>Before</code>. To find this for each infant, we will use R’s <code>mutate</code> function:</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-59" class="exercise"><strong>Exercise 9.6  </strong></span>Run this chunk of code and examine the result:</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>diff <span class="op">=</span> <span class="va">After</span> <span class="op">-</span> <span class="va">Before</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>In your own words, describe what the line of code <code>mutate(diff = After - Before)</code> did.</li>
<li>Refer to the description of the study given above. What does a positive value of <code>diff</code> say about how an infant’s looking preferences changed? What does a negative value of <code>diff</code> say about how their preferences changed?</li>
</ol>
</div>
<p>The nice thing about that <code>mutate</code> line is that we can add more code after it that uses the <code>diff</code> variable we created in that line. For example, we can make a histogram of the differences in looking time from before to after:</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-60" class="exercise"><strong>Exercise 9.7  </strong></span>Use the following chunk to make a histogram of the <code>diff</code>erences in looking times from Before to After hearing the people sing.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="lab9.html#cb184-1" aria-hidden="true" tabindex="-1"></a>lullaby <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="lab9.html#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> After <span class="sc">-</span> Before) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="lab9.html#cb184-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb184-4"><a href="lab9.html#cb184-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Describe the shape of the distribution (be sure to note the number of modes, skewness, and whether there may be any outliers).</li>
<li>Based on the histogram, do these data appear to satisfy the conditions required for using a mathematical model (specifically, the T distribution)? Why or why not?</li>
<li>Based on the histogram, does it seem like the average preference may have changed after hearing the people sing? If so, in what direction?</li>
</ol>
</div>
</div>
<div id="confidence-interval-by-bootstrapping" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Confidence interval by bootstrapping<a class="anchor" aria-label="anchor" href="#confidence-interval-by-bootstrapping"><i class="fas fa-link"></i></a>
</h3>
<div class="exercise">
<p><span id="exr:unlabeled-div-61" class="exercise"><strong>Exercise 9.8  </strong></span>To begin, let’s use bootstrapping to construct a confidence interval for the difference in looking time between Before and After. This confidence interval will describe how much hearing someone sing a familiar melody changes infants’ looking preferences.</p>
<p>Fill in the blanks in the code below to construct a <strong>95% confidence interval</strong> for the mean difference in looking proportion from before to after. Be sure to refer to code from earlier in the session, as well as previous labs, for guidance. (<em>Hint:</em> if you’re looking for the name of the response variable, remember that we are doing inference about a <em>difference</em>.)</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="lab9.html#cb185-1" aria-hidden="true" tabindex="-1"></a>lullaby_boot_dist <span class="ot">&lt;-</span> lullaby <span class="sc">%&gt;%</span></span>
<span id="cb185-2"><a href="lab9.html#cb185-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> After <span class="sc">-</span> Before) <span class="sc">%&gt;%</span></span>
<span id="cb185-3"><a href="lab9.html#cb185-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(<span class="at">response =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb185-4"><a href="lab9.html#cb185-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">generate</span>(<span class="at">reps =</span> ___, <span class="at">type =</span> <span class="st">"___"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-5"><a href="lab9.html#cb185-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"___"</span>)</span>
<span id="cb185-6"><a href="lab9.html#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="lab9.html#cb185-7" aria-hidden="true" tabindex="-1"></a>lullaby_boot_ci <span class="ot">&lt;-</span> lullaby_boot_dist <span class="sc">%&gt;%</span></span>
<span id="cb185-8"><a href="lab9.html#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_confidence_interval</span>(<span class="at">level =</span> ___)</span>
<span id="cb185-9"><a href="lab9.html#cb185-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-10"><a href="lab9.html#cb185-10" aria-hidden="true" tabindex="-1"></a>lullaby_boot_dist <span class="sc">%&gt;%</span></span>
<span id="cb185-11"><a href="lab9.html#cb185-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb185-12"><a href="lab9.html#cb185-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shade_confidence_interval</span>(lullaby_boot_ci)</span></code></pre></div>
<p>Based on the confidence interval you found, is there evidence for a significance difference in looking preferences from before to after hearing the people sing? Explain your reasoning.</p>
</div>
</div>
<div id="hypothesis-test-via-mathematical-model-1" class="section level3" number="9.2.4">
<h3>
<span class="header-section-number">9.2.4</span> Hypothesis test via mathematical model<a class="anchor" aria-label="anchor" href="#hypothesis-test-via-mathematical-model-1"><i class="fas fa-link"></i></a>
</h3>
<div class="exercise">
<p><span id="exr:unlabeled-div-62" class="exercise"><strong>Exercise 9.9  </strong></span>Next, we will use a mathematical model to conduct a hypothesis test. This hypothesis test will address the <strong>research question</strong>, “is there a difference in infants’ average looking behavior from before to after hearing the two strangers sing?”</p>
<ol style="list-style-type: lower-alpha">
<li>What are the null and alternative hypotheses corresponding to our research question?</li>
<li>Fill in the blanks in the code below to calculate the observed T score and visualize where it falls relative to the null distribution. Based on the visualization you made, would our observed data be likely or unlikely if the null hypothesis were true? (<em>Hint:</em> for <code>mu</code>, this is the <em>null value</em>; and for the last blank, check how we have filled it in in previous labs depending on what our alternative hypothesis is.)</li>
</ol>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="lab9.html#cb186-1" aria-hidden="true" tabindex="-1"></a>lullaby_obs_t <span class="ot">&lt;-</span> lullaby <span class="sc">%&gt;%</span></span>
<span id="cb186-2"><a href="lab9.html#cb186-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> After <span class="sc">-</span> Before) <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="lab9.html#cb186-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(<span class="at">response =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb186-4"><a href="lab9.html#cb186-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>, <span class="at">mu =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb186-5"><a href="lab9.html#cb186-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"t"</span>)</span>
<span id="cb186-6"><a href="lab9.html#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="lab9.html#cb186-7" aria-hidden="true" tabindex="-1"></a>lullaby_null_dist <span class="ot">&lt;-</span> lullaby <span class="sc">%&gt;%</span></span>
<span id="cb186-8"><a href="lab9.html#cb186-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> After <span class="sc">-</span> Before) <span class="sc">%&gt;%</span></span>
<span id="cb186-9"><a href="lab9.html#cb186-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">specify</span>(<span class="at">response =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb186-10"><a href="lab9.html#cb186-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>, <span class="at">mu =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb186-11"><a href="lab9.html#cb186-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assume</span>(<span class="st">"t"</span>)</span>
<span id="cb186-12"><a href="lab9.html#cb186-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-13"><a href="lab9.html#cb186-13" aria-hidden="true" tabindex="-1"></a>lullaby_null_dist <span class="sc">%&gt;%</span></span>
<span id="cb186-14"><a href="lab9.html#cb186-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb186-15"><a href="lab9.html#cb186-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> lullaby_obs_t, <span class="at">direction =</span> <span class="st">"___"</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Fill in the blanks in the code below to get the <span class="math inline">\(p\)</span> value (make sure you’ve done part b first!). What did you get for the <span class="math inline">\(p\)</span> value? Would you reject the null hypothesis?</li>
</ol>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lullaby_null_dist</span> <span class="op">%&gt;%</span>
    <span class="fu">get_p_value</span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">lullaby_obs_t</span>, direction <span class="op">=</span> <span class="st">"___"</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Give a one-sentence summary of what the outcome of this hypothesis test tells us about how infant looking behavior is affected by hearing someone sing a familiar melody.</li>
</ol>
</div>
</div>
</div>
<div id="wrap-up-8" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up-8"><i class="fas fa-link"></i></a>
</h2>
<p>In this session, we saw how we can use the same kinds of computational techniques we applied to proportions—particularly bootstrapping—to construct confidence intervals and perform hypothesis tests about means. We also saw how to use the T distribution to find confidence intervals and conduct hypothesis tests.</p>
<p>In the second part, we used R’s <code>mutate</code> function to compute the differences within each participant. In the end, we were able to address the question of whether infants respond favorably (by looking more) to a stranger who sings a familiar song, giving us insight into the potential social importance of music.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lab8.html"><span class="header-section-number">8</span> Inference for proportions</a></div>
<div class="next"><a href="lab10.html"><span class="header-section-number">10</span> Inference for comparing two independent means</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab9"><span class="header-section-number">9</span> Inference about a mean</a></li>
<li>
<a class="nav-link" href="#overworked"><span class="header-section-number">9.1</span> Overworked?</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#confidence-interval-via-bootstrapping"><span class="header-section-number">9.1.1</span> Confidence interval via bootstrapping</a></li>
<li><a class="nav-link" href="#confidence-interval-via-mathematical-model"><span class="header-section-number">9.1.2</span> Confidence interval via mathematical model</a></li>
<li><a class="nav-link" href="#hypothesis-test-via-mathematical-model"><span class="header-section-number">9.1.3</span> Hypothesis test via mathematical model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#do-infants-prefer-people-who-sing-familiar-songs"><span class="header-section-number">9.2</span> Do infants prefer people who sing familiar songs?</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#check-out-the-data-2"><span class="header-section-number">9.2.1</span> Check out the data</a></li>
<li><a class="nav-link" href="#examine-the-distribution-of-differences"><span class="header-section-number">9.2.2</span> Examine the distribution of differences</a></li>
<li><a class="nav-link" href="#confidence-interval-by-bootstrapping"><span class="header-section-number">9.2.3</span> Confidence interval by bootstrapping</a></li>
<li><a class="nav-link" href="#hypothesis-test-via-mathematical-model-1"><span class="header-section-number">9.2.4</span> Hypothesis test via mathematical model</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wrap-up-8"><span class="header-section-number">9.3</span> Wrap-up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/gregcox7/StatLabs/blob/master/09-single_mean.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/gregcox7/StatLabs/edit/master/09-single_mean.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Labs</strong>" was written by Greg Cox. It was last built on 2022-11-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
