<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 4 Probability and simulation | Labs</title>
  <meta name="description" content="Laboratory exercises for APSY210." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 4 Probability and simulation | Labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Laboratory exercises for APSY210." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 4 Probability and simulation | Labs" />
  
  <meta name="twitter:description" content="Laboratory exercises for APSY210." />
  

<meta name="author" content="Greg Cox" />


<meta name="date" content="2021-03-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab3.html"/>
<link rel="next" href="lab5.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Labs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>1</b> Exploring Data with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="lab1.html"><a href="lab1.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="lab1.html"><a href="lab1.html#meet-your-data"><i class="fa fa-check"></i><b>1.2</b> Meet your data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lab1.html"><a href="lab1.html#check-out-the-variables"><i class="fa fa-check"></i><b>1.2.1</b> Check out the variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab1.html"><a href="lab1.html#answering-questions-with-data"><i class="fa fa-check"></i><b>1.3</b> Answering questions with data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="lab1.html"><a href="lab1.html#frequency-tables"><i class="fa fa-check"></i><b>1.3.1</b> Frequency tables</a></li>
<li class="chapter" data-level="1.3.2" data-path="lab1.html"><a href="lab1.html#bar-charts"><i class="fa fa-check"></i><b>1.3.2</b> Bar charts</a></li>
<li class="chapter" data-level="1.3.3" data-path="lab1.html"><a href="lab1.html#histograms"><i class="fa fa-check"></i><b>1.3.3</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="lab1.html"><a href="lab1.html#wrap-up"><i class="fa fa-check"></i><b>1.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab2.html"><a href="lab2.html"><i class="fa fa-check"></i><b>2</b> Central tendency and variability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lab2.html"><a href="lab2.html#simple-cases"><i class="fa fa-check"></i><b>2.1</b> Simple cases</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lab2.html"><a href="lab2.html#central-tendency"><i class="fa fa-check"></i><b>2.1.1</b> Central tendency</a></li>
<li class="chapter" data-level="2.1.2" data-path="lab2.html"><a href="lab2.html#variability"><i class="fa fa-check"></i><b>2.1.2</b> Variability</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lab2.html"><a href="lab2.html#dealing-with-real-data"><i class="fa fa-check"></i><b>2.2</b> Dealing with real data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="lab2.html"><a href="lab2.html#setting-the-stage"><i class="fa fa-check"></i><b>2.2.1</b> Setting the stage</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab2.html"><a href="lab2.html#getting-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Getting the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="lab2.html"><a href="lab2.html#visualizing-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Visualizing the data</a></li>
<li class="chapter" data-level="2.2.4" data-path="lab2.html"><a href="lab2.html#central-tendency-1"><i class="fa fa-check"></i><b>2.2.4</b> Central tendency</a></li>
<li class="chapter" data-level="2.2.5" data-path="lab2.html"><a href="lab2.html#variability-1"><i class="fa fa-check"></i><b>2.2.5</b> Variability</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab2.html"><a href="lab2.html#wrap-up-1"><i class="fa fa-check"></i><b>2.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lab3.html"><a href="lab3.html"><i class="fa fa-check"></i><b>3</b> Scatterplots and correlation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lab3.html"><a href="lab3.html#calculating-the-pearson-correlation-coefficient"><i class="fa fa-check"></i><b>3.1</b> Calculating the Pearson correlation coefficient</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="lab3.html"><a href="lab3.html#from-x-to-z"><i class="fa fa-check"></i><b>3.1.1</b> From <span class="math inline">\(X\)</span> to <span class="math inline">\(z\)</span></a></li>
<li class="chapter" data-level="3.1.2" data-path="lab3.html"><a href="lab3.html#finding-the-correlation-coefficient"><i class="fa fa-check"></i><b>3.1.2</b> Finding the correlation coefficient</a></li>
<li class="chapter" data-level="3.1.3" data-path="lab3.html"><a href="lab3.html#dealing-with-real-data-1"><i class="fa fa-check"></i><b>3.1.3</b> Dealing with real data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lab3.html"><a href="lab3.html#scatterplots"><i class="fa fa-check"></i><b>3.2</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="lab3.html"><a href="lab3.html#making-a-group-of-scatterplots"><i class="fa fa-check"></i><b>3.2.1</b> Making a group of scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lab3.html"><a href="lab3.html#some-bigger-data"><i class="fa fa-check"></i><b>3.3</b> Some bigger data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lab3.html"><a href="lab3.html#import-the-data"><i class="fa fa-check"></i><b>3.3.1</b> Import the data</a></li>
<li class="chapter" data-level="3.3.2" data-path="lab3.html"><a href="lab3.html#experience-and-memory-for-barbies"><i class="fa fa-check"></i><b>3.3.2</b> Experience and memory for Barbies</a></li>
<li class="chapter" data-level="3.3.3" data-path="lab3.html"><a href="lab3.html#experience-and-memory-for-transformers"><i class="fa fa-check"></i><b>3.3.3</b> Experience and memory for Transformers</a></li>
<li class="chapter" data-level="3.3.4" data-path="lab3.html"><a href="lab3.html#experience-with-barbies-and-memory-for-transformers"><i class="fa fa-check"></i><b>3.3.4</b> Experience with Barbies and memory for Transformers</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lab3.html"><a href="lab3.html#wrap-up-2"><i class="fa fa-check"></i><b>3.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab4.html"><a href="lab4.html"><i class="fa fa-check"></i><b>4</b> Probability and simulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab4.html"><a href="lab4.html#simulation-basics"><i class="fa fa-check"></i><b>4.1</b> Simulation basics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="lab4.html"><a href="lab4.html#single-coin-flips"><i class="fa fa-check"></i><b>4.1.1</b> Single coin flips</a></li>
<li class="chapter" data-level="4.1.2" data-path="lab4.html"><a href="lab4.html#a-sequence-of-coin-flips"><i class="fa fa-check"></i><b>4.1.2</b> A sequence of coin flips</a></li>
<li class="chapter" data-level="4.1.3" data-path="lab4.html"><a href="lab4.html#remembering-simulated-results"><i class="fa fa-check"></i><b>4.1.3</b> Remembering simulated results</a></li>
<li class="chapter" data-level="4.1.4" data-path="lab4.html"><a href="lab4.html#turning-simulated-results-into-data"><i class="fa fa-check"></i><b>4.1.4</b> Turning simulated results into “data”</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lab4.html"><a href="lab4.html#estimating-probabilities"><i class="fa fa-check"></i><b>4.2</b> Estimating probabilities</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lab4.html"><a href="lab4.html#frequency-table"><i class="fa fa-check"></i><b>4.2.1</b> Frequency table</a></li>
<li class="chapter" data-level="4.2.2" data-path="lab4.html"><a href="lab4.html#estimating-probability-from-frequency"><i class="fa fa-check"></i><b>4.2.2</b> Estimating probability from frequency</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lab4.html"><a href="lab4.html#more-advanced-simulation-tricks"><i class="fa fa-check"></i><b>4.3</b> More advanced simulation tricks</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="lab4.html"><a href="lab4.html#making-up-our-own-probabilities"><i class="fa fa-check"></i><b>4.3.1</b> Making up our own probabilities</a></li>
<li class="chapter" data-level="4.3.2" data-path="lab4.html"><a href="lab4.html#expanding-the-sample-space"><i class="fa fa-check"></i><b>4.3.2</b> Expanding the sample space</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lab4.html"><a href="lab4.html#estimating-probabilities-in-data"><i class="fa fa-check"></i><b>4.4</b> Estimating probabilities in data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="lab4.html"><a href="lab4.html#what-was-kobes-hit-rate"><i class="fa fa-check"></i><b>4.4.1</b> What was Kobe’s hit rate?</a></li>
<li class="chapter" data-level="4.4.2" data-path="lab4.html"><a href="lab4.html#a-simulated-kobe"><i class="fa fa-check"></i><b>4.4.2</b> A simulated Kobe</a></li>
<li class="chapter" data-level="4.4.3" data-path="lab4.html"><a href="lab4.html#hot--or-cold-handed"><i class="fa fa-check"></i><b>4.4.3</b> Hot- or cold-handed</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lab4.html"><a href="lab4.html#wrap-up-3"><i class="fa fa-check"></i><b>4.5</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab5.html"><a href="lab5.html"><i class="fa fa-check"></i><b>5</b> Models: The Binomial and the Normal</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lab5.html"><a href="lab5.html#the-binomial-distribution-in-r"><i class="fa fa-check"></i><b>5.1</b> The binomial distribution in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lab5.html"><a href="lab5.html#translating-from-sample-to-rbinom"><i class="fa fa-check"></i><b>5.1.1</b> Translating from <code>sample</code> to <code>rbinom</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="lab5.html"><a href="lab5.html#outcomes-from-different-sequences-of-events"><i class="fa fa-check"></i><b>5.1.2</b> Outcomes from different sequences of events</a></li>
<li class="chapter" data-level="5.1.3" data-path="lab5.html"><a href="lab5.html#simulated-relative-frequencies-and-probabilities"><i class="fa fa-check"></i><b>5.1.3</b> Simulated relative frequencies and probabilities</a></li>
<li class="chapter" data-level="5.1.4" data-path="lab5.html"><a href="lab5.html#calculating-binomial-probabilities-directly"><i class="fa fa-check"></i><b>5.1.4</b> Calculating binomial probabilities directly</a></li>
<li class="chapter" data-level="5.1.5" data-path="lab5.html"><a href="lab5.html#cumulative-probabilities-with-the-binomial"><i class="fa fa-check"></i><b>5.1.5</b> Cumulative probabilities with the binomial</a></li>
<li class="chapter" data-level="5.1.6" data-path="lab5.html"><a href="lab5.html#summary-of-rs-built-in-binomial-distribution"><i class="fa fa-check"></i><b>5.1.6</b> Summary of R’s built-in binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lab5.html"><a href="lab5.html#the-normal-distribution-in-r"><i class="fa fa-check"></i><b>5.2</b> The normal distribution in R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lab5.html"><a href="lab5.html#simulating-outcomes-from-a-normal-distribution"><i class="fa fa-check"></i><b>5.2.1</b> Simulating outcomes from a normal distribution</a></li>
<li class="chapter" data-level="5.2.2" data-path="lab5.html"><a href="lab5.html#the-mean-and-standard-deviation"><i class="fa fa-check"></i><b>5.2.2</b> The mean and standard deviation</a></li>
<li class="chapter" data-level="5.2.3" data-path="lab5.html"><a href="lab5.html#calculating-probabilities-with-the-normal-distribution"><i class="fa fa-check"></i><b>5.2.3</b> Calculating probabilities with the normal distribution</a></li>
<li class="chapter" data-level="5.2.4" data-path="lab5.html"><a href="lab5.html#finding-quantiles-with-the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> Finding “quantiles” with the normal distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="lab5.html"><a href="lab5.html#summary-of-rs-built-in-normal-distribution"><i class="fa fa-check"></i><b>5.2.5</b> Summary of R’s built-in normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lab5.html"><a href="lab5.html#wrap-up-4"><i class="fa fa-check"></i><b>5.3</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab6.html"><a href="lab6.html"><i class="fa fa-check"></i><b>6</b> Sampling and the Central Limit Theorem: The Wisdom of Large Samples</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lab6.html"><a href="lab6.html#before-we-begin"><i class="fa fa-check"></i><b>6.1</b> Before we begin…</a></li>
<li class="chapter" data-level="6.2" data-path="lab6.html"><a href="lab6.html#heights"><i class="fa fa-check"></i><b>6.2</b> Heights</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lab6.html"><a href="lab6.html#a-simulated-population"><i class="fa fa-check"></i><b>6.2.1</b> A simulated population</a></li>
<li class="chapter" data-level="6.2.2" data-path="lab6.html"><a href="lab6.html#a-sample-from-our-simulated-population"><i class="fa fa-check"></i><b>6.2.2</b> A sample from our simulated population</a></li>
<li class="chapter" data-level="6.2.3" data-path="lab6.html"><a href="lab6.html#many-samples-from-our-simulated-population"><i class="fa fa-check"></i><b>6.2.3</b> Many samples from our simulated population</a></li>
<li class="chapter" data-level="6.2.4" data-path="lab6.html"><a href="lab6.html#many-larger-samples"><i class="fa fa-check"></i><b>6.2.4</b> Many larger samples</a></li>
<li class="chapter" data-level="6.2.5" data-path="lab6.html"><a href="lab6.html#the-probability-of-being-wrong"><i class="fa fa-check"></i><b>6.2.5</b> The probability of being wrong</a></li>
<li class="chapter" data-level="6.2.6" data-path="lab6.html"><a href="lab6.html#biased-samples"><i class="fa fa-check"></i><b>6.2.6</b> Biased samples</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lab6.html"><a href="lab6.html#the-wisdom-of-the-crowd"><i class="fa fa-check"></i><b>6.3</b> The Wisdom of the Crowd</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="lab6.html"><a href="lab6.html#grab-the-data"><i class="fa fa-check"></i><b>6.3.1</b> Grab the data</a></li>
<li class="chapter" data-level="6.3.2" data-path="lab6.html"><a href="lab6.html#make-a-histogram"><i class="fa fa-check"></i><b>6.3.2</b> Make a histogram</a></li>
<li class="chapter" data-level="6.3.3" data-path="lab6.html"><a href="lab6.html#what-is-the-right-answer"><i class="fa fa-check"></i><b>6.3.3</b> What is the right answer?</a></li>
<li class="chapter" data-level="6.3.4" data-path="lab6.html"><a href="lab6.html#what-about-the-average"><i class="fa fa-check"></i><b>6.3.4</b> What about the average?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lab6.html"><a href="lab6.html#wrap-up-5"><i class="fa fa-check"></i><b>6.4</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Labs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab4" class="section level1" number="4">
<h1><span class="header-section-number">Lab 4</span> Probability and simulation</h1>
<p><img src="img/kobe.png" width="100%" /></p>
<p>We have seen that there are two senses in which we can think about probability. On the one hand, we can think of the probability of an outcome as its <strong>long-run relative frequency</strong>. We can therefore <em>estimate</em> the probability that an outcome will happen by seeing how often it occurred in the past, relative to all the other possible outcomes in our sample space. But on the other hand, we can think of probability as a <strong>degree of belief</strong> about how likely something is to happen. This second perspective lets us think about probabilities for events that only happen once; until the event happens, all the possible outcomes have some probability of occurring. We can <em>imagine</em> rewinding the clock and seeing how often an event may have turned out differently.</p>
<p>Actually, with computers, we can do better than just imagine what might happen. We can use the computer to <strong>simulate</strong> many repetitions of an event.</p>
<p>Before we begin, make sure you have opened the tidyverse package from the library:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="lab4.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.5     ✓ dplyr   1.0.3
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="simulation-basics" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Simulation basics</h2>
<p>To begin, let’s think about the simple scenario of flipping a coin. The <strong>sample space</strong> consists of two possible outcomes, “Heads” and “Tails.”</p>
<div id="single-coin-flips" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Single coin flips</h3>
<p>We can simulate a single coin flip in R using a “function” called <code>sample</code>:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="lab4.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="lab4.html#cb110-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Tails&quot;</code></pre>
<p>The first line in the code above tells R our sample space, which is a <strong>collection</strong> of two outcomes, “Heads” and “Tails.” We use the <code>%&gt;%</code> to tell R to take that sample space and, on the next line, take a <strong>sample</strong> of <strong>size</strong> 1 from that space. By “sample of size 1,” that’s just a precise way of saying “a single flip.”</p>
<p>Try running that same bit of code a few more times, so we can see that R is really simulating coin flips—you don’t know ahead of time whether it will come up heads or tails.<a href="#fn38" class="footnote-ref" id="fnref38"><sup>38</sup></a></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="lab4.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="lab4.html#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Heads&quot;</code></pre>
</div>
<div id="a-sequence-of-coin-flips" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> A sequence of coin flips</h3>
<p>It is kind of fun to keep flipping our simulated coin, but it would take a long time to do this repeatedly. As you might have guessed, we can change the <code>size</code> of our sample to quickly give us a long sequence of coin flips. Let’s try that now and see if we can get a sequence of 10 flips.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="lab4.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="lab4.html#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Error in sample.int(length(x), size, replace, prob): cannot take a sample larger than the population when &#39;replace = FALSE&#39;</code></pre>
<p>We got an error! Why is that? It’s because, by default, when you tell R to draw samples, it does so <strong>without replacement</strong>. In other words, once it draws a sample from the sample space, whatever outcome it sampled doesn’t get put back into the space. This wasn’t a problem when we ran the single-sample code multiple times because we told R to start with a “fresh” sample space each time—that’s what the first line <code>c("Heads", "Tails") %&gt;%</code> means.</p>
<p>Luckily, this is easily fixed by just telling R to sample with replacement like so:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="lab4.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="lab4.html#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot;
## [10] &quot;Tails&quot;</code></pre>
<p>Just like R gave us “fresh” single flips, if we run the 10-flip code again, we will probably get a different sequence of outcomes:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="lab4.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="lab4.html#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot;
## [10] &quot;Tails&quot;</code></pre>
<p>And for the computer, doing 50 flips is not much harder than just 10<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a>:</p>
<pre><code>##  [1] &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot;
## [10] &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot;
## [19] &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot;
## [28] &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot;
## [37] &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot;
## [46] &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot;</code></pre>
</div>
<div id="remembering-simulated-results" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Remembering simulated results</h3>
<p>The problem with simulating so many outcomes is that now it is hard to keep track of them! And, as we’ve seen, we can’t just copy-and-paste the same line of code each time we want to refer back to our simulated outcomes, because that will produce a <em>new</em> sequence of outcomes. Instead, let’s tell R to remember the outcomes we simulated.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="lab4.html#cb121-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-2"><a href="lab4.html#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>All we did was add <code>result &lt;-</code> to the beginning of our code. Like we saw last time, this will let R remember the particular sequence of outcomes under the label “result.” If we type “result” at the console, we’ll see that R looks back in its memory and tells us how that sequence of 50 flips turned out.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="lab4.html#cb122-1" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##  [1] &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot;
## [10] &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot;
## [19] &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot;
## [28] &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot;
## [37] &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot;
## [46] &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot;</code></pre>
<p>But if we simulate a new sequence of flips and tell R to remember it under the label “result,” it will forget the original sequence:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="lab4.html#cb124-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="lab4.html#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-3"><a href="lab4.html#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="lab4.html#cb124-4" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##  [1] &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Heads&quot;
## [10] &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot;
## [19] &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot;
## [28] &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot;
## [37] &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot;
## [46] &quot;Tails&quot; &quot;Heads&quot; &quot;Heads&quot; &quot;Tails&quot; &quot;Heads&quot;</code></pre>
</div>
<div id="turning-simulated-results-into-data" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Turning simulated results into “data”</h3>
<p>Now that we can simulate long sequences of outcomes and get R to remember them, we are going to get R to treat those outcomes as if they were “data,” in other words, as if they were from a real coin instead of a simulated one. R keeps data in a special form called a “tibble.” We’ve seen this cutesy form of the word “table” before; every time we used R to summarize a dataset, it told us the result was a “tibble.”</p>
<p>We can create a “tibble” from our simulated flips like this</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="lab4.html#cb126-1" aria-hidden="true" tabindex="-1"></a>coin_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span></code></pre></div>
<p>We’ve told R to take our flips, turn them into a <code>tibble</code>, and remember the result under the label “coin_data.” Now when we ask R to remember “coin_data,” we see it looks a bit different</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="lab4.html#cb127-1" aria-hidden="true" tabindex="-1"></a>coin_data</span></code></pre></div>
<pre><code>## # A tibble: 50 x 1
##    result
##    &lt;chr&gt; 
##  1 Tails 
##  2 Tails 
##  3 Heads 
##  4 Tails 
##  5 Heads 
##  6 Tails 
##  7 Heads 
##  8 Heads 
##  9 Heads 
## 10 Tails 
## # … with 40 more rows</code></pre>
</div>
</div>
<div id="estimating-probabilities" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Estimating probabilities</h2>
<p>Now that R can treat our simulated flips like it would “real” data, we can summarize it just like we would “real” data. This will allow us to estimate the probabilities of different outcomes from their relative frequency.</p>
<div id="frequency-table" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Frequency table</h3>
<p>The first thing we want to know is how many flips were heads and how many were tails.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="lab4.html#cb129-1" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="lab4.html#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="lab4.html#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   result     n
## * &lt;chr&gt;  &lt;int&gt;
## 1 Heads     26
## 2 Tails     24</code></pre>
<p>The summary above is a frequency table, which we have used before.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a></p>
</div>
<div id="estimating-probability-from-frequency" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Estimating probability from frequency</h3>
<p>Let’s use this frequency table to estimate the probability of getting either a heads or a tails. To do this, we need to add a line to the code above:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="lab4.html#cb131-1" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="lab4.html#cb131-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="lab4.html#cb131-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="lab4.html#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads     26  0.52
## 2 Tails     24  0.48</code></pre>
<p>The final line is called <code>mutate</code> because we are “mutating” the frequency counts to produce an estimate of the probability. We get that estimate (<code>p</code>) by taking the frequency of each outcome, <code>n</code>, and dividing it by the total number of outcomes (<code>sum(n)</code>).</p>
<p>Let’s see how this works by simulating a longer sequence of coin flips (1000 flips) and replacing our old results:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="lab4.html#cb133-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="lab4.html#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-3"><a href="lab4.html#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="lab4.html#cb133-4" aria-hidden="true" tabindex="-1"></a>coin_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb133-5"><a href="lab4.html#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="lab4.html#cb133-6" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="lab4.html#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb133-8"><a href="lab4.html#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb133-9"><a href="lab4.html#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    520  0.52
## 2 Tails    480  0.48</code></pre>
<p>Now let’s try it with an even longer sequence of 10000 flips.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a></p>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads   4999 0.500
## 2 Tails   5001 0.500</code></pre>
</div>
</div>
<div id="more-advanced-simulation-tricks" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> More advanced simulation tricks</h2>
<p>So far, we have just been simulating flips of a fair coin. Now let’s see how we can simulate more complex situations.</p>
<div id="making-up-our-own-probabilities" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Making up our own probabilities</h3>
<p>By default, when you ask R to <code>sample</code>, it will assume that all the outcomes in the sample space have equal probability. That’s why when we asked R to simulate coin flips, heads and tails came up about equally often. Let’s mess with this and make ourselves a simulated <em>unfair</em> coin.</p>
<p>The code below simulates 1000 flips of a coin that comes up heads with probability 0.6, rather than 0.5:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="lab4.html#cb136-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-2"><a href="lab4.html#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>))</span>
<span id="cb136-3"><a href="lab4.html#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="lab4.html#cb136-4" aria-hidden="true" tabindex="-1"></a>coin_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb136-5"><a href="lab4.html#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="lab4.html#cb136-6" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb136-7"><a href="lab4.html#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb136-8"><a href="lab4.html#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb136-9"><a href="lab4.html#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    609 0.609
## 2 Tails    391 0.391</code></pre>
<p>Notice the main difference is that we added another part to the <code>sample</code> line. By adding <code>prob = c(0.6, 0.4)</code>, we told R that the <code>prob</code>ability of the <em>corresponding</em> outcomes in the sample space (<code>c("Heads", "Tails")</code>) should be 0.6 and 0.4, respectively. If we reverse the order of the probabilities, notice that “Tails” now comes out ahead:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="lab4.html#cb138-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="lab4.html#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span>
<span id="cb138-3"><a href="lab4.html#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="lab4.html#cb138-4" aria-hidden="true" tabindex="-1"></a>coin_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb138-5"><a href="lab4.html#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="lab4.html#cb138-6" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb138-7"><a href="lab4.html#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb138-8"><a href="lab4.html#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb138-9"><a href="lab4.html#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    398 0.398
## 2 Tails    602 0.602</code></pre>
<p>The first rule is that the first number in the collection of probabilities (after <code>prob</code>) gives the probability of the first outcome in the sample space, the second number gives the probability of the second outcome in the sample space, and so on. Now let’s try simulating 1000 flips where the probability of heads is 0.7:<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a></p>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    672 0.672
## 2 Tails    328 0.328</code></pre>
<p>Notice that the <strong>relative frequency</strong> of the different outcomes is always close to the probabilities we give to R.</p>
</div>
<div id="expanding-the-sample-space" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Expanding the sample space</h3>
<p>In addition to messing with the probabilities, we can mess with the sample space. So far, we have been assuming that the coin can only come up heads or tails. What if the coin could land on its side? This would introduce a new possible <em>outcome</em> to our sample space. We need to change the first line of our simulation code to reflect this:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="lab4.html#cb141-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Heads&quot;</span>, <span class="st">&quot;Tails&quot;</span>, <span class="st">&quot;Side&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="lab4.html#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-3"><a href="lab4.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="lab4.html#cb141-4" aria-hidden="true" tabindex="-1"></a>coin_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb141-5"><a href="lab4.html#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="lab4.html#cb141-6" aria-hidden="true" tabindex="-1"></a>coin_data <span class="sc">%&gt;%</span></span>
<span id="cb141-7"><a href="lab4.html#cb141-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb141-8"><a href="lab4.html#cb141-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb141-9"><a href="lab4.html#cb141-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    338 0.338
## 2 Side     342 0.342
## 3 Tails    320 0.32</code></pre>
<p>Notice that the code above did not specify any <code>prob</code>abilities. As a result, all three outcomes in our sample space ended up happening about equally often. Let’s specify those probabilities to try and get the coin to come up on its side with probability 0.1, but otherwise come up heads or tails with equal probability and simulated 1000 flips. The result will look something like this:<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a></p>
<pre><code>## # A tibble: 3 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Heads    464 0.464
## 2 Side     100 0.1  
## 3 Tails    436 0.436</code></pre>
</div>
</div>
<div id="estimating-probabilities-in-data" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Estimating probabilities in data</h2>
<p>By now we are probably sick of coin flipping. Let’s take a break and watch some basketball. Specifically, let’s watch Kobe Bryant of the LA Lakers as they played against the Orlando Magic in the 2009 NBA finals. Use the following line of code to download a dataset consisting of every shooting attempt Kobe made that game, including whether or not it went in (i.e., was the shot a “Hit” or a “Miss”):</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="lab4.html#cb144-1" aria-hidden="true" tabindex="-1"></a>kobe <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/gregcox7/StatLabs/main/data/kobe.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   vs = col_character(),
##   game = col_double(),
##   quarter = col_character(),
##   time = col_time(format = &quot;&quot;),
##   description = col_character(),
##   shot = col_character(),
##   prev_shot = col_character()
## )</code></pre>
<div id="what-was-kobes-hit-rate" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> What was Kobe’s hit rate?</h3>
<p>The first question we should ask is how often Kobe’s shots go in (called his “field goal percentage”). We can modify the code we used to estimate probabilities from our simulated coin flips to do the same for Kobe’s real shot attempts:<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="lab4.html#cb146-1" aria-hidden="true" tabindex="-1"></a>kobe <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="lab4.html#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(shot) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="lab4.html#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb146-4"><a href="lab4.html#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   shot      n     p
## * &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;
## 1 H        57 0.432
## 2 M        75 0.568</code></pre>
</div>
<div id="a-simulated-kobe" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> A simulated Kobe</h3>
<p>Using the estimates above, let’s see if we can construct a simulated Kobe Bryant that, like our simulated coin, will have roughly the same probability of making a basket as Kobe did. To do this, we need to specify our <strong>sample space</strong> (<code>c("H", "M")</code>, where “H” is for “hit” and “M” is for “miss”) and our <strong>probabilities</strong> (e.g., <code>prob = c(0.5, 0.5)</code> if we think hits and misses are equally likely). Since this is a simulated Kobe, we can make him attempt 1000 shots (or more):</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="lab4.html#cb148-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;M&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="lab4.html#cb148-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb148-3"><a href="lab4.html#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="lab4.html#cb148-4" aria-hidden="true" tabindex="-1"></a>simulated_kobe_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(result)</span>
<span id="cb148-5"><a href="lab4.html#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="lab4.html#cb148-6" aria-hidden="true" tabindex="-1"></a>simulated_kobe_data <span class="sc">%&gt;%</span></span>
<span id="cb148-7"><a href="lab4.html#cb148-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(result) <span class="sc">%&gt;%</span></span>
<span id="cb148-8"><a href="lab4.html#cb148-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb148-9"><a href="lab4.html#cb148-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   result     n     p
## * &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 H        520  0.52
## 2 M        480  0.48</code></pre>
<p>Does this simulated Kobe look much like the real one? What should we change to make it look more like the real Kobe?<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a></p>
</div>
<div id="hot--or-cold-handed" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Hot- or cold-handed</h3>
<p>Commentators at this particular game remarked that Kobe seemed to have a “hot hand.” In other words, they seemed to believe that once Kobe made a basket (“H”), he was <em>more likely</em> to make a basket on his next shot. This is a probability question! Specifically, it is a question about <strong>conditional probability</strong>. <em>Conditional on</em> whether Kobe’s previous shot was a hit or a miss, what is the probability that his next shot is a hit or a miss?</p>
<p>We can address this question by modifying the code we used above to estimate probabilities:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="lab4.html#cb150-1" aria-hidden="true" tabindex="-1"></a>kobe <span class="sc">%&gt;%</span></span>
<span id="cb150-2"><a href="lab4.html#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(prev_shot, shot) <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="lab4.html#cb150-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="lab4.html#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;prev_shot&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 4 x 4
## # Groups:   prev_shot [2]
##   prev_shot shot      n     p
##   &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;
## 1 H         H        21 0.368
## 2 H         M        36 0.632
## 3 M         H        36 0.48 
## 4 M         M        39 0.52</code></pre>
<p>Here, <code>prev_shot</code> refers to whether Kobe’s <code>prev</code>ious shot was a hit (“H”) or a miss (“M”). By adding <code>prev_shot</code> to the grouping in our second line, what we have done is tell R to count the number of times each <em>combination</em> of hit/miss on the previous shot and hit/miss on the current shot occurred.<a href="#fn46" class="footnote-ref" id="fnref46"><sup>46</sup></a> As a result, when we ask R in the final line to give us probabilities, it gives us the probability of a hit or miss on the current shot <em>conditional on</em> whether the previous shot was a hit or a miss.</p>
<p>So, were the commentators right?<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a></p>
</div>
</div>
<div id="wrap-up-3" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Wrap-up</h2>
<p>In this activity, we saw how we could use R to <strong>simulate</strong> outcomes of many repeated events. We could specify the <strong>sample space</strong> as well as the <strong>probability</strong> with which different outcomes could occur. We saw how the <strong>long-run relative frequency</strong> got close to these probabilities. Finally, we saw how we could use R to <strong>estimate</strong> probabilities from frequencies of different outcomes, including <strong>conditional probabilities</strong>.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="38">
<li id="fn38"><p>How many times did you have to run the coin-flip simulation before you got at least one “Heads” and at least one “Tails?”<a href="lab4.html#fnref38" class="footnote-back">↩︎</a></p></li>
<li id="fn39"><p>What code would produce a sequence of 50 flips at once? <em>Hint: what is the number we had to change in the <code>sample</code> line to get 10 flips?</em><a href="lab4.html#fnref39" class="footnote-back">↩︎</a></p></li>
<li id="fn40"><p>Compare the code we just used to produce a frequency table with the code we used to make frequency tables in Lab 1. What is similar and what is different?<a href="lab4.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>What would you change in the code above to make it produce 10000 flips? Does it seem like the estimated probabilities are closer to 0.5 for both heads and tails with more flips?<a href="lab4.html#fnref41" class="footnote-back">↩︎</a></p></li>
<li id="fn42"><p>How would you change our coin flipping code to do this? <em>Hint: remember that probabilities should always add up to 1.</em><a href="lab4.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>What would you add to the simulation code to make the probability of heads, tails, and side come out this way? <em>Hint: Remember how we specified the probabilities for the unfair coin, and that all three probabilities should add up to 1.</em><a href="lab4.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>Compare the code below to the code we used above to estimate probabilities from our simulated coin flips. What is similar and what is different?<a href="lab4.html#fnref44" class="footnote-back">↩︎</a></p></li>
<li id="fn45"><p>Play around with the <code>prob</code>abilities in the code for simulating shots from Kobe Bryant until you find some probabilities that make his hit rate look similar to what we actually observed. What probabilities did you end up with?<a href="lab4.html#fnref45" class="footnote-back">↩︎</a></p></li>
<li id="fn46"><p>Compare the code we just used with the code we used to get the number of passengers who did or did not survive on the <em>Titanic</em> in each class. What is similar and what is different?<a href="lab4.html#fnref46" class="footnote-back">↩︎</a></p></li>
<li id="fn47"><p>Did Kobe have a “hot hand?” Did he have a “cold hand,” where missing a shot meant it was more likely he would miss his next shot? Was there something else going on? Or was there no particular difference depending on whether he made or missed his previous shot?<a href="lab4.html#fnref47" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["APSY210 Labs.pdf", "APSY210 Labs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
